---

title: Experiment


keywords: fastai
sidebar: home_sidebar

summary: "Can we get better by training on our assumptions?"
description: "Can we get better by training on our assumptions?"
nb_path: "09e_experiment_xmi_labels.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 09e_experiment_xmi_labels.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Appended /home/blackhc/PycharmProjects/bald-ical/src to paths
Switched to directory /home/blackhc/PycharmProjects/bald-ical
%load_ext autoreload
%autoreload 2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import modules and functions were are going to use.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.utils.data</span>
<span class="kn">from</span> <span class="nn">blackhc.project</span> <span class="kn">import</span> <span class="n">is_run_from_ipython</span>
<span class="kn">from</span> <span class="nn">blackhc.project.experiment</span> <span class="kn">import</span> <span class="n">embedded_experiments</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="kn">import</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="k">as</span> <span class="nn">acquisition_functions</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CandidateBatchComputer</span><span class="p">,</span>
    <span class="n">EvalCandidateBatchComputer</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.active_learning</span> <span class="kn">import</span> <span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">RandomFixedLengthSampler</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.black_box_model_training</span> <span class="kn">import</span> <span class="n">evaluate</span><span class="p">,</span> <span class="n">train</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.dataset_challenges</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">NamedDataset</span><span class="p">,</span>
    <span class="n">create_repeated_MNIST_dataset</span><span class="p">,</span>
    <span class="n">get_base_dataset_index</span><span class="p">,</span>
    <span class="n">get_target</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.di</span> <span class="kn">import</span> <span class="n">DependencyInjection</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.fast_mnist</span> <span class="kn">import</span> <span class="n">FastMNIST</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.model_optimizer_factory</span> <span class="kn">import</span> <span class="n">ModelOptimizerFactory</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.models</span> <span class="kn">import</span> <span class="n">MnistOptimizerFactory</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># From the BatchBALD Repo</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.train_eval_model</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TrainEvalModel</span><span class="p">,</span>
    <span class="n">TrainSelfDistillationEvalModel</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.trained_model</span> <span class="kn">import</span> <span class="n">TrainedMCDropoutModel</span>

<span class="n">mnist_initial_samples</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">38043</span><span class="p">,</span>
    <span class="mi">40091</span><span class="p">,</span>
    <span class="mi">17418</span><span class="p">,</span>
    <span class="mi">2094</span><span class="p">,</span>
    <span class="mi">39879</span><span class="p">,</span>
    <span class="mi">3133</span><span class="p">,</span>
    <span class="mi">5011</span><span class="p">,</span>
    <span class="mi">40683</span><span class="p">,</span>
    <span class="mi">54379</span><span class="p">,</span>
    <span class="mi">24287</span><span class="p">,</span>
    <span class="mi">9849</span><span class="p">,</span>
    <span class="mi">59305</span><span class="p">,</span>
    <span class="mi">39508</span><span class="p">,</span>
    <span class="mi">39356</span><span class="p">,</span>
    <span class="mi">8758</span><span class="p">,</span>
    <span class="mi">52579</span><span class="p">,</span>
    <span class="mi">13655</span><span class="p">,</span>
    <span class="mi">7636</span><span class="p">,</span>
    <span class="mi">21562</span><span class="p">,</span>
    <span class="mi">41329</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Experiment" class="doc_header"><code>class</code> <code>Experiment</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/experiment_xmi_labels.py#L72" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Experiment</code>(<strong><code>seed</code></strong>:<code>int</code>=<em><code>1337</code></em>, <strong><code>acquisition_size</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>max_training_set</code></strong>:<code>int</code>=<em><code>300</code></em>, <strong><code>num_pool_samples</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>num_validation_samples</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>num_training_samples</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>num_patience_epochs</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>max_training_epochs</code></strong>:<code>int</code>=<em><code>120</code></em>, <strong><code>training_batch_size</code></strong>:<code>int</code>=<em><code>64</code></em>, <strong><code>device</code></strong>:<code>str</code>=<em><code>'cuda'</code></em>, <strong><code>validation_set_size</code></strong>:<code>int</code>=<em><code>1024</code></em>, <strong><code>initial_set_size</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>min_samples_per_epoch</code></strong>:<code>int</code>=<em><code>1024</code></em>, <strong><code>repeated_mnist_repetitions</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>add_dataset_noise</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>acquisition_function</code></strong>:<code>Union</code>[<code>Type</code>[<a href="/batchbald_redux/acquisition_functions.html#CandidateBatchComputer"><code>CandidateBatchComputer</code></a>], <code>Type</code>[<a href="/batchbald_redux/acquisition_functions.html#EvalCandidateBatchComputer"><code>EvalCandidateBatchComputer</code></a>]]=<em><code>BALD</code></em>, <strong><code>train_eval_model</code></strong>:<a href="/batchbald_redux/train_eval_model.html#TrainEvalModel"><code>TrainEvalModel</code></a>=<em><code>TrainSelfDistillationEvalModel</code></em>, <strong><code>model_optimizer_factory</code></strong>:<code>Type</code>[<a href="/batchbald_redux/model_optimizer_factory.html#ModelOptimizerFactory"><code>ModelOptimizerFactory</code></a>]=<em><code>MnistOptimizerFactory</code></em>, <strong><code>acquisition_function_args</code></strong>:<code>dict</code>=<em><code>None</code></em>, <strong><code>temperature</code></strong>:<code>float</code>=<em><code>0.0</code></em>)</p>
</blockquote>
<p>Experiment(seed: int = 1337, acquisition_size: int = 5, max_training_set: int = 300, num_pool_samples: int = 20, num_validation_samples: int = 20, num_training_samples: int = 1, num_patience_epochs: int = 20, max_training_epochs: int = 120, training_batch_size: int = 64, device: str = 'cuda', validation_set_size: int = 1024, initial_set_size: int = 20, min_samples_per_epoch: int = 1024, repeated_mnist_repetitions: int = 1, add_dataset_noise: bool = False, acquisition_function: Union[Type[batchbald_redux.acquisition_functions.CandidateBatchComputer], Type[batchbald_redux.acquisition_functions.EvalCandidateBatchComputer]] = &lt;class 'batchbald_redux.acquisition_functions.BALD'&gt;, train_eval_model: batchbald_redux.train_eval_model.TrainEvalModel = &lt;class 'batchbald_redux.train_eval_model.TrainSelfDistillationEvalModel'&gt;, model_optimizer_factory: Type[batchbald_redux.model_optimizer_factory.ModelOptimizerFactory] = &lt;class 'batchbald_redux.models.MnistOptimizerFactory'&gt;, acquisition_function_args: dict = None, temperature: float = 0.0)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Experiment</span><span class="p">:</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1337</span>
    <span class="n">acquisition_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">max_training_set</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">300</span>
    <span class="n">num_pool_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_validation_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_training_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_patience_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">max_training_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">training_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span>
    <span class="n">validation_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">initial_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">min_samples_per_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">repeated_mnist_repetitions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">add_dataset_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">acquisition_function</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">Type</span><span class="p">[</span><span class="n">CandidateBatchComputer</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="n">EvalCandidateBatchComputer</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">acquisition_functions</span><span class="o">.</span><span class="n">BALD</span>
    <span class="n">train_eval_model</span><span class="p">:</span> <span class="n">TrainEvalModel</span> <span class="o">=</span> <span class="n">TrainSelfDistillationEvalModel</span>
    <span class="n">model_optimizer_factory</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">ModelOptimizerFactory</span><span class="p">]</span> <span class="o">=</span> <span class="n">MnistOptimizerFactory</span>
    <span class="n">acquisition_function_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_training_set_indices</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">):</span>
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;FastMNIST (train)&quot;</span>
        <span class="p">)</span>
        <span class="n">train_predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;./data/mnist_train_predictions.pt&quot;</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

        <span class="c1"># If we over-sample the train set, we do so after picking the initial train set to avoid duplicates.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeated_mnist_repetitions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">repeated_mnist_repetitions</span>

        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">override_targets</span><span class="p">(</span><span class="n">targets</span><span class="o">=</span><span class="n">train_predictions</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_dataset_noise</span><span class="p">:</span>
            <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">AdditiveGaussianNoise</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="n">active_learning_data</span> <span class="o">=</span> <span class="n">ActiveLearningData</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>

        <span class="n">active_learning_data</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">initial_training_set_indices</span><span class="p">)</span>

        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">active_learning_data</span><span class="o">.</span><span class="n">extract_dataset_from_pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validation_set_size</span><span class="p">)</span>
        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (validation, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">)</span>

        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (test, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">active_learning_data</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">,</span> <span class="n">test_dataset</span>

    <span class="c1"># Simple Dependency Injection</span>
    <span class="k">def</span> <span class="nf">create_acquisition_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">DependencyInjection</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">di</span><span class="o">.</span><span class="n">create_dataclass_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acquisition_function</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_train_eval_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime_config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainEvalModel</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="o">**</span><span class="n">runtime_config</span><span class="p">}</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">DependencyInjection</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="n">di</span><span class="o">.</span><span class="n">create_dataclass_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_eval_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">):</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_set_size</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">mnist_initial_samples</span><span class="p">):</span>
            <span class="n">initial_training_set_indices</span> <span class="o">=</span> <span class="n">mnist_initial_samples</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_set_size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">initial_training_set_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;initial_set_size </span><span class="si">{</span><span class="n">initial_set_size</span><span class="si">}</span><span class="s2"> not supported here!&quot;</span><span class="p">)</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;initial_training_set_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_training_set_indices</span>

        <span class="c1"># Active Learning setup</span>
        <span class="n">active_learning_data</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">,</span> <span class="n">test_dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">initial_training_set_indices</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;dataset_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">training</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">base_dataset</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">))</span>

        <span class="c1"># initial_training_set_indices = active_learning_data.get_random_pool_indices(self.initial_set_size)</span>
        <span class="c1"># initial_training_set_indices = get_balanced_sample_indices(</span>
        <span class="c1">#     active_learning_data.pool_dataset, 10, self.initial_set_size // 10</span>
        <span class="c1"># )</span>

        <span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">RandomFixedLengthSampler</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_per_epoch</span><span class="p">),</span>
            <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">pool_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="n">validation_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">active_learning_steps</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span>

        <span class="n">acquisition_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_acquisition_function</span><span class="p">()</span>

        <span class="c1"># Active Training Loop</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">training_set_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training set size </span><span class="si">{</span><span class="n">training_set_size</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

            <span class="c1"># iteration_log = dict(training={}, pool_training={}, evaluation_metrics=None, acquisition=None)</span>
            <span class="n">active_learning_steps</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
            <span class="n">iteration_log</span> <span class="o">=</span> <span class="n">active_learning_steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">model_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer_factory</span><span class="p">()</span><span class="o">.</span><span class="n">create_model_optimizer</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">training_set_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">train</span><span class="p">(</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                    <span class="n">optimizer</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
                    <span class="n">training_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_training_samples</span><span class="p">,</span>
                    <span class="n">validation_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_validation_samples</span><span class="p">,</span>
                    <span class="n">train_loader</span><span class="o">=</span><span class="n">train_loader</span><span class="p">,</span>
                    <span class="n">validation_loader</span><span class="o">=</span><span class="n">validation_loader</span><span class="p">,</span>
                    <span class="n">patience</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_patience_epochs</span><span class="p">,</span>
                    <span class="n">max_epochs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_training_epochs</span><span class="p">,</span>
                    <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                    <span class="n">training_log</span><span class="o">=</span><span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">],</span>
                <span class="p">)</span>

            <span class="n">evaluation_metrics</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">num_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_validation_samples</span><span class="p">,</span>
                <span class="n">loader</span><span class="o">=</span><span class="n">test_loader</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;evaluation_metrics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluation_metrics</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perf after training </span><span class="si">{</span><span class="n">evaluation_metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">training_set_size</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_training_set</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">trained_model</span> <span class="o">=</span> <span class="n">TrainedMCDropoutModel</span><span class="p">(</span><span class="n">num_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pool_samples</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acquisition_function</span><span class="p">,</span> <span class="n">CandidateBatchComputer</span><span class="p">):</span>
                <span class="n">candidate_batch</span> <span class="o">=</span> <span class="n">acquisition_function</span><span class="o">.</span><span class="n">compute_candidate_batch</span><span class="p">(</span><span class="n">trained_model</span><span class="p">,</span> <span class="n">pool_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acquisition_function</span><span class="p">,</span> <span class="n">EvalCandidateBatchComputer</span><span class="p">):</span>
                <span class="n">current_max_epochs</span> <span class="o">=</span> <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;best_epoch&quot;</span><span class="p">]</span>

                <span class="n">train_eval_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_train_eval_model</span><span class="p">(</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">max_epochs</span><span class="o">=</span><span class="n">current_max_epochs</span><span class="p">,</span>
                        <span class="n">training_dataset</span><span class="o">=</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span>
                        <span class="n">eval_dataset</span><span class="o">=</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span>
                        <span class="n">validation_loader</span><span class="o">=</span><span class="n">validation_loader</span><span class="p">,</span>
                        <span class="n">trained_model</span><span class="o">=</span><span class="n">trained_model</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;eval_training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">trained_eval_model</span> <span class="o">=</span> <span class="n">train_eval_model</span><span class="p">(</span><span class="n">training_log</span><span class="o">=</span><span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;eval_training&quot;</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

                <span class="n">candidate_batch</span> <span class="o">=</span> <span class="n">acquisition_function</span><span class="o">.</span><span class="n">compute_candidate_batch</span><span class="p">(</span>
                    <span class="n">trained_model</span><span class="p">,</span> <span class="n">trained_eval_model</span><span class="p">,</span> <span class="n">pool_loader</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown acquisition function </span><span class="si">{</span><span class="n">acquisition_function</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>

            <span class="n">candidate_global_indices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">get_base_dataset_index</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">candidate_batch</span><span class="o">.</span><span class="n">indices</span>
            <span class="p">]</span>
            <span class="n">candidate_labels</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">get_target</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">base_dataset</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">candidate_global_indices</span>
            <span class="p">]</span>

            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;acquisition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">indices</span><span class="o">=</span><span class="n">candidate_global_indices</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">candidate_labels</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="n">candidate_batch</span><span class="o">.</span><span class="n">scores</span>
            <span class="p">)</span>

            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">candidate_batch</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>

            <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">candidate_labels</span><span class="p">,</span> <span class="n">candidate_batch</span><span class="o">.</span><span class="n">scores</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Acquiring (label, score)s: </span><span class="si">{</span><span class="n">ls</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">1120</span><span class="p">,</span>
    <span class="n">max_training_epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">num_patience_epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">max_training_set</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span>
    <span class="n">acquisition_function</span><span class="o">=</span><span class="n">acquisition_functions</span><span class="o">.</span><span class="n">CoreSetBALD</span><span class="p">,</span>
    <span class="n">acquisition_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_pool_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">initial_set_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">min_samples_per_epoch</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resolved: CoreSetBALD with {&#39;acquisition_size&#39;: 10}
Creating: CoreSetBALD(acquisition_size=10)
Training set size 20:
Epoch metrics: {&#39;accuracy&#39;: 0.5625, &#39;crossentropy&#39;: 1.9243805408477783}
Epoch metrics: {&#39;accuracy&#39;: 0.603515625, &#39;crossentropy&#39;: 1.8887556344270706}
Epoch metrics: {&#39;accuracy&#39;: 0.6240234375, &#39;crossentropy&#39;: 2.1746947914361954}
Epoch metrics: {&#39;accuracy&#39;: 0.61328125, &#39;crossentropy&#39;: 2.3827064484357834}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.64453125, &#39;crossentropy&#39;: 2.479841858148575}
Epoch metrics: {&#39;accuracy&#39;: 0.640625, &#39;crossentropy&#39;: 2.706290289759636}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6396484375, &#39;crossentropy&#39;: 2.8794559240341187}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6123046875, &#39;crossentropy&#39;: 2.9785141348838806}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6396484375, &#39;crossentropy&#39;: 3.0672091245651245}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 2.990725100040436}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6171875, &#39;crossentropy&#39;: 3.223605215549469}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6220703125, &#39;crossentropy&#39;: 3.3009057343006134}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6337890625, &#39;crossentropy&#39;: 3.349109262228012}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.62890625, &#39;crossentropy&#39;: 3.4369246065616608}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 3.4102164804935455}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6201171875, &#39;crossentropy&#39;: 3.4621258080005646}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.623046875, &#39;crossentropy&#39;: 3.324983924627304}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6298828125, &#39;crossentropy&#39;: 3.4202836453914642}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.62890625, &#39;crossentropy&#39;: 3.4162855446338654}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6279296875, &#39;crossentropy&#39;: 3.588253676891327}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6240234375, &#39;crossentropy&#39;: 3.770869195461273}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6240234375, &#39;crossentropy&#39;: 3.6572683453559875}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6162109375, &#39;crossentropy&#39;: 3.796562284231186}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 3.576682060956955}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6220703125, &#39;crossentropy&#39;: 3.8413585126399994}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.64453125)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.6353, &#39;crossentropy&#39;: 2.5725278436660766}
Acquiring (label, score)s: 2 (2.969), 8 (2.966), 2 (2.964), 2 (2.964), 2 (2.962), 8 (2.962), 8 (2.959), 2 (2.954), 2 (2.954), 2 (2.951)
Training set size 30:
Epoch metrics: {&#39;accuracy&#39;: 0.1005859375, &#39;crossentropy&#39;: 2.2368642687797546}
Epoch metrics: {&#39;accuracy&#39;: 0.5517578125, &#39;crossentropy&#39;: 1.8454426229000092}
Epoch metrics: {&#39;accuracy&#39;: 0.609375, &#39;crossentropy&#39;: 1.8494705259799957}
Epoch metrics: {&#39;accuracy&#39;: 0.6435546875, &#39;crossentropy&#39;: 2.0600308179855347}
Epoch metrics: {&#39;accuracy&#39;: 0.662109375, &#39;crossentropy&#39;: 2.211219549179077}
Epoch metrics: {&#39;accuracy&#39;: 0.64453125, &#39;crossentropy&#39;: 2.4491908252239227}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 2.298661842942238}
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 2.269408866763115}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6572265625, &#39;crossentropy&#39;: 2.565065383911133}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6552734375, &#39;crossentropy&#39;: 2.4264065325260162}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.634765625, &#39;crossentropy&#39;: 2.710350453853607}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6513671875, &#39;crossentropy&#39;: 2.705546960234642}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 2.4184155613183975}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.669921875, &#39;crossentropy&#39;: 2.727853089570999}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.67578125, &#39;crossentropy&#39;: 2.824436917901039}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 2.7413032948970795}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6806640625, &#39;crossentropy&#39;: 2.9830222427845}
Epoch metrics: {&#39;accuracy&#39;: 0.6796875, &#39;crossentropy&#39;: 2.9595988392829895}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.67578125, &#39;crossentropy&#39;: 2.989212244749069}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6845703125, &#39;crossentropy&#39;: 2.8776000887155533}
Epoch metrics: {&#39;accuracy&#39;: 0.66015625, &#39;crossentropy&#39;: 3.1020855009555817}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 2.7679041624069214}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6630859375, &#39;crossentropy&#39;: 2.890682131052017}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6884765625, &#39;crossentropy&#39;: 2.6214646995067596}
Epoch metrics: {&#39;accuracy&#39;: 0.6748046875, &#39;crossentropy&#39;: 2.800307333469391}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6533203125, &#39;crossentropy&#39;: 2.6758020222187042}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6611328125, &#39;crossentropy&#39;: 2.5604832619428635}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6767578125, &#39;crossentropy&#39;: 2.4849640130996704}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6826171875, &#39;crossentropy&#39;: 2.643627315759659}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 2.7016934156417847}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6748046875, &#39;crossentropy&#39;: 2.7556959986686707}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6826171875, &#39;crossentropy&#39;: 2.7275503873825073}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6875, &#39;crossentropy&#39;: 2.7012477219104767}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 2.8621393144130707}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.669921875, &#39;crossentropy&#39;: 2.745665416121483}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.67578125, &#39;crossentropy&#39;: 2.7576760053634644}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 2.919148698449135}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 2.785452052950859}
Epoch metrics: {&#39;accuracy&#39;: 0.6767578125, &#39;crossentropy&#39;: 3.093669444322586}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 2.890419065952301}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.669921875, &#39;crossentropy&#39;: 2.9178629219532013}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6630859375, &#39;crossentropy&#39;: 3.151269018650055}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.65625, &#39;crossentropy&#39;: 3.3671690821647644}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 3.2399514615535736}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 3.1582747995853424}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 3.0374818444252014}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6845703125, &#39;crossentropy&#39;: 3.118623226881027}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 3.0953444838523865}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6796875, &#39;crossentropy&#39;: 3.1440481543540955}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 2.945765435695648}
RestoringEarlyStopping: 12 / 20
RestoringEarlyStopping: Restoring best parameters. (Score: 0.6904296875)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.6892, &#39;crossentropy&#39;: 2.7490737813949586}
Acquiring (label, score)s: 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996), 9 (2.996)
Training set size 40:
Epoch metrics: {&#39;accuracy&#39;: 0.12109375, &#39;crossentropy&#39;: 2.379997819662094}
Epoch metrics: {&#39;accuracy&#39;: 0.3876953125, &#39;crossentropy&#39;: 1.9273617416620255}
Epoch metrics: {&#39;accuracy&#39;: 0.5283203125, &#39;crossentropy&#39;: 1.7667966485023499}
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.5222818404436111}
Epoch metrics: {&#39;accuracy&#39;: 0.654296875, &#39;crossentropy&#39;: 1.861273929476738}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 1.77246855199337}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6845703125, &#39;crossentropy&#39;: 1.851441815495491}
Epoch metrics: {&#39;accuracy&#39;: 0.6953125, &#39;crossentropy&#39;: 1.95170196890831}
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 1.8197758942842484}
Epoch metrics: {&#39;accuracy&#39;: 0.6953125, &#39;crossentropy&#39;: 1.992052972316742}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.69140625, &#39;crossentropy&#39;: 2.0547159165143967}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6923828125, &#39;crossentropy&#39;: 2.0911835432052612}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7001953125, &#39;crossentropy&#39;: 2.006551593542099}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 2.1823185086250305}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6943359375, &#39;crossentropy&#39;: 2.154583290219307}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7060546875, &#39;crossentropy&#39;: 2.0701963156461716}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 2.1216978281736374}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 2.016114741563797}
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 2.1287850737571716}
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 2.162200316786766}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 2.3362703174352646}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71484375, &#39;crossentropy&#39;: 2.2384333312511444}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 2.292936787009239}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 2.2838530838489532}
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 2.62774994969368}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 2.5714568197727203}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 2.4775630980730057}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7099609375, &#39;crossentropy&#39;: 2.428056925535202}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71484375, &#39;crossentropy&#39;: 2.389461502432823}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7197265625, &#39;crossentropy&#39;: 2.391365125775337}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 2.387502074241638}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.72265625, &#39;crossentropy&#39;: 2.3954713344573975}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.5209222435951233}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7099609375, &#39;crossentropy&#39;: 2.5362570583820343}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 2.4985876232385635}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.705078125, &#39;crossentropy&#39;: 2.451677218079567}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.69140625, &#39;crossentropy&#39;: 2.598998636007309}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.70703125, &#39;crossentropy&#39;: 2.4734355211257935}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 2.611395552754402}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 2.6157397031784058}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 2.645431712269783}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 2.6303927153348923}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.708984375, &#39;crossentropy&#39;: 2.4120941162109375}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 2.503292739391327}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.7236328125)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.711, &#39;crossentropy&#39;: 2.3540270308494566}
Acquiring (label, score)s: 3 (2.996), 3 (2.995), 3 (2.995), 3 (2.994), 3 (2.993), 3 (2.993), 3 (2.993), 3 (2.992), 7 (2.991), 3 (2.991)
Training set size 50:
Epoch metrics: {&#39;accuracy&#39;: 0.17578125, &#39;crossentropy&#39;: 2.4135631024837494}
Epoch metrics: {&#39;accuracy&#39;: 0.2724609375, &#39;crossentropy&#39;: 2.0832259207963943}
Epoch metrics: {&#39;accuracy&#39;: 0.5498046875, &#39;crossentropy&#39;: 1.6470075696706772}
Epoch metrics: {&#39;accuracy&#39;: 0.58984375, &#39;crossentropy&#39;: 1.6465088874101639}
Epoch metrics: {&#39;accuracy&#39;: 0.6923828125, &#39;crossentropy&#39;: 1.4326804280281067}
Epoch metrics: {&#39;accuracy&#39;: 0.6767578125, &#39;crossentropy&#39;: 1.6160162091255188}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6611328125, &#39;crossentropy&#39;: 1.7502113729715347}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6875, &#39;crossentropy&#39;: 1.630200132727623}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6943359375, &#39;crossentropy&#39;: 1.6337660104036331}
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 1.5499579459428787}
Epoch metrics: {&#39;accuracy&#39;: 0.708984375, &#39;crossentropy&#39;: 1.637474611401558}
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 1.710125744342804}
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 1.776924803853035}
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 1.7974900007247925}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.693359375, &#39;crossentropy&#39;: 1.8651755601167679}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6943359375, &#39;crossentropy&#39;: 1.9018292427062988}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71484375, &#39;crossentropy&#39;: 1.8827650845050812}
Epoch metrics: {&#39;accuracy&#39;: 0.689453125, &#39;crossentropy&#39;: 2.0065669268369675}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 1.8744764029979706}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.681640625, &#39;crossentropy&#39;: 2.0503857880830765}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 2.013406828045845}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6982421875, &#39;crossentropy&#39;: 1.879820466041565}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 2.0039362609386444}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6884765625, &#39;crossentropy&#39;: 2.0936598628759384}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6953125, &#39;crossentropy&#39;: 2.1118886321783066}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6943359375, &#39;crossentropy&#39;: 2.181785061955452}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6953125, &#39;crossentropy&#39;: 2.228495240211487}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.69921875, &#39;crossentropy&#39;: 2.0777687579393387}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.66796875, &#39;crossentropy&#39;: 2.2286054491996765}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6962890625, &#39;crossentropy&#39;: 1.8683222383260727}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.69140625, &#39;crossentropy&#39;: 2.0434661209583282}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6796875, &#39;crossentropy&#39;: 2.172104835510254}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.693359375, &#39;crossentropy&#39;: 2.086881324648857}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 2.125195324420929}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 2.0036599934101105}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 2.12324520945549}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 2.1104877591133118}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.71484375)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.6993, &#39;crossentropy&#39;: 1.9531583156585692}
Acquiring (label, score)s: 5 (2.98), 2 (2.978), 5 (2.971), 2 (2.968), 2 (2.966), 5 (2.961), 5 (2.96), 4 (2.957), 1 (2.956), 2 (2.956)
Training set size 60:
Epoch metrics: {&#39;accuracy&#39;: 0.1513671875, &#39;crossentropy&#39;: 2.4607336223125458}
Epoch metrics: {&#39;accuracy&#39;: 0.216796875, &#39;crossentropy&#39;: 2.139497309923172}
Epoch metrics: {&#39;accuracy&#39;: 0.44140625, &#39;crossentropy&#39;: 1.710549995303154}
Epoch metrics: {&#39;accuracy&#39;: 0.6005859375, &#39;crossentropy&#39;: 1.604942962527275}
Epoch metrics: {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 1.5624166131019592}
Epoch metrics: {&#39;accuracy&#39;: 0.6005859375, &#39;crossentropy&#39;: 1.90596441924572}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 1.5570896863937378}
Epoch metrics: {&#39;accuracy&#39;: 0.6884765625, &#39;crossentropy&#39;: 1.6101918667554855}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.697265625, &#39;crossentropy&#39;: 1.7332305163145065}
Epoch metrics: {&#39;accuracy&#39;: 0.6845703125, &#39;crossentropy&#39;: 1.7286424040794373}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6591796875, &#39;crossentropy&#39;: 1.8437085300683975}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 2.073439359664917}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 1.716241255402565}
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 1.7854544818401337}
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 1.7476710826158524}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71484375, &#39;crossentropy&#39;: 1.8553514331579208}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7421875, &#39;crossentropy&#39;: 1.701002597808838}
Epoch metrics: {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 2.2107581943273544}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 2.1985886842012405}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 1.742286890745163}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7255859375, &#39;crossentropy&#39;: 1.7920541912317276}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 1.9480443596839905}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 2.2244859784841537}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 1.9649638682603836}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6982421875, &#39;crossentropy&#39;: 2.114847496151924}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.701171875, &#39;crossentropy&#39;: 2.249983862042427}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.69921875, &#39;crossentropy&#39;: 2.242689326405525}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7353515625, &#39;crossentropy&#39;: 1.9660619646310806}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7373046875, &#39;crossentropy&#39;: 2.0981260538101196}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 2.5562814474105835}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7080078125, &#39;crossentropy&#39;: 2.2047269493341446}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.736328125, &#39;crossentropy&#39;: 1.816601738333702}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7294921875, &#39;crossentropy&#39;: 1.827724039554596}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.689453125, &#39;crossentropy&#39;: 2.3491544127464294}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71484375, &#39;crossentropy&#39;: 1.9693720936775208}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7421875, &#39;crossentropy&#39;: 1.8439625352621078}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.693359375, &#39;crossentropy&#39;: 2.0744085013866425}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.7421875)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.727, &#39;crossentropy&#39;: 1.822578286933899}
Acquiring (label, score)s: 7 (2.988), 7 (2.986), 7 (2.985), 9 (2.976), 7 (2.961), 8 (2.957), 7 (2.948), 7 (2.94), 3 (2.937), 7 (2.936)
Training set size 70:
Epoch metrics: {&#39;accuracy&#39;: 0.1708984375, &#39;crossentropy&#39;: 2.532155007123947}
Epoch metrics: {&#39;accuracy&#39;: 0.294921875, &#39;crossentropy&#39;: 2.1612894535064697}
Epoch metrics: {&#39;accuracy&#39;: 0.3720703125, &#39;crossentropy&#39;: 1.8729366958141327}
Epoch metrics: {&#39;accuracy&#39;: 0.62109375, &#39;crossentropy&#39;: 1.4965855777263641}
Epoch metrics: {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 1.5080440491437912}
Epoch metrics: {&#39;accuracy&#39;: 0.69140625, &#39;crossentropy&#39;: 1.5116523951292038}
Epoch metrics: {&#39;accuracy&#39;: 0.6474609375, &#39;crossentropy&#39;: 1.554263859987259}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 1.4293864220380783}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 1.4169769436120987}
Epoch metrics: {&#39;accuracy&#39;: 0.708984375, &#39;crossentropy&#39;: 1.6235537976026535}
Epoch metrics: {&#39;accuracy&#39;: 0.72265625, &#39;crossentropy&#39;: 1.5412962883710861}
Epoch metrics: {&#39;accuracy&#39;: 0.69140625, &#39;crossentropy&#39;: 1.617454469203949}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 1.5892440229654312}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 1.6969725340604782}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 1.8135524094104767}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7314453125, &#39;crossentropy&#39;: 1.5409817546606064}
Epoch metrics: {&#39;accuracy&#39;: 0.740234375, &#39;crossentropy&#39;: 1.5895468145608902}
Epoch metrics: {&#39;accuracy&#39;: 0.732421875, &#39;crossentropy&#39;: 1.6963671743869781}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7099609375, &#39;crossentropy&#39;: 1.8796014338731766}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7275390625, &#39;crossentropy&#39;: 1.7706325501203537}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.73046875, &#39;crossentropy&#39;: 1.8608116507530212}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.0022645443677902}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.748046875, &#39;crossentropy&#39;: 1.6185535937547684}
Epoch metrics: {&#39;accuracy&#39;: 0.7490234375, &#39;crossentropy&#39;: 1.6990475505590439}
Epoch metrics: {&#39;accuracy&#39;: 0.69921875, &#39;crossentropy&#39;: 1.940165638923645}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 1.8884588479995728}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7265625, &#39;crossentropy&#39;: 1.8623432517051697}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.732421875, &#39;crossentropy&#39;: 1.844548687338829}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 2.0297983288764954}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 1.8713148385286331}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7294921875, &#39;crossentropy&#39;: 1.8743570148944855}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 1.9160615503787994}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 2.049980089068413}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7333984375, &#39;crossentropy&#39;: 1.923774927854538}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7119140625, &#39;crossentropy&#39;: 2.127322778105736}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7216796875, &#39;crossentropy&#39;: 2.0579494535923004}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 2.1088977605104446}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 2.0290678590536118}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.728515625, &#39;crossentropy&#39;: 2.03208264708519}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7509765625, &#39;crossentropy&#39;: 1.8945016264915466}
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.2419088929891586}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 2.0696907490491867}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.734375, &#39;crossentropy&#39;: 1.9333525598049164}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.73046875, &#39;crossentropy&#39;: 1.9147722572088242}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.720703125, &#39;crossentropy&#39;: 2.0657550394535065}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.720703125, &#39;crossentropy&#39;: 2.0139684975147247}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 2.2891644686460495}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 2.126076504588127}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7255859375, &#39;crossentropy&#39;: 1.9660046845674515}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 2.0650075376033783}
RestoringEarlyStopping: 10 / 20
RestoringEarlyStopping: Restoring best parameters. (Score: 0.7509765625)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.7644, &#39;crossentropy&#39;: 1.8328463863372804}
Acquiring (label, score)s: 7 (2.994), 2 (2.99), 6 (2.983), 5 (2.982), 7 (2.977), 6 (2.977), 7 (2.975), 7 (2.972), 8 (2.969), 7 (2.964)
Training set size 80:
Epoch metrics: {&#39;accuracy&#39;: 0.1279296875, &#39;crossentropy&#39;: 2.4012078940868378}
Epoch metrics: {&#39;accuracy&#39;: 0.2685546875, &#39;crossentropy&#39;: 2.294283390045166}
Epoch metrics: {&#39;accuracy&#39;: 0.33984375, &#39;crossentropy&#39;: 2.0728887915611267}
Epoch metrics: {&#39;accuracy&#39;: 0.498046875, &#39;crossentropy&#39;: 1.7314710021018982}
Epoch metrics: {&#39;accuracy&#39;: 0.6533203125, &#39;crossentropy&#39;: 1.5647115260362625}
Epoch metrics: {&#39;accuracy&#39;: 0.6845703125, &#39;crossentropy&#39;: 1.4971317499876022}
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 1.4575025290250778}
Epoch metrics: {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 1.6817454546689987}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.703125, &#39;crossentropy&#39;: 1.6636420041322708}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 1.6834924817085266}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 1.6828026175498962}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 1.6505056619644165}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 1.7422869801521301}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.73046875, &#39;crossentropy&#39;: 1.6465643644332886}
Epoch metrics: {&#39;accuracy&#39;: 0.7333984375, &#39;crossentropy&#39;: 1.698183462023735}
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 1.8346194624900818}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 1.809376746416092}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 1.7414109408855438}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7392578125, &#39;crossentropy&#39;: 1.8290702849626541}
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 2.0023471117019653}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.728515625, &#39;crossentropy&#39;: 1.9364584684371948}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7119140625, &#39;crossentropy&#39;: 2.0308160930871964}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7255859375, &#39;crossentropy&#39;: 1.951304167509079}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 2.083940237760544}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 2.160639598965645}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 1.9130935817956924}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7333984375, &#39;crossentropy&#39;: 1.9151064157485962}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.720703125, &#39;crossentropy&#39;: 1.9894337058067322}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.185949683189392}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 2.1566473990678787}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 2.222986787557602}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71484375, &#39;crossentropy&#39;: 2.265908807516098}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.734375, &#39;crossentropy&#39;: 2.188932493329048}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7431640625, &#39;crossentropy&#39;: 2.027750253677368}
Epoch metrics: {&#39;accuracy&#39;: 0.73828125, &#39;crossentropy&#39;: 1.9692878425121307}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.73046875, &#39;crossentropy&#39;: 2.267870306968689}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 2.467141807079315}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7060546875, &#39;crossentropy&#39;: 2.3677785247564316}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.287088006734848}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 2.304665431380272}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7333984375, &#39;crossentropy&#39;: 2.2649285048246384}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.697265625, &#39;crossentropy&#39;: 2.5169286727905273}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7138671875, &#39;crossentropy&#39;: 2.2608428597450256}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 2.2840421944856644}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 2.519883096218109}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.708984375, &#39;crossentropy&#39;: 2.508927658200264}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 2.363747477531433}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.2803711146116257}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 2.361658200621605}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7314453125, &#39;crossentropy&#39;: 2.1381034404039383}
RestoringEarlyStopping: 16 / 20
RestoringEarlyStopping: Restoring best parameters. (Score: 0.7431640625)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.7592, &#39;crossentropy&#39;: 1.7941985216140748}
Acquiring (label, score)s: 0 (2.991), 7 (2.989), 0 (2.973), 7 (2.97), 0 (2.969), 3 (2.966), 0 (2.963), 0 (2.961), 0 (2.954), 7 (2.939)
Training set size 90:
Epoch metrics: {&#39;accuracy&#39;: 0.212890625, &#39;crossentropy&#39;: 2.430971920490265}
Epoch metrics: {&#39;accuracy&#39;: 0.3310546875, &#39;crossentropy&#39;: 2.266484558582306}
Epoch metrics: {&#39;accuracy&#39;: 0.4130859375, &#39;crossentropy&#39;: 1.7447006553411484}
Epoch metrics: {&#39;accuracy&#39;: 0.6298828125, &#39;crossentropy&#39;: 1.3987921476364136}
Epoch metrics: {&#39;accuracy&#39;: 0.669921875, &#39;crossentropy&#39;: 1.3339970111846924}
Epoch metrics: {&#39;accuracy&#39;: 0.7705078125, &#39;crossentropy&#39;: 1.1636674255132675}
Epoch metrics: {&#39;accuracy&#39;: 0.765625, &#39;crossentropy&#39;: 1.1885648146271706}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8203125, &#39;crossentropy&#39;: 1.0160354673862457}
Epoch metrics: {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 1.1912459135055542}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7900390625, &#39;crossentropy&#39;: 1.1376913264393806}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.80859375, &#39;crossentropy&#39;: 1.0376453176140785}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7783203125, &#39;crossentropy&#39;: 1.1265434995293617}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.802734375, &#39;crossentropy&#39;: 1.0905623733997345}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.828125, &#39;crossentropy&#39;: 1.0941395238041878}
Epoch metrics: {&#39;accuracy&#39;: 0.794921875, &#39;crossentropy&#39;: 1.21263936907053}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.802734375, &#39;crossentropy&#39;: 1.1800715401768684}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7939453125, &#39;crossentropy&#39;: 1.2166080698370934}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8046875, &#39;crossentropy&#39;: 1.133989229798317}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7978515625, &#39;crossentropy&#39;: 1.2041209861636162}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8056640625, &#39;crossentropy&#39;: 1.2126998081803322}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.791015625, &#39;crossentropy&#39;: 1.2250749468803406}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8037109375, &#39;crossentropy&#39;: 1.2739886417984962}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7939453125, &#39;crossentropy&#39;: 1.3419844135642052}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7978515625, &#39;crossentropy&#39;: 1.3370185047388077}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.810546875, &#39;crossentropy&#39;: 1.287501685321331}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.81640625, &#39;crossentropy&#39;: 1.2262103110551834}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.775390625, &#39;crossentropy&#39;: 1.4209925383329391}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7890625, &#39;crossentropy&#39;: 1.3048373311758041}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.810546875, &#39;crossentropy&#39;: 1.2350725755095482}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7939453125, &#39;crossentropy&#39;: 1.3085802271962166}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8017578125, &#39;crossentropy&#39;: 1.3216862976551056}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7998046875, &#39;crossentropy&#39;: 1.2837254330515862}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7998046875, &#39;crossentropy&#39;: 1.2043335735797882}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8134765625, &#39;crossentropy&#39;: 1.2113106548786163}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.828125)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.8147, &#39;crossentropy&#39;: 1.1102329248428344}
Acquiring (label, score)s: 3 (2.864), 3 (2.853), 3 (2.844), 8 (2.82), 8 (2.806), 0 (2.742), 3 (2.724), 3 (2.714), 8 (2.678), 3 (2.674)
Training set size 100:
Epoch metrics: {&#39;accuracy&#39;: 0.177734375, &#39;crossentropy&#39;: 2.408938854932785}
Epoch metrics: {&#39;accuracy&#39;: 0.3369140625, &#39;crossentropy&#39;: 2.1812556385993958}
Epoch metrics: {&#39;accuracy&#39;: 0.3662109375, &#39;crossentropy&#39;: 1.8881189823150635}
Epoch metrics: {&#39;accuracy&#39;: 0.5107421875, &#39;crossentropy&#39;: 1.556248500943184}
Epoch metrics: {&#39;accuracy&#39;: 0.5751953125, &#39;crossentropy&#39;: 1.4265065640211105}
Epoch metrics: {&#39;accuracy&#39;: 0.720703125, &#39;crossentropy&#39;: 1.1450789719820023}
Epoch metrics: {&#39;accuracy&#39;: 0.8037109375, &#39;crossentropy&#39;: 1.0250877887010574}
Epoch metrics: {&#39;accuracy&#39;: 0.787109375, &#39;crossentropy&#39;: 1.0337121561169624}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8134765625, &#39;crossentropy&#39;: 0.9491639658808708}
Epoch metrics: {&#39;accuracy&#39;: 0.8232421875, &#39;crossentropy&#39;: 0.9911399409174919}
Epoch metrics: {&#39;accuracy&#39;: 0.8037109375, &#39;crossentropy&#39;: 1.0833387970924377}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8505859375, &#39;crossentropy&#39;: 0.9368879944086075}
Epoch metrics: {&#39;accuracy&#39;: 0.8251953125, &#39;crossentropy&#39;: 0.983242392539978}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8447265625, &#39;crossentropy&#39;: 0.9956708997488022}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.82421875, &#39;crossentropy&#39;: 0.9834236204624176}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8583984375, &#39;crossentropy&#39;: 0.8844689950346947}
Epoch metrics: {&#39;accuracy&#39;: 0.859375, &#39;crossentropy&#39;: 0.8644372820854187}
Epoch metrics: {&#39;accuracy&#39;: 0.845703125, &#39;crossentropy&#39;: 0.9445488080382347}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.857421875, &#39;crossentropy&#39;: 0.9389937371015549}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8505859375, &#39;crossentropy&#39;: 0.9448843598365784}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8251953125, &#39;crossentropy&#39;: 1.0934626832604408}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.822265625, &#39;crossentropy&#39;: 1.037511594593525}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8408203125, &#39;crossentropy&#39;: 1.0180891454219818}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.85546875, &#39;crossentropy&#39;: 0.9919600039720535}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8408203125, &#39;crossentropy&#39;: 0.9999148026108742}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8349609375, &#39;crossentropy&#39;: 1.052244246006012}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.845703125, &#39;crossentropy&#39;: 0.9727168381214142}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.833984375, &#39;crossentropy&#39;: 1.0610089898109436}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8505859375, &#39;crossentropy&#39;: 1.0152132660150528}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.845703125, &#39;crossentropy&#39;: 1.0492682829499245}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8310546875, &#39;crossentropy&#39;: 1.0329977497458458}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8486328125, &#39;crossentropy&#39;: 0.9950717240571976}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.84765625, &#39;crossentropy&#39;: 1.0280130803585052}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8408203125, &#39;crossentropy&#39;: 1.097293883562088}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8369140625, &#39;crossentropy&#39;: 1.1232056841254234}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8330078125, &#39;crossentropy&#39;: 1.0803474336862564}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.082754872739315}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.859375)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.8585, &#39;crossentropy&#39;: 0.908685311794281}
Acquiring (label, score)s: 2 (2.92), 7 (2.896), 9 (2.842), 2 (2.796), 2 (2.778), 3 (2.739), 9 (2.725), 2 (2.689), 2 (2.677), 2 (2.674)
Training set size 110:
Epoch metrics: {&#39;accuracy&#39;: 0.197265625, &#39;crossentropy&#39;: 2.3300057351589203}
Epoch metrics: {&#39;accuracy&#39;: 0.3330078125, &#39;crossentropy&#39;: 2.249125212430954}
Epoch metrics: {&#39;accuracy&#39;: 0.3974609375, &#39;crossentropy&#39;: 1.9041588306427002}
Epoch metrics: {&#39;accuracy&#39;: 0.4951171875, &#39;crossentropy&#39;: 1.5578295290470123}
Epoch metrics: {&#39;accuracy&#39;: 0.59765625, &#39;crossentropy&#39;: 1.4012781381607056}
Epoch metrics: {&#39;accuracy&#39;: 0.6611328125, &#39;crossentropy&#39;: 1.2821155339479446}
Epoch metrics: {&#39;accuracy&#39;: 0.7431640625, &#39;crossentropy&#39;: 1.1625007092952728}
Epoch metrics: {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 1.1449115201830864}
Epoch metrics: {&#39;accuracy&#39;: 0.798828125, &#39;crossentropy&#39;: 1.028448924422264}
Epoch metrics: {&#39;accuracy&#39;: 0.791015625, &#39;crossentropy&#39;: 1.0521124377846718}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8154296875, &#39;crossentropy&#39;: 1.012509785592556}
Epoch metrics: {&#39;accuracy&#39;: 0.7919921875, &#39;crossentropy&#39;: 1.1304361671209335}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8359375, &#39;crossentropy&#39;: 0.9351537302136421}
Epoch metrics: {&#39;accuracy&#39;: 0.8037109375, &#39;crossentropy&#39;: 1.082125462591648}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.81640625, &#39;crossentropy&#39;: 1.034419171512127}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8515625, &#39;crossentropy&#39;: 0.9199785515666008}
Epoch metrics: {&#39;accuracy&#39;: 0.8193359375, &#39;crossentropy&#39;: 1.0581122264266014}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8173828125, &#39;crossentropy&#39;: 1.0608437657356262}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8076171875, &#39;crossentropy&#39;: 1.1208752542734146}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.830078125, &#39;crossentropy&#39;: 1.0506053641438484}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8447265625, &#39;crossentropy&#39;: 0.9436459243297577}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.822265625, &#39;crossentropy&#39;: 1.0935188233852386}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83203125, &#39;crossentropy&#39;: 1.0546460375189781}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.833984375, &#39;crossentropy&#39;: 1.0553549602627754}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.833984375, &#39;crossentropy&#39;: 1.0423320680856705}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8271484375, &#39;crossentropy&#39;: 1.1120744124054909}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8369140625, &#39;crossentropy&#39;: 1.0717185512185097}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8486328125, &#39;crossentropy&#39;: 1.0484619587659836}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8427734375, &#39;crossentropy&#39;: 1.0577404722571373}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.828125, &#39;crossentropy&#39;: 1.0960659086704254}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83984375, &#39;crossentropy&#39;: 1.1736992448568344}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8330078125, &#39;crossentropy&#39;: 1.0758476555347443}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.841796875, &#39;crossentropy&#39;: 1.0891931802034378}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.1152585223317146}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8154296875, &#39;crossentropy&#39;: 1.3192718252539635}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8193359375, &#39;crossentropy&#39;: 1.2395559325814247}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.8515625)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.8507, &#39;crossentropy&#39;: 0.9350105172634124}
Acquiring (label, score)s: 3 (2.889), 3 (2.837), 3 (2.824), 4 (2.815), 3 (2.784), 4 (2.778), 4 (2.755), 4 (2.743), 4 (2.737), 4 (2.736)
Training set size 120:
Epoch metrics: {&#39;accuracy&#39;: 0.1669921875, &#39;crossentropy&#39;: 2.3794606626033783}
Epoch metrics: {&#39;accuracy&#39;: 0.2587890625, &#39;crossentropy&#39;: 2.278480738401413}
Epoch metrics: {&#39;accuracy&#39;: 0.4228515625, &#39;crossentropy&#39;: 1.9074620306491852}
Epoch metrics: {&#39;accuracy&#39;: 0.548828125, &#39;crossentropy&#39;: 1.6533324420452118}
Epoch metrics: {&#39;accuracy&#39;: 0.5927734375, &#39;crossentropy&#39;: 1.4102115631103516}
Epoch metrics: {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.3191122263669968}
Epoch metrics: {&#39;accuracy&#39;: 0.732421875, &#39;crossentropy&#39;: 1.1748356372117996}
Epoch metrics: {&#39;accuracy&#39;: 0.78515625, &#39;crossentropy&#39;: 1.0839967876672745}
Epoch metrics: {&#39;accuracy&#39;: 0.7783203125, &#39;crossentropy&#39;: 1.0453211814165115}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7978515625, &#39;crossentropy&#39;: 1.072489745914936}
Epoch metrics: {&#39;accuracy&#39;: 0.8203125, &#39;crossentropy&#39;: 0.9832581356167793}
Epoch metrics: {&#39;accuracy&#39;: 0.8173828125, &#39;crossentropy&#39;: 0.9980382025241852}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8369140625, &#39;crossentropy&#39;: 0.9565797671675682}
Epoch metrics: {&#39;accuracy&#39;: 0.8505859375, &#39;crossentropy&#39;: 0.9604948237538338}
Epoch metrics: {&#39;accuracy&#39;: 0.845703125, &#39;crossentropy&#39;: 0.9630422219634056}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.837890625, &#39;crossentropy&#39;: 0.9576939791440964}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8310546875, &#39;crossentropy&#39;: 1.0078349485993385}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8671875, &#39;crossentropy&#39;: 0.9084650874137878}
Epoch metrics: {&#39;accuracy&#39;: 0.8427734375, &#39;crossentropy&#39;: 0.9297937825322151}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.85546875, &#39;crossentropy&#39;: 0.9137906804680824}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83203125, &#39;crossentropy&#39;: 1.0122395530343056}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.849609375, &#39;crossentropy&#39;: 0.9448239132761955}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8408203125, &#39;crossentropy&#39;: 1.0603142827749252}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.0256159380078316}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8408203125, &#39;crossentropy&#39;: 1.0247985497117043}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.861328125, &#39;crossentropy&#39;: 0.9566212147474289}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8544921875, &#39;crossentropy&#39;: 1.005024641752243}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8310546875, &#39;crossentropy&#39;: 1.1034929230809212}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.869140625, &#39;crossentropy&#39;: 1.0169270858168602}
Epoch metrics: {&#39;accuracy&#39;: 0.8623046875, &#39;crossentropy&#39;: 0.969062939286232}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8544921875, &#39;crossentropy&#39;: 0.9532972797751427}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.841796875, &#39;crossentropy&#39;: 1.0122552514076233}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.84375, &#39;crossentropy&#39;: 1.1232183203101158}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8583984375, &#39;crossentropy&#39;: 0.9892087578773499}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8447265625, &#39;crossentropy&#39;: 1.0054823085665703}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8564453125, &#39;crossentropy&#39;: 1.0229824781417847}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8623046875, &#39;crossentropy&#39;: 1.0015609040856361}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.876953125, &#39;crossentropy&#39;: 0.9580964595079422}
Epoch metrics: {&#39;accuracy&#39;: 0.8779296875, &#39;crossentropy&#39;: 0.9359661340713501}
Epoch metrics: {&#39;accuracy&#39;: 0.8681640625, &#39;crossentropy&#39;: 1.0124109238386154}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.0948865562677383}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.84765625, &#39;crossentropy&#39;: 1.0721070617437363}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.861328125, &#39;crossentropy&#39;: 0.9782651513814926}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.873046875, &#39;crossentropy&#39;: 0.9219184964895248}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8642578125, &#39;crossentropy&#39;: 0.9483298063278198}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.0814068913459778}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.873046875, &#39;crossentropy&#39;: 1.019004262983799}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.865234375, &#39;crossentropy&#39;: 1.0462844595313072}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8642578125, &#39;crossentropy&#39;: 1.0576064586639404}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.857421875, &#39;crossentropy&#39;: 1.0599323958158493}
RestoringEarlyStopping: 11 / 20
RestoringEarlyStopping: Restoring best parameters. (Score: 0.8779296875)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.8696, &#39;crossentropy&#39;: 0.9649905386924744}
Acquiring (label, score)s: 9 (2.943), 8 (2.942), 2 (2.918), 2 (2.918), 9 (2.913), 0 (2.912), 8 (2.905), 9 (2.879), 8 (2.871), 2 (2.863)
Training set size 130:
Epoch metrics: {&#39;accuracy&#39;: 0.14453125, &#39;crossentropy&#39;: 2.401725471019745}
Epoch metrics: {&#39;accuracy&#39;: 0.3369140625, &#39;crossentropy&#39;: 2.153055429458618}
Epoch metrics: {&#39;accuracy&#39;: 0.4296875, &#39;crossentropy&#39;: 1.8535093069076538}
Epoch metrics: {&#39;accuracy&#39;: 0.4853515625, &#39;crossentropy&#39;: 1.6146134436130524}
Epoch metrics: {&#39;accuracy&#39;: 0.5947265625, &#39;crossentropy&#39;: 1.422270342707634}
Epoch metrics: {&#39;accuracy&#39;: 0.681640625, &#39;crossentropy&#39;: 1.2659776359796524}
Epoch metrics: {&#39;accuracy&#39;: 0.7431640625, &#39;crossentropy&#39;: 1.1356853023171425}
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 1.210671216249466}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.794921875, &#39;crossentropy&#39;: 1.029346726834774}
Epoch metrics: {&#39;accuracy&#39;: 0.779296875, &#39;crossentropy&#39;: 1.0315763801336288}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.828125, &#39;crossentropy&#39;: 0.943256676197052}
Epoch metrics: {&#39;accuracy&#39;: 0.822265625, &#39;crossentropy&#39;: 0.9614809975028038}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.81640625, &#39;crossentropy&#39;: 0.9901624694466591}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8232421875, &#39;crossentropy&#39;: 0.9555470645427704}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8369140625, &#39;crossentropy&#39;: 0.9260516837239265}
Epoch metrics: {&#39;accuracy&#39;: 0.8134765625, &#39;crossentropy&#39;: 0.9804666116833687}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8271484375, &#39;crossentropy&#39;: 1.0235135927796364}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8154296875, &#39;crossentropy&#39;: 1.097398780286312}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8056640625, &#39;crossentropy&#39;: 1.1003508940339088}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.802734375, &#39;crossentropy&#39;: 1.0489184707403183}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8486328125, &#39;crossentropy&#39;: 0.9868922010064125}
Epoch metrics: {&#39;accuracy&#39;: 0.828125, &#39;crossentropy&#39;: 1.029290646314621}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8212890625, &#39;crossentropy&#39;: 1.1033719256520271}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83203125, &#39;crossentropy&#39;: 1.0505797043442726}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8388671875, &#39;crossentropy&#39;: 1.0428545698523521}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8046875, &#39;crossentropy&#39;: 1.1964741125702858}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.837890625, &#39;crossentropy&#39;: 1.023539587855339}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.84375, &#39;crossentropy&#39;: 0.9867456927895546}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8388671875, &#39;crossentropy&#39;: 0.9919849783182144}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8408203125, &#39;crossentropy&#39;: 1.0108883082866669}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83984375, &#39;crossentropy&#39;: 1.0134151354432106}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8310546875, &#39;crossentropy&#39;: 1.0874526277184486}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8525390625, &#39;crossentropy&#39;: 0.9607235491275787}
Epoch metrics: {&#39;accuracy&#39;: 0.822265625, &#39;crossentropy&#39;: 1.0969308093190193}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8515625, &#39;crossentropy&#39;: 1.0302243530750275}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8505859375, &#39;crossentropy&#39;: 1.0250359028577805}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.0366311743855476}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8447265625, &#39;crossentropy&#39;: 1.0401972606778145}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.85546875, &#39;crossentropy&#39;: 1.0374843329191208}
Epoch metrics: {&#39;accuracy&#39;: 0.8515625, &#39;crossentropy&#39;: 1.048847734928131}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.849609375, &#39;crossentropy&#39;: 1.0352794155478477}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8466796875, &#39;crossentropy&#39;: 1.0691032111644745}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8447265625, &#39;crossentropy&#39;: 1.0610898211598396}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.833984375, &#39;crossentropy&#39;: 1.1265636160969734}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83984375, &#39;crossentropy&#39;: 1.0789125114679337}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83203125, &#39;crossentropy&#39;: 1.1805928573012352}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.833984375, &#39;crossentropy&#39;: 1.15541223436594}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.83984375, &#39;crossentropy&#39;: 1.1614402532577515}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.84375, &#39;crossentropy&#39;: 1.1322411969304085}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.8515625, &#39;crossentropy&#39;: 1.1493326276540756}
RestoringEarlyStopping: 11 / 20
RestoringEarlyStopping: Restoring best parameters. (Score: 0.85546875)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.8649, &#39;crossentropy&#39;: 0.9703734568595886}
Done.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;initial_training_set_indices&#39;: [38043,
  40091,
  17418,
  2094,
  39879,
  3133,
  5011,
  40683,
  54379,
  24287,
  9849,
  59305,
  39508,
  39356,
  8758,
  52579,
  13655,
  7636,
  21562,
  41329],
 &#39;dataset_info&#39;: {&#39;training&#39;: &#34;&#39;FastMNIST (Train)&#39;&#34;,
  &#39;test&#39;: &#34;&#39;FastMNIST (Test)&#39;&#34;},
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.62109375,
      &#39;crossentropy&#39;: 2.6530187726020813},
     {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 2.762658029794693},
     {&#39;accuracy&#39;: 0.646484375, &#39;crossentropy&#39;: 3.056214064359665},
     {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 3.1257119178771973}],
    &#39;best_epoch&#39;: 1},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.631,
    &#39;crossentropy&#39;: 2.6251225173950195}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span>
    <span class="n">max_training_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_training_set</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">acquisition_function</span><span class="o">=</span><span class="n">AcquisitionFunction</span><span class="o">.</span><span class="n">randombaldical</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set size 20:
RestoringEarlyStopping: Restoring best parameters. (Score: -6.529030114412308)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.5367, &#39;crossentropy&#39;: 6.438035237884521}
RestoringEarlyStopping: Restoring best parameters. (Score: -5.1637596152722836)
RestoringEarlyStopping: Restoring optimizer.
Acquiring (label, score)s: 8 (0.8711), 8 (0.8687), 3 (0.876), 3 (0.8465), 3 (0.8811)
Training set size 25:
RestoringEarlyStopping: Restoring best parameters. (Score: -4.6851686127483845)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.6256, &#39;crossentropy&#39;: 4.484497045135498}
Done.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;initial_training_set_indices&#39;: [38043,
  40091,
  17418,
  2094,
  39879,
  3133,
  5011,
  40683,
  54379,
  24287,
  9849,
  59305,
  39508,
  39356,
  8758,
  52579,
  13655,
  7636,
  21562,
  41329],
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.538818359375,
      &#39;crossentropy&#39;: 6.529030114412308}],
    &#39;best_epoch&#39;: 1},
   &#39;evalution_metrics&#39;: {&#39;accuracy&#39;: 0.5367,
    &#39;crossentropy&#39;: 6.438035237884521},
   &#39;pool_training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.531005859375,
      &#39;crossentropy&#39;: 5.1637596152722836}],
    &#39;best_epoch&#39;: 1},
   &#39;acquisition&#39;: {&#39;indices&#39;: [63338, 10856, 63452, 81864, 109287],
    &#39;labels&#39;: [8, 8, 3, 3, 3],
    &#39;scores&#39;: [0.8710822958846325,
     0.8687216999221631,
     0.8759664372823723,
     0.8464646732511746,
     0.8810812784952251]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.62255859375,
      &#39;crossentropy&#39;: 4.6851686127483845}],
    &#39;best_epoch&#39;: 1},
   &#39;evalution_metrics&#39;: {&#39;accuracy&#39;: 0.6256,
    &#39;crossentropy&#39;: 4.484497045135498}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Experiment</span><span class="p">(</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">acquisition_function</span><span class="o">=</span><span class="n">acquisition_functions</span><span class="o">.</span><span class="n">CoreSetBALD</span><span class="p">,</span>
        <span class="n">acquisition_size</span><span class="o">=</span><span class="n">acquisition_size</span><span class="p">,</span>
        <span class="n">num_pool_samples</span><span class="o">=</span><span class="n">num_pool_samples</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">acquisition_function</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="n">acquisition_functions</span><span class="o">.</span><span class="n">BALD</span><span class="p">,</span>
        <span class="n">acquisition_functions</span><span class="o">.</span><span class="n">TemperedBALD</span><span class="p">,</span>
        <span class="n">acquisition_functions</span><span class="o">.</span><span class="n">CoreSetBALD</span><span class="p">,</span>
        <span class="n">acquisition_functions</span><span class="o">.</span><span class="n">TemperedCoreSetBALD</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">acquisition_size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">num_pool_samples</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">Experiment</span><span class="p">(</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">acquisition_function</span><span class="o">=</span><span class="n">acquisition_functions</span><span class="o">.</span><span class="n">Random</span><span class="p">,</span>
        <span class="n">acquisition_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">num_pool_samples</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">is_run_from_ipython</span><span class="p">()</span> <span class="ow">and</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">store</span> <span class="ow">in</span> <span class="n">embedded_experiments</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">job_id</span><span class="p">]</span>
        <span class="n">config</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="n">job_id</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">store</span><span class="p">[</span><span class="s2">&quot;exception&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="k">raise</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>40</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

