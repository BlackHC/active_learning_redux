---

title: Test OBI Code


keywords: fastai
sidebar: home_sidebar

summary: "Ignorance is strength"
description: "Ignorance is strength"
nb_path: "D_test_obi.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: D_test_obi.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">batchbald_redux</span> <span class="kn">import</span> <span class="n">online_bayesian_inference</span>
<span class="kn">import</span> <span class="nn">torch</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exp1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">Exponential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_probs</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">exp1</span><span class="o">.</span><span class="n">sample_n</span><span class="p">(</span><span class="mi">100000</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_probs</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_probs</span><span class="o">.</span><span class="n">double</span><span class="p">())</span><span class="o">.</span><span class="n">float</span><span class="p">(),</span> <span class="n">online_bayesian_inference</span><span class="o">.</span><span class="n">sum_log_probs</span><span class="p">(</span><span class="n">log_probs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(59585.6602), tensor(59585.6641), tensor(59585.6641))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10000</span><span class="p">))</span>
<span class="n">log_probs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-0.0147, -0.9602, -0.4252,  ..., -0.1417, -2.7528, -2.2379])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_probs</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">log_probs</span><span class="o">.</span><span class="n">double</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor(-10135.6260), tensor(-10135.6260, dtype=torch.float64))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Retrain-to-90%-with-55-samples">Retrain to 90% with 55 samples<a class="anchor-link" href="#Retrain-to-90%-with-55-samples"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">training_set_90</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">46377</span><span class="p">,</span>
    <span class="mi">44390</span><span class="p">,</span>
    <span class="mi">7485</span><span class="p">,</span>
    <span class="mi">25450</span><span class="p">,</span>
    <span class="mi">12220</span><span class="p">,</span>
    <span class="mi">43112</span><span class="p">,</span>
    <span class="mi">3612</span><span class="p">,</span>
    <span class="mi">54256</span><span class="p">,</span>
    <span class="mi">44467</span><span class="p">,</span>
    <span class="mi">17555</span><span class="p">,</span>
    <span class="mi">4218</span><span class="p">,</span>
    <span class="mi">45101</span><span class="p">,</span>
    <span class="mi">41296</span><span class="p">,</span>
    <span class="mi">32261</span><span class="p">,</span>
    <span class="mi">3281</span><span class="p">,</span>
    <span class="mi">6944</span><span class="p">,</span>
    <span class="mi">7701</span><span class="p">,</span>
    <span class="mi">30692</span><span class="p">,</span>
    <span class="mi">24891</span><span class="p">,</span>
    <span class="mi">24436</span><span class="p">,</span>
    <span class="mi">17776</span><span class="p">,</span>
    <span class="mi">36852</span><span class="p">,</span>
    <span class="mi">26891</span><span class="p">,</span>
    <span class="mi">17001</span><span class="p">,</span>
    <span class="mi">44414</span><span class="p">,</span>
    <span class="mi">23050</span><span class="p">,</span>
    <span class="mi">30884</span><span class="p">,</span>
    <span class="mi">41516</span><span class="p">,</span>
    <span class="mi">8897</span><span class="p">,</span>
    <span class="mi">34608</span><span class="p">,</span>
    <span class="mi">11721</span><span class="p">,</span>
    <span class="mi">13127</span><span class="p">,</span>
    <span class="mi">9870</span><span class="p">,</span>
    <span class="mi">39700</span><span class="p">,</span>
    <span class="mi">13985</span><span class="p">,</span>
    <span class="mi">9608</span><span class="p">,</span>
    <span class="mi">17808</span><span class="p">,</span>
    <span class="mi">23028</span><span class="p">,</span>
    <span class="mi">3494</span><span class="p">,</span>
    <span class="mi">10210</span><span class="p">,</span>
    <span class="mi">42384</span><span class="p">,</span>
    <span class="mi">31742</span><span class="p">,</span>
    <span class="mi">17100</span><span class="p">,</span>
    <span class="mi">46530</span><span class="p">,</span>
    <span class="mi">26733</span><span class="p">,</span>
    <span class="mi">4762</span><span class="p">,</span>
    <span class="mi">14113</span><span class="p">,</span>
    <span class="mi">20798</span><span class="p">,</span>
    <span class="mi">28388</span><span class="p">,</span>
    <span class="mi">42973</span><span class="p">,</span>
    <span class="mi">37347</span><span class="p">,</span>
    <span class="mi">55042</span><span class="p">,</span>
    <span class="mi">41295</span><span class="p">,</span>
    <span class="mi">28310</span><span class="p">,</span>
    <span class="mi">19280</span><span class="p">,</span>
    <span class="mi">18501</span><span class="p">,</span>
    <span class="mi">274</span><span class="p">,</span>
    <span class="mi">11208</span><span class="p">,</span>
    <span class="mi">13335</span><span class="p">,</span>
    <span class="mi">24440</span><span class="p">,</span>
    <span class="mi">49493</span><span class="p">,</span>
    <span class="mi">58129</span><span class="p">,</span>
    <span class="mi">56210</span><span class="p">,</span>
    <span class="mi">40766</span><span class="p">,</span>
    <span class="mi">13318</span><span class="p">,</span>
    <span class="mi">50040</span><span class="p">,</span>
    <span class="mi">18408</span><span class="p">,</span>
    <span class="mi">7255</span><span class="p">,</span>
    <span class="mi">15494</span><span class="p">,</span>
    <span class="mi">7168</span><span class="p">,</span>
    <span class="mi">9472</span><span class="p">,</span>
    <span class="mi">14845</span><span class="p">,</span>
    <span class="mi">14096</span><span class="p">,</span>
    <span class="mi">26072</span><span class="p">,</span>
    <span class="mi">35944</span><span class="p">,</span>
    <span class="mi">34836</span><span class="p">,</span>
    <span class="mi">12655</span><span class="p">,</span>
    <span class="mi">991</span><span class="p">,</span>
    <span class="mi">38577</span><span class="p">,</span>
    <span class="mi">47322</span><span class="p">,</span>
    <span class="mi">45212</span><span class="p">,</span>
    <span class="mi">16286</span><span class="p">,</span>
    <span class="mi">5308</span><span class="p">,</span>
    <span class="mi">38182</span><span class="p">,</span>
    <span class="mi">31624</span><span class="p">,</span>
    <span class="mi">12702</span><span class="p">,</span>
    <span class="mi">30861</span><span class="p">,</span>
    <span class="mi">46320</span><span class="p">,</span>
    <span class="mi">36408</span><span class="p">,</span>
    <span class="mi">49841</span><span class="p">,</span>
    <span class="mi">33426</span><span class="p">,</span>
    <span class="mi">57527</span><span class="p">,</span>
    <span class="mi">3273</span><span class="p">,</span>
    <span class="mi">24740</span><span class="p">,</span>
    <span class="mi">39627</span><span class="p">,</span>
    <span class="mi">22199</span><span class="p">,</span>
    <span class="mi">19362</span><span class="p">,</span>
    <span class="mi">42136</span><span class="p">,</span>
    <span class="mi">41965</span><span class="p">,</span>
    <span class="mi">43095</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">training_set_90</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">51348</span><span class="p">,</span>
 <span class="mi">49110</span><span class="p">,</span>
 <span class="mi">8222</span><span class="p">,</span>
 <span class="mi">28130</span><span class="p">,</span>
 <span class="mi">13484</span><span class="p">,</span>
 <span class="mi">47685</span><span class="p">,</span>
 <span class="mi">3938</span><span class="p">,</span>
 <span class="mi">59930</span><span class="p">,</span>
 <span class="mi">49196</span><span class="p">,</span>
 <span class="mi">19427</span><span class="p">,</span>
 <span class="mi">4601</span><span class="p">,</span>
 <span class="mi">49922</span><span class="p">,</span>
 <span class="mi">45635</span><span class="p">,</span>
 <span class="mi">35684</span><span class="p">,</span>
 <span class="mi">3579</span><span class="p">,</span>
 <span class="mi">7621</span><span class="p">,</span>
 <span class="mi">8465</span><span class="p">,</span>
 <span class="mi">33959</span><span class="p">,</span>
 <span class="mi">27521</span><span class="p">,</span>
 <span class="mi">27015</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">training_set_90</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">46377</span><span class="p">,</span>
    <span class="mi">44390</span><span class="p">,</span>
    <span class="mi">7485</span><span class="p">,</span>
    <span class="mi">25450</span><span class="p">,</span>
    <span class="mi">12220</span><span class="p">,</span>
    <span class="mi">43112</span><span class="p">,</span>
    <span class="mi">3612</span><span class="p">,</span>
    <span class="mi">54256</span><span class="p">,</span>
    <span class="mi">44467</span><span class="p">,</span>
    <span class="mi">17555</span><span class="p">,</span>
    <span class="mi">4218</span><span class="p">,</span>
    <span class="mi">45101</span><span class="p">,</span>
    <span class="mi">41296</span><span class="p">,</span>
    <span class="mi">32261</span><span class="p">,</span>
    <span class="mi">3281</span><span class="p">,</span>
    <span class="mi">6944</span><span class="p">,</span>
    <span class="mi">7701</span><span class="p">,</span>
    <span class="mi">30692</span><span class="p">,</span>
    <span class="mi">24891</span><span class="p">,</span>
    <span class="mi">24436</span><span class="p">,</span>
    <span class="mi">2748</span><span class="p">,</span>
    <span class="mi">34</span><span class="p">,</span>
    <span class="mi">8009</span><span class="p">,</span>
    <span class="mi">27203</span><span class="p">,</span>
    <span class="mi">54180</span><span class="p">,</span>
    <span class="mi">39513</span><span class="p">,</span>
    <span class="mi">45801</span><span class="p">,</span>
    <span class="mi">34608</span><span class="p">,</span>
    <span class="mi">57338</span><span class="p">,</span>
    <span class="mi">37095</span><span class="p">,</span>
    <span class="mi">5474</span><span class="p">,</span>
    <span class="mi">7304</span><span class="p">,</span>
    <span class="mi">13153</span><span class="p">,</span>
    <span class="mi">4820</span><span class="p">,</span>
    <span class="mi">49406</span><span class="p">,</span>
    <span class="mi">7865</span><span class="p">,</span>
    <span class="mi">7863</span><span class="p">,</span>
    <span class="mi">42303</span><span class="p">,</span>
    <span class="mi">2942</span><span class="p">,</span>
    <span class="mi">52175</span><span class="p">,</span>
    <span class="mi">57842</span><span class="p">,</span>
    <span class="mi">9472</span><span class="p">,</span>
    <span class="mi">16908</span><span class="p">,</span>
    <span class="mi">12585</span><span class="p">,</span>
    <span class="mi">29130</span><span class="p">,</span>
    <span class="mi">29839</span><span class="p">,</span>
    <span class="mi">49509</span><span class="p">,</span>
    <span class="mi">6947</span><span class="p">,</span>
    <span class="mi">18501</span><span class="p">,</span>
    <span class="mi">12422</span><span class="p">,</span>
    <span class="mi">3742</span><span class="p">,</span>
    <span class="mi">19362</span><span class="p">,</span>
    <span class="mi">43169</span><span class="p">,</span>
    <span class="mi">44202</span><span class="p">,</span>
    <span class="mi">22497</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">training_set_90</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">51348</span><span class="p">,</span>
 <span class="mi">49110</span><span class="p">,</span>
 <span class="mi">8222</span><span class="p">,</span>
 <span class="mi">28130</span><span class="p">,</span>
 <span class="mi">13484</span><span class="p">,</span>
 <span class="mi">47685</span><span class="p">,</span>
 <span class="mi">3938</span><span class="p">,</span>
 <span class="mi">59930</span><span class="p">,</span>
 <span class="mi">49196</span><span class="p">,</span>
 <span class="mi">19427</span><span class="p">,</span>
 <span class="mi">4601</span><span class="p">,</span>
 <span class="mi">49922</span><span class="p">,</span>
 <span class="mi">45635</span><span class="p">,</span>
 <span class="mi">35684</span><span class="p">,</span>
 <span class="mi">3579</span><span class="p">,</span>
 <span class="mi">7621</span><span class="p">,</span>
 <span class="mi">8465</span><span class="p">,</span>
 <span class="mi">33959</span><span class="p">,</span>
 <span class="mi">27521</span><span class="p">,</span>
 <span class="mi">27015</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.utils.data</span>
<span class="kn">from</span> <span class="nn">blackhc.project</span> <span class="kn">import</span> <span class="n">is_run_from_ipython</span>
<span class="kn">from</span> <span class="nn">blackhc.project.experiment</span> <span class="kn">import</span> <span class="n">embedded_experiments</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="kn">import</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="k">as</span> <span class="nn">acquisition_functions</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CandidateBatchComputer</span><span class="p">,</span>
    <span class="n">EvalModelBatchComputer</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.active_learning</span> <span class="kn">import</span> <span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">RandomFixedLengthSampler</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.black_box_model_training</span> <span class="kn">import</span> <span class="n">evaluate_old</span><span class="p">,</span> <span class="n">train</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.dataset_challenges</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AdditiveGaussianNoise</span><span class="p">,</span>
    <span class="n">NamedDataset</span><span class="p">,</span>
    <span class="n">create_repeated_MNIST_dataset</span><span class="p">,</span>
    <span class="n">get_balanced_sample_indices</span><span class="p">,</span>
    <span class="n">get_base_dataset_index</span><span class="p">,</span>
    <span class="n">get_target</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.di</span> <span class="kn">import</span> <span class="n">DependencyInjection</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.fast_mnist</span> <span class="kn">import</span> <span class="n">FastMNIST</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.model_optimizer_factory</span> <span class="kn">import</span> <span class="n">ModelOptimizerFactory</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.models</span> <span class="kn">import</span> <span class="n">MnistOptimizerFactory</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">batchbald_redux.train_eval_model</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TrainEvalModel</span><span class="p">,</span>
    <span class="n">TrainSelfDistillationEvalModel</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.trained_model</span> <span class="kn">import</span> <span class="n">TrainedBayesianModel</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">blackhc.progress_bar</span> <span class="kn">import</span> <span class="n">create_progress_bar</span>
<span class="kn">from</span> <span class="nn">toma</span> <span class="kn">import</span> <span class="n">toma</span>


<span class="k">def</span> <span class="nf">compute_entropy_from_probs</span><span class="p">(</span><span class="n">probs_N_K_C</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">probs_N_K_C</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">entropies_N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>

    <span class="n">pbar</span> <span class="o">=</span> <span class="n">create_progress_bar</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">tqdm_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Entropy&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">pbar</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nd">@toma</span><span class="o">.</span><span class="n">execute</span><span class="o">.</span><span class="n">chunked</span><span class="p">(</span><span class="n">probs_N_K_C</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="n">probs_n_K_C</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mean_probs_n_C</span> <span class="o">=</span> <span class="n">probs_n_K_C</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">nats_n_C</span> <span class="o">=</span> <span class="n">mean_probs_n_C</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mean_probs_n_C</span><span class="p">)</span>
        <span class="n">nats_n_C</span><span class="p">[</span><span class="n">mean_probs_n_C</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">entropies_N</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">nats_n_C</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

    <span class="n">pbar</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">entropies_N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;FastMNIST (train)&quot;</span>
        <span class="p">)</span>
<span class="n">train_predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;./data/mnist_train_predictions.pt&quot;</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="c1"># train_dataset = train_dataset.override_targets(targets=train_predictions.argmax(dim=1))</span>

<span class="n">train_entropies</span> <span class="o">=</span> <span class="n">compute_entropy_from_probs</span><span class="p">(</span><span class="n">train_predictions</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>

<span class="n">allowed_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">train_entropies</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">allowed_train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">subset</span><span class="p">(</span><span class="n">allowed_indices</span><span class="p">)</span>
<span class="n">fixed_initial_set_indices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">allowed_train_dataset</span><span class="o">.</span><span class="n">get_base_dataset_index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">training_set_90</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">fixed_initial_set_indices</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-25bd2e5307fd&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> train_dataset = NamedDataset(
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg">             </span>FastMNIST<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;data&#34;</span><span class="ansi-blue-fg">,</span> train<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> download<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;FastMNIST (train)&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>         )
<span class="ansi-green-intense-fg ansi-bold">      4</span> train_predictions <span class="ansi-blue-fg">=</span> torch<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;./data/mnist_train_predictions.pt&#34;</span><span class="ansi-blue-fg">,</span> map_location<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> <span class="ansi-red-fg"># train_dataset = train_dataset.override_targets(targets=train_predictions.argmax(dim=1))</span>

<span class="ansi-red-fg">NameError</span>: name &#39;device&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Experiment</span><span class="p">:</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1337</span>
    <span class="n">training_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">35</span>
    <span class="n">num_pool_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_validation_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_training_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_patience_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">max_training_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">training_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span>
    <span class="n">validation_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">initial_training_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">min_samples_per_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>    
    <span class="n">model_optimizer_factory</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">ModelOptimizerFactory</span><span class="p">]</span> <span class="o">=</span> <span class="n">MnistOptimizerFactory</span>
    
    <span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">):</span>
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;FastMNIST (train)&quot;</span>
        <span class="p">)</span>
        <span class="c1">#train_predictions = torch.load(&quot;./data/mnist_train_predictions.pt&quot;, map_location=self.device)</span>
        <span class="c1"># train_dataset = train_dataset.override_targets(targets=train_predictions.argmax(dim=1))</span>

<span class="c1">#         train_entropies = compute_entropy_from_probs(train_predictions[:, None, :])</span>

<span class="c1">#         allowed_indices = torch.nonzero(train_entropies &lt; 0.01, as_tuple=True)[0].numpy()</span>
<span class="c1">#         allowed_train_dataset = train_dataset.subset(allowed_indices)</span>
<span class="c1">#         fixed_initial_set_indices = [</span>
<span class="c1">#             allowed_train_dataset.get_base_dataset_index(i).index for i in training_set_90[:20]</span>
<span class="c1">#         ]</span>

        <span class="n">active_learning_data</span> <span class="o">=</span> <span class="n">ActiveLearningData</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>

        <span class="n">active_learning_data</span><span class="o">.</span><span class="n">acquire_base_indices</span><span class="p">(</span><span class="n">training_set_90</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">training_set_size</span><span class="p">])</span>

        <span class="n">active_learning_data_validation_set</span> <span class="o">=</span> <span class="n">ActiveLearningData</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
        <span class="n">active_learning_data_validation_set</span><span class="o">.</span><span class="n">acquire_base_indices</span><span class="p">(</span><span class="n">training_set_90</span><span class="p">)</span>

        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">active_learning_data_validation_set</span><span class="o">.</span><span class="n">extract_dataset_from_pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validation_set_size</span><span class="p">)</span>
        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (validation, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">)</span>

        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (test, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">active_learning_data</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">training_set_90</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">):</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

        <span class="c1"># Active Learning setup</span>
        <span class="n">active_learning_data</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">initial_training_set_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">()</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;initial_training_set_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_training_set_indices</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;dataset_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">training</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">base_dataset</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">))</span>

        <span class="c1"># initial_training_set_indices = active_learning_data.get_random_pool_indices(self.initial_set_size)</span>
        <span class="c1"># initial_training_set_indices = get_balanced_sample_indices(</span>
        <span class="c1">#     active_learning_data.pool_dataset, 10, self.initial_set_size // 10</span>
        <span class="c1"># )</span>

        <span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">RandomFixedLengthSampler</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_per_epoch</span><span class="p">),</span>
            <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">pool_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="n">validation_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">active_learning_steps</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span>

        <span class="n">training_set_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training set size </span><span class="si">{</span><span class="n">training_set_size</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

        <span class="c1"># iteration_log = dict(training={}, pool_training={}, evaluation_metrics=None, acquisition=None)</span>
        <span class="n">active_learning_steps</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
        <span class="n">iteration_log</span> <span class="o">=</span> <span class="n">active_learning_steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">model_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer_factory</span><span class="p">()</span><span class="o">.</span><span class="n">create_model_optimizer</span><span class="p">()</span>

        <span class="n">double_snapshots</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">training_set_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">train</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">optimizer</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
                <span class="n">training_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_training_samples</span><span class="p">,</span>
                <span class="n">validation_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_validation_samples</span><span class="p">,</span>
                <span class="n">train_loader</span><span class="o">=</span><span class="n">train_loader</span><span class="p">,</span>
                <span class="n">validation_loader</span><span class="o">=</span><span class="n">validation_loader</span><span class="p">,</span>
                <span class="n">patience</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_patience_epochs</span><span class="p">,</span>
                <span class="n">max_epochs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_training_epochs</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                <span class="n">training_log</span><span class="o">=</span><span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">],</span>
                <span class="n">wandb_key_path</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">evaluation_metrics</span> <span class="o">=</span> <span class="n">evaluate_old</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
            <span class="n">num_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_validation_samples</span><span class="p">,</span>
            <span class="n">loader</span><span class="o">=</span><span class="n">test_loader</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;evaluation_metrics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluation_metrics</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perf after training </span><span class="si">{</span><span class="n">evaluation_metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
    <span class="n">training_set_size</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">num_pool_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dataclasses</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">model35</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">experiment</span><span class="p">,</span> <span class="n">training_set_size</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span>
<span class="n">logs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set size 35:
Epoch metrics: {&#39;accuracy&#39;: 0.447265625, &#39;crossentropy&#39;: 1.9910835027694702}
Epoch metrics: {&#39;accuracy&#39;: 0.6103515625, &#39;crossentropy&#39;: 1.2986295223236084}
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 0.9267570972442627}
Epoch metrics: {&#39;accuracy&#39;: 0.7265625, &#39;crossentropy&#39;: 0.876323401927948}
Epoch metrics: {&#39;accuracy&#39;: 0.7216796875, &#39;crossentropy&#39;: 0.8672223687171936}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.75390625, &#39;crossentropy&#39;: 0.7793159484863281}
Epoch metrics: {&#39;accuracy&#39;: 0.7646484375, &#39;crossentropy&#39;: 0.7471761107444763}
Epoch metrics: {&#39;accuracy&#39;: 0.734375, &#39;crossentropy&#39;: 0.8230096697807312}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7412109375, &#39;crossentropy&#39;: 0.8189630508422852}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7705078125, &#39;crossentropy&#39;: 0.7629503607749939}
Epoch metrics: {&#39;accuracy&#39;: 0.755859375, &#39;crossentropy&#39;: 0.7886953949928284}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7265625, &#39;crossentropy&#39;: 0.8610079288482666}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.78125, &#39;crossentropy&#39;: 0.7178570628166199}
Epoch metrics: {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7405175566673279}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.734375, &#39;crossentropy&#39;: 0.8230465650558472}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7578125, &#39;crossentropy&#39;: 0.7819514870643616}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.763671875, &#39;crossentropy&#39;: 0.770061194896698}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.74609375, &#39;crossentropy&#39;: 0.8162933588027954}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7470703125, &#39;crossentropy&#39;: 0.7772052884101868}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 0.7139804363250732}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.759765625, &#39;crossentropy&#39;: 0.7514800429344177}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7314453125, &#39;crossentropy&#39;: 0.8474382162094116}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7333984375, &#39;crossentropy&#39;: 0.815249502658844}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.736328125, &#39;crossentropy&#39;: 0.8011304140090942}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7529296875, &#39;crossentropy&#39;: 0.7968822121620178}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.755859375, &#39;crossentropy&#39;: 0.7825013995170593}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7197265625, &#39;crossentropy&#39;: 0.9462878704071045}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.75390625, &#39;crossentropy&#39;: 0.7403719425201416}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.78515625, &#39;crossentropy&#39;: 0.6685580015182495}
Epoch metrics: {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.7465391159057617}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.6869835257530212}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.741175651550293}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7724609375, &#39;crossentropy&#39;: 0.7456239461898804}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.75748610496521}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7607421875, &#39;crossentropy&#39;: 0.7913416028022766}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7609843015670776}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7548828125, &#39;crossentropy&#39;: 0.7689855694770813}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 0.7237609028816223}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7509765625, &#39;crossentropy&#39;: 0.7683805227279663}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7607421875, &#39;crossentropy&#39;: 0.7895317077636719}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7206978797912598}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 0.7057973146438599}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.771484375, &#39;crossentropy&#39;: 0.7348682284355164}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.775390625, &#39;crossentropy&#39;: 0.7193517088890076}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.779296875, &#39;crossentropy&#39;: 0.7332012057304382}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7919921875, &#39;crossentropy&#39;: 0.6962171196937561}
Epoch metrics: {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7840267419815063}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7626953125, &#39;crossentropy&#39;: 0.7877050042152405}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7783203125, &#39;crossentropy&#39;: 0.8014097213745117}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.7389960289001465}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7998046875, &#39;crossentropy&#39;: 0.6840416193008423}
Epoch metrics: {&#39;accuracy&#39;: 0.7861328125, &#39;crossentropy&#39;: 0.7265982627868652}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.7080038785934448}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.791015625, &#39;crossentropy&#39;: 0.6998908519744873}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7734375, &#39;crossentropy&#39;: 0.7350669503211975}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.771484375, &#39;crossentropy&#39;: 0.7618177533149719}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.78515625, &#39;crossentropy&#39;: 0.7057140469551086}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.783203125, &#39;crossentropy&#39;: 0.6905902028083801}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.6884310245513916}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7890625, &#39;crossentropy&#39;: 0.7025330066680908}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7763671875, &#39;crossentropy&#39;: 0.7102656960487366}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.7015531659126282}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7861328125, &#39;crossentropy&#39;: 0.719842791557312}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7822265625, &#39;crossentropy&#39;: 0.7448790669441223}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7626953125, &#39;crossentropy&#39;: 0.7195961475372314}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 0.7432304620742798}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.7493838667869568}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7578125, &#39;crossentropy&#39;: 0.7286192178726196}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.787109375, &#39;crossentropy&#39;: 0.702856719493866}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 0.7778734564781189}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.802734375, &#39;crossentropy&#39;: 0.7017546892166138}
Epoch metrics: {&#39;accuracy&#39;: 0.80078125, &#39;crossentropy&#39;: 0.7095827460289001}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.801038384437561}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.6882880330085754}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7783203125, &#39;crossentropy&#39;: 0.7073860168457031}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.7603689432144165}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7568359375, &#39;crossentropy&#39;: 0.7915321588516235}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7685546875, &#39;crossentropy&#39;: 0.7087028622627258}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.77734375, &#39;crossentropy&#39;: 0.7793172597885132}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.755859375, &#39;crossentropy&#39;: 0.869433581829071}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.763671875, &#39;crossentropy&#39;: 0.7413349747657776}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.783203125, &#39;crossentropy&#39;: 0.6729942560195923}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7587890625, &#39;crossentropy&#39;: 0.7442118525505066}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.779296875, &#39;crossentropy&#39;: 0.6984896659851074}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7763671875, &#39;crossentropy&#39;: 0.7153807282447815}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 0.7500765919685364}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7607421875, &#39;crossentropy&#39;: 0.8381080031394958}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.765625, &#39;crossentropy&#39;: 0.7664159536361694}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.7773207426071167}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7841796875, &#39;crossentropy&#39;: 0.7425780892372131}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7822265625, &#39;crossentropy&#39;: 0.6833183765411377}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.802734375)
RestoringEarlyStopping: Restoring optimizer.
{&#39;/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f86fe369a00&gt;, &#39;/best_epoch&#39;: 70, &#39;/best_val_accuracy&#39;: 0.802734375, &#39;/best_val_crossentropy&#39;: 0.7017546892166138}
Perf after training {&#39;accuracy&#39;: 0.784, &#39;crossentropy&#39;: 0.702096240234375}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;initial_training_set_indices&#39;: [51348,
  49110,
  8222,
  28130,
  13484,
  47685,
  3938,
  59930,
  49196,
  19427,
  4601,
  49922,
  45635,
  35684,
  3579,
  7621,
  8465,
  33959,
  27521,
  27015],
 &#39;dataset_info&#39;: {&#39;training&#39;: &#34;&#39;FastMNIST (train)&#39;&#34;,
  &#39;test&#39;: &#34;&#39;FastMNIST (test, 10000 samples)&#39;&#34;},
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.447265625,
      &#39;crossentropy&#39;: 1.9910835027694702},
     {&#39;accuracy&#39;: 0.6103515625, &#39;crossentropy&#39;: 1.2986295223236084},
     {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 0.9267570972442627},
     {&#39;accuracy&#39;: 0.7265625, &#39;crossentropy&#39;: 0.876323401927948},
     {&#39;accuracy&#39;: 0.7216796875, &#39;crossentropy&#39;: 0.8672223687171936},
     {&#39;accuracy&#39;: 0.75390625, &#39;crossentropy&#39;: 0.7793159484863281},
     {&#39;accuracy&#39;: 0.7646484375, &#39;crossentropy&#39;: 0.7471761107444763},
     {&#39;accuracy&#39;: 0.734375, &#39;crossentropy&#39;: 0.8230096697807312},
     {&#39;accuracy&#39;: 0.7412109375, &#39;crossentropy&#39;: 0.8189630508422852},
     {&#39;accuracy&#39;: 0.7705078125, &#39;crossentropy&#39;: 0.7629503607749939},
     {&#39;accuracy&#39;: 0.755859375, &#39;crossentropy&#39;: 0.7886953949928284},
     {&#39;accuracy&#39;: 0.7265625, &#39;crossentropy&#39;: 0.8610079288482666},
     {&#39;accuracy&#39;: 0.78125, &#39;crossentropy&#39;: 0.7178570628166199},
     {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7405175566673279},
     {&#39;accuracy&#39;: 0.734375, &#39;crossentropy&#39;: 0.8230465650558472},
     {&#39;accuracy&#39;: 0.7578125, &#39;crossentropy&#39;: 0.7819514870643616},
     {&#39;accuracy&#39;: 0.763671875, &#39;crossentropy&#39;: 0.770061194896698},
     {&#39;accuracy&#39;: 0.74609375, &#39;crossentropy&#39;: 0.8162933588027954},
     {&#39;accuracy&#39;: 0.7470703125, &#39;crossentropy&#39;: 0.7772052884101868},
     {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 0.7139804363250732},
     {&#39;accuracy&#39;: 0.759765625, &#39;crossentropy&#39;: 0.7514800429344177},
     {&#39;accuracy&#39;: 0.7314453125, &#39;crossentropy&#39;: 0.8474382162094116},
     {&#39;accuracy&#39;: 0.7333984375, &#39;crossentropy&#39;: 0.815249502658844},
     {&#39;accuracy&#39;: 0.736328125, &#39;crossentropy&#39;: 0.8011304140090942},
     {&#39;accuracy&#39;: 0.7529296875, &#39;crossentropy&#39;: 0.7968822121620178},
     {&#39;accuracy&#39;: 0.755859375, &#39;crossentropy&#39;: 0.7825013995170593},
     {&#39;accuracy&#39;: 0.7197265625, &#39;crossentropy&#39;: 0.9462878704071045},
     {&#39;accuracy&#39;: 0.75390625, &#39;crossentropy&#39;: 0.7403719425201416},
     {&#39;accuracy&#39;: 0.78515625, &#39;crossentropy&#39;: 0.6685580015182495},
     {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.7465391159057617},
     {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.6869835257530212},
     {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.741175651550293},
     {&#39;accuracy&#39;: 0.7724609375, &#39;crossentropy&#39;: 0.7456239461898804},
     {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.75748610496521},
     {&#39;accuracy&#39;: 0.7607421875, &#39;crossentropy&#39;: 0.7913416028022766},
     {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7609843015670776},
     {&#39;accuracy&#39;: 0.7548828125, &#39;crossentropy&#39;: 0.7689855694770813},
     {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 0.7237609028816223},
     {&#39;accuracy&#39;: 0.7509765625, &#39;crossentropy&#39;: 0.7683805227279663},
     {&#39;accuracy&#39;: 0.7607421875, &#39;crossentropy&#39;: 0.7895317077636719},
     {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7206978797912598},
     {&#39;accuracy&#39;: 0.76953125, &#39;crossentropy&#39;: 0.7057973146438599},
     {&#39;accuracy&#39;: 0.771484375, &#39;crossentropy&#39;: 0.7348682284355164},
     {&#39;accuracy&#39;: 0.775390625, &#39;crossentropy&#39;: 0.7193517088890076},
     {&#39;accuracy&#39;: 0.779296875, &#39;crossentropy&#39;: 0.7332012057304382},
     {&#39;accuracy&#39;: 0.7919921875, &#39;crossentropy&#39;: 0.6962171196937561},
     {&#39;accuracy&#39;: 0.767578125, &#39;crossentropy&#39;: 0.7840267419815063},
     {&#39;accuracy&#39;: 0.7626953125, &#39;crossentropy&#39;: 0.7877050042152405},
     {&#39;accuracy&#39;: 0.7783203125, &#39;crossentropy&#39;: 0.8014097213745117},
     {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.7389960289001465},
     {&#39;accuracy&#39;: 0.7998046875, &#39;crossentropy&#39;: 0.6840416193008423},
     {&#39;accuracy&#39;: 0.7861328125, &#39;crossentropy&#39;: 0.7265982627868652},
     {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.7080038785934448},
     {&#39;accuracy&#39;: 0.791015625, &#39;crossentropy&#39;: 0.6998908519744873},
     {&#39;accuracy&#39;: 0.7734375, &#39;crossentropy&#39;: 0.7350669503211975},
     {&#39;accuracy&#39;: 0.771484375, &#39;crossentropy&#39;: 0.7618177533149719},
     {&#39;accuracy&#39;: 0.78515625, &#39;crossentropy&#39;: 0.7057140469551086},
     {&#39;accuracy&#39;: 0.783203125, &#39;crossentropy&#39;: 0.6905902028083801},
     {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.6884310245513916},
     {&#39;accuracy&#39;: 0.7890625, &#39;crossentropy&#39;: 0.7025330066680908},
     {&#39;accuracy&#39;: 0.7763671875, &#39;crossentropy&#39;: 0.7102656960487366},
     {&#39;accuracy&#39;: 0.7880859375, &#39;crossentropy&#39;: 0.7015531659126282},
     {&#39;accuracy&#39;: 0.7861328125, &#39;crossentropy&#39;: 0.719842791557312},
     {&#39;accuracy&#39;: 0.7822265625, &#39;crossentropy&#39;: 0.7448790669441223},
     {&#39;accuracy&#39;: 0.7626953125, &#39;crossentropy&#39;: 0.7195961475372314},
     {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 0.7432304620742798},
     {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.7493838667869568},
     {&#39;accuracy&#39;: 0.7578125, &#39;crossentropy&#39;: 0.7286192178726196},
     {&#39;accuracy&#39;: 0.787109375, &#39;crossentropy&#39;: 0.702856719493866},
     {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 0.7778734564781189},
     {&#39;accuracy&#39;: 0.802734375, &#39;crossentropy&#39;: 0.7017546892166138},
     {&#39;accuracy&#39;: 0.80078125, &#39;crossentropy&#39;: 0.7095827460289001},
     {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.801038384437561},
     {&#39;accuracy&#39;: 0.7802734375, &#39;crossentropy&#39;: 0.6882880330085754},
     {&#39;accuracy&#39;: 0.7783203125, &#39;crossentropy&#39;: 0.7073860168457031},
     {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.7603689432144165},
     {&#39;accuracy&#39;: 0.7568359375, &#39;crossentropy&#39;: 0.7915321588516235},
     {&#39;accuracy&#39;: 0.7685546875, &#39;crossentropy&#39;: 0.7087028622627258},
     {&#39;accuracy&#39;: 0.77734375, &#39;crossentropy&#39;: 0.7793172597885132},
     {&#39;accuracy&#39;: 0.755859375, &#39;crossentropy&#39;: 0.869433581829071},
     {&#39;accuracy&#39;: 0.763671875, &#39;crossentropy&#39;: 0.7413349747657776},
     {&#39;accuracy&#39;: 0.783203125, &#39;crossentropy&#39;: 0.6729942560195923},
     {&#39;accuracy&#39;: 0.7587890625, &#39;crossentropy&#39;: 0.7442118525505066},
     {&#39;accuracy&#39;: 0.779296875, &#39;crossentropy&#39;: 0.6984896659851074},
     {&#39;accuracy&#39;: 0.7763671875, &#39;crossentropy&#39;: 0.7153807282447815},
     {&#39;accuracy&#39;: 0.7666015625, &#39;crossentropy&#39;: 0.7500765919685364},
     {&#39;accuracy&#39;: 0.7607421875, &#39;crossentropy&#39;: 0.8381080031394958},
     {&#39;accuracy&#39;: 0.765625, &#39;crossentropy&#39;: 0.7664159536361694},
     {&#39;accuracy&#39;: 0.7744140625, &#39;crossentropy&#39;: 0.7773207426071167},
     {&#39;accuracy&#39;: 0.7841796875, &#39;crossentropy&#39;: 0.7425780892372131},
     {&#39;accuracy&#39;: 0.7822265625, &#39;crossentropy&#39;: 0.6833183765411377}],
    &#39;best_epoch&#39;: 70},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.784,
    &#39;crossentropy&#39;: 0.702096240234375}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">logs</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">model25</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">logs</span><span class="p">)</span>
<span class="n">logs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set size 25:
Epoch metrics: {&#39;accuracy&#39;: 0.4140625, &#39;crossentropy&#39;: 1.8599867820739746}
Epoch metrics: {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 1.1999586820602417}
Epoch metrics: {&#39;accuracy&#39;: 0.658203125, &#39;crossentropy&#39;: 1.0684055089950562}
Epoch metrics: {&#39;accuracy&#39;: 0.689453125, &#39;crossentropy&#39;: 1.0234684944152832}
Epoch metrics: {&#39;accuracy&#39;: 0.6748046875, &#39;crossentropy&#39;: 1.0506612062454224}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6806640625, &#39;crossentropy&#39;: 1.1001193523406982}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6533203125, &#39;crossentropy&#39;: 1.1593643426895142}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7001953125, &#39;crossentropy&#39;: 1.0601842403411865}
Epoch metrics: {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 1.0323179960250854}
Epoch metrics: {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 1.060726284980774}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 1.1442513465881348}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.68359375, &#39;crossentropy&#39;: 1.1403635740280151}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6650390625, &#39;crossentropy&#39;: 1.1784532070159912}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6669921875, &#39;crossentropy&#39;: 1.170360803604126}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6689453125, &#39;crossentropy&#39;: 1.1761560440063477}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 1.1873996257781982}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.66796875, &#39;crossentropy&#39;: 1.2358555793762207}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 1.2699073553085327}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.2347625494003296}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.671875, &#39;crossentropy&#39;: 1.2281476259231567}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.2898082733154297}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.662109375, &#39;crossentropy&#39;: 1.1816155910491943}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.67578125, &#39;crossentropy&#39;: 1.192600965499878}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6748046875, &#39;crossentropy&#39;: 1.179445743560791}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6875, &#39;crossentropy&#39;: 1.1811089515686035}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 1.1777112483978271}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.2586450576782227}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.204067587852478}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 1.2897167205810547}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.7021484375)
RestoringEarlyStopping: Restoring optimizer.
{&#39;/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f86fe1eda90&gt;, &#39;/best_epoch&#39;: 8, &#39;/best_val_accuracy&#39;: 0.7021484375, &#39;/best_val_crossentropy&#39;: 1.0323179960250854}
Perf after training {&#39;accuracy&#39;: 0.7136, &#39;crossentropy&#39;: 0.948865625}
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;initial_training_set_indices&#39;: [51348,
  49110,
  8222,
  28130,
  13484,
  47685,
  3938,
  59930,
  49196,
  19427,
  4601,
  49922,
  45635,
  35684,
  3579,
  7621,
  8465,
  33959,
  27521,
  27015],
 &#39;dataset_info&#39;: {&#39;training&#39;: &#34;&#39;FastMNIST (train)&#39;&#34;,
  &#39;test&#39;: &#34;&#39;FastMNIST (test, 10000 samples)&#39;&#34;},
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.4140625,
      &#39;crossentropy&#39;: 1.8599867820739746},
     {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 1.1999586820602417},
     {&#39;accuracy&#39;: 0.658203125, &#39;crossentropy&#39;: 1.0684055089950562},
     {&#39;accuracy&#39;: 0.689453125, &#39;crossentropy&#39;: 1.0234684944152832},
     {&#39;accuracy&#39;: 0.6748046875, &#39;crossentropy&#39;: 1.0506612062454224},
     {&#39;accuracy&#39;: 0.6806640625, &#39;crossentropy&#39;: 1.1001193523406982},
     {&#39;accuracy&#39;: 0.6533203125, &#39;crossentropy&#39;: 1.1593643426895142},
     {&#39;accuracy&#39;: 0.7001953125, &#39;crossentropy&#39;: 1.0601842403411865},
     {&#39;accuracy&#39;: 0.7021484375, &#39;crossentropy&#39;: 1.0323179960250854},
     {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 1.060726284980774},
     {&#39;accuracy&#39;: 0.6904296875, &#39;crossentropy&#39;: 1.1442513465881348},
     {&#39;accuracy&#39;: 0.68359375, &#39;crossentropy&#39;: 1.1403635740280151},
     {&#39;accuracy&#39;: 0.6650390625, &#39;crossentropy&#39;: 1.1784532070159912},
     {&#39;accuracy&#39;: 0.6669921875, &#39;crossentropy&#39;: 1.170360803604126},
     {&#39;accuracy&#39;: 0.6689453125, &#39;crossentropy&#39;: 1.1761560440063477},
     {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 1.1873996257781982},
     {&#39;accuracy&#39;: 0.66796875, &#39;crossentropy&#39;: 1.2358555793762207},
     {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 1.2699073553085327},
     {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.2347625494003296},
     {&#39;accuracy&#39;: 0.671875, &#39;crossentropy&#39;: 1.2281476259231567},
     {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.2898082733154297},
     {&#39;accuracy&#39;: 0.662109375, &#39;crossentropy&#39;: 1.1816155910491943},
     {&#39;accuracy&#39;: 0.67578125, &#39;crossentropy&#39;: 1.192600965499878},
     {&#39;accuracy&#39;: 0.6748046875, &#39;crossentropy&#39;: 1.179445743560791},
     {&#39;accuracy&#39;: 0.6875, &#39;crossentropy&#39;: 1.1811089515686035},
     {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 1.1777112483978271},
     {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.2586450576782227},
     {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.204067587852478},
     {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 1.2897167205810547}],
    &#39;best_epoch&#39;: 8},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.7136, &#39;crossentropy&#39;: 0.948865625}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span>
<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;FastMNIST (train)&quot;</span><span class="p">)</span>

<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (test, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N_M_C</span><span class="p">,</span> <span class="n">labels_N</span> <span class="o">=</span> <span class="n">online_bayesian_inference</span><span class="o">.</span><span class="n">get_obi_predictions_labels</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model25</span><span class="p">,</span> <span class="n">test_dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">training_indices</span><span class="o">=</span><span class="n">training_set_90</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">eval_batchsize</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_90</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>100</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">((</span><span class="n">predictions_N_M_C</span><span class="p">,</span> <span class="n">labels_N</span><span class="p">),</span> <span class="s2">&quot;mnist_model_10k.pt&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N_M_C</span><span class="p">,</span> <span class="n">labels_N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;mnist_model_10k.pt&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -hl mnist_model_10k.pt
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-rw-rw-r-- 1 blackhc blackhc 3.8G Apr 18 19:47 mnist_model_10k.pt
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">online_bayesian_inference</span><span class="o">.</span><span class="n">eval_obi_simple</span><span class="p">(</span><span class="n">predictions_N_M_C</span><span class="p">,</span> <span class="n">labels_N</span><span class="p">,</span> <span class="n">num_training_indices</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">training_set_90</span><span class="p">),</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples_list</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,),</span> <span class="n">num_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">real_training_set_size</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Online Training Size/Num Samples/Trial: 0/10000/0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">online_bayesian_inference</span><span class="o">.</span><span class="n">eval_obi_simple</span><span class="p">(</span><span class="n">predictions_N_M_C</span><span class="p">,</span> <span class="n">labels_N</span><span class="p">,</span> <span class="n">num_training_indices</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">35</span><span class="p">,</span> <span class="n">num_samples_list</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,),</span> <span class="n">num_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">real_training_set_size</span><span class="o">=</span><span class="mi">35</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Online Training Size/Num Samples/Trial: 35/100/0
OBIPerformance(total_training_set_size=35, real_training_set_size=35, online_training_set_size=35, trial_index=0, num_samples=100, accuracy=0.7770195603370667, crossentropy=0.8479147553443909)
Online Training Size/Num Samples/Trial: 36/100/0
OBIPerformance(total_training_set_size=36, real_training_set_size=35, online_training_set_size=36, trial_index=0, num_samples=100, accuracy=0.7488209009170532, crossentropy=0.8137223720550537)
Online Training Size/Num Samples/Trial: 37/100/0
OBIPerformance(total_training_set_size=37, real_training_set_size=35, online_training_set_size=37, trial_index=0, num_samples=100, accuracy=0.7607626914978027, crossentropy=0.7960487008094788)
Online Training Size/Num Samples/Trial: 38/100/0
OBIPerformance(total_training_set_size=38, real_training_set_size=35, online_training_set_size=38, trial_index=0, num_samples=100, accuracy=0.7780230641365051, crossentropy=0.7317031621932983)
Online Training Size/Num Samples/Trial: 39/100/0
OBIPerformance(total_training_set_size=39, real_training_set_size=35, online_training_set_size=39, trial_index=0, num_samples=100, accuracy=0.7616658210754395, crossentropy=0.8316002488136292)
Online Training Size/Num Samples/Trial: 40/100/0
OBIPerformance(total_training_set_size=40, real_training_set_size=35, online_training_set_size=40, trial_index=0, num_samples=100, accuracy=0.7856497764587402, crossentropy=0.7273717522621155)
Online Training Size/Num Samples/Trial: 41/100/0
OBIPerformance(total_training_set_size=41, real_training_set_size=35, online_training_set_size=41, trial_index=0, num_samples=100, accuracy=0.7850476503372192, crossentropy=0.707657516002655)
Online Training Size/Num Samples/Trial: 42/100/0
OBIPerformance(total_training_set_size=42, real_training_set_size=35, online_training_set_size=42, trial_index=0, num_samples=100, accuracy=0.7799297571182251, crossentropy=0.7383816242218018)
Online Training Size/Num Samples/Trial: 43/100/0
OBIPerformance(total_training_set_size=43, real_training_set_size=35, online_training_set_size=43, trial_index=0, num_samples=100, accuracy=0.7803311347961426, crossentropy=0.7184941172599792)
Online Training Size/Num Samples/Trial: 44/100/0
OBIPerformance(total_training_set_size=44, real_training_set_size=35, online_training_set_size=44, trial_index=0, num_samples=100, accuracy=0.7768188714981079, crossentropy=0.7665050029754639)
Online Training Size/Num Samples/Trial: 45/100/0
OBIPerformance(total_training_set_size=45, real_training_set_size=35, online_training_set_size=45, trial_index=0, num_samples=100, accuracy=0.8093326687812805, crossentropy=0.7240161895751953)
Online Training Size/Num Samples/Trial: 46/100/0
OBIPerformance(total_training_set_size=46, real_training_set_size=35, online_training_set_size=46, trial_index=0, num_samples=100, accuracy=0.7915704846382141, crossentropy=0.710840106010437)
Online Training Size/Num Samples/Trial: 47/100/0
OBIPerformance(total_training_set_size=47, real_training_set_size=35, online_training_set_size=47, trial_index=0, num_samples=100, accuracy=0.7809332609176636, crossentropy=0.7367756962776184)
Online Training Size/Num Samples/Trial: 48/100/0
OBIPerformance(total_training_set_size=48, real_training_set_size=35, online_training_set_size=48, trial_index=0, num_samples=100, accuracy=0.758053183555603, crossentropy=0.7657304406166077)
Online Training Size/Num Samples/Trial: 49/100/0
OBIPerformance(total_training_set_size=49, real_training_set_size=35, online_training_set_size=49, trial_index=0, num_samples=100, accuracy=0.7909684181213379, crossentropy=0.731301486492157)
Online Training Size/Num Samples/Trial: 50/100/0
OBIPerformance(total_training_set_size=50, real_training_set_size=35, online_training_set_size=50, trial_index=0, num_samples=100, accuracy=0.8030105233192444, crossentropy=0.6577921509742737)
Online Training Size/Num Samples/Trial: 51/100/0
OBIPerformance(total_training_set_size=51, real_training_set_size=35, online_training_set_size=51, trial_index=0, num_samples=100, accuracy=0.7762167453765869, crossentropy=0.7812309265136719)
Online Training Size/Num Samples/Trial: 52/100/0
OBIPerformance(total_training_set_size=52, real_training_set_size=35, online_training_set_size=52, trial_index=0, num_samples=100, accuracy=0.787757158279419, crossentropy=0.7557998895645142)
Online Training Size/Num Samples/Trial: 53/100/0
OBIPerformance(total_training_set_size=53, real_training_set_size=35, online_training_set_size=53, trial_index=0, num_samples=100, accuracy=0.79488205909729, crossentropy=0.7514387965202332)
Online Training Size/Num Samples/Trial: 54/100/0
OBIPerformance(total_training_set_size=54, real_training_set_size=35, online_training_set_size=54, trial_index=0, num_samples=100, accuracy=0.786552906036377, crossentropy=0.7609745860099792)
Online Training Size/Num Samples/Trial: 55/100/0
OBIPerformance(total_training_set_size=55, real_training_set_size=35, online_training_set_size=55, trial_index=0, num_samples=100, accuracy=0.7781234383583069, crossentropy=0.7315252423286438)
Online Training Size/Num Samples/Trial: 56/100/0
OBIPerformance(total_training_set_size=56, real_training_set_size=35, online_training_set_size=56, trial_index=0, num_samples=100, accuracy=0.7876567840576172, crossentropy=0.7171401381492615)
Online Training Size/Num Samples/Trial: 57/100/0
OBIPerformance(total_training_set_size=57, real_training_set_size=35, online_training_set_size=57, trial_index=0, num_samples=100, accuracy=0.7728047966957092, crossentropy=0.7655290365219116)
Online Training Size/Num Samples/Trial: 58/100/0
OBIPerformance(total_training_set_size=58, real_training_set_size=35, online_training_set_size=58, trial_index=0, num_samples=100, accuracy=0.7800301313400269, crossentropy=0.7450839281082153)
Online Training Size/Num Samples/Trial: 59/100/0
OBIPerformance(total_training_set_size=59, real_training_set_size=35, online_training_set_size=59, trial_index=0, num_samples=100, accuracy=0.7826392650604248, crossentropy=0.7280413508415222)
Online Training Size/Num Samples/Trial: 60/100/0
OBIPerformance(total_training_set_size=60, real_training_set_size=35, online_training_set_size=60, trial_index=0, num_samples=100, accuracy=0.7823382019996643, crossentropy=0.704192578792572)
Online Training Size/Num Samples/Trial: 61/100/0
OBIPerformance(total_training_set_size=61, real_training_set_size=35, online_training_set_size=61, trial_index=0, num_samples=100, accuracy=0.7790265679359436, crossentropy=0.7586090564727783)
Online Training Size/Num Samples/Trial: 62/100/0
OBIPerformance(total_training_set_size=62, real_training_set_size=35, online_training_set_size=62, trial_index=0, num_samples=100, accuracy=0.7892624139785767, crossentropy=0.7391437292098999)
Online Training Size/Num Samples/Trial: 63/100/0
OBIPerformance(total_training_set_size=63, real_training_set_size=35, online_training_set_size=63, trial_index=0, num_samples=100, accuracy=0.7846462726593018, crossentropy=0.7559781670570374)
Online Training Size/Num Samples/Trial: 64/100/0
OBIPerformance(total_training_set_size=64, real_training_set_size=35, online_training_set_size=64, trial_index=0, num_samples=100, accuracy=0.7941796183586121, crossentropy=0.708406925201416)
Online Training Size/Num Samples/Trial: 65/100/0
OBIPerformance(total_training_set_size=65, real_training_set_size=35, online_training_set_size=65, trial_index=0, num_samples=100, accuracy=0.7760160565376282, crossentropy=0.739191472530365)
Online Training Size/Num Samples/Trial: 66/100/0
OBIPerformance(total_training_set_size=66, real_training_set_size=35, online_training_set_size=66, trial_index=0, num_samples=100, accuracy=0.7800301313400269, crossentropy=0.7429972887039185)
Online Training Size/Num Samples/Trial: 67/100/0
OBIPerformance(total_training_set_size=67, real_training_set_size=35, online_training_set_size=67, trial_index=0, num_samples=100, accuracy=0.7947817444801331, crossentropy=0.6933515071868896)
Online Training Size/Num Samples/Trial: 68/100/0
OBIPerformance(total_training_set_size=68, real_training_set_size=35, online_training_set_size=68, trial_index=0, num_samples=100, accuracy=0.7931761145591736, crossentropy=0.7475882768630981)
Online Training Size/Num Samples/Trial: 69/100/0
OBIPerformance(total_training_set_size=69, real_training_set_size=35, online_training_set_size=69, trial_index=0, num_samples=100, accuracy=0.7765178084373474, crossentropy=0.7455720901489258)
Online Training Size/Num Samples/Trial: 70/100/0
OBIPerformance(total_training_set_size=70, real_training_set_size=35, online_training_set_size=70, trial_index=0, num_samples=100, accuracy=0.7638735771179199, crossentropy=0.8138070106506348)
Online Training Size/Num Samples/Trial: 71/100/0
OBIPerformance(total_training_set_size=71, real_training_set_size=35, online_training_set_size=71, trial_index=0, num_samples=100, accuracy=0.7897641658782959, crossentropy=0.7759979963302612)
Online Training Size/Num Samples/Trial: 72/100/0
OBIPerformance(total_training_set_size=72, real_training_set_size=35, online_training_set_size=72, trial_index=0, num_samples=100, accuracy=0.7899648547172546, crossentropy=0.7359782457351685)
Online Training Size/Num Samples/Trial: 73/100/0
OBIPerformance(total_training_set_size=73, real_training_set_size=35, online_training_set_size=73, trial_index=0, num_samples=100, accuracy=0.7772202491760254, crossentropy=0.7255714535713196)
Online Training Size/Num Samples/Trial: 74/100/0
OBIPerformance(total_training_set_size=74, real_training_set_size=35, online_training_set_size=74, trial_index=0, num_samples=100, accuracy=0.757451057434082, crossentropy=0.7953479290008545)
Online Training Size/Num Samples/Trial: 75/100/0
OBIPerformance(total_training_set_size=75, real_training_set_size=35, online_training_set_size=75, trial_index=0, num_samples=100, accuracy=0.7801304459571838, crossentropy=0.7367581129074097)
Online Training Size/Num Samples/Trial: 76/100/0
OBIPerformance(total_training_set_size=76, real_training_set_size=35, online_training_set_size=76, trial_index=0, num_samples=100, accuracy=0.7903662919998169, crossentropy=0.7410944104194641)
Online Training Size/Num Samples/Trial: 77/100/0
OBIPerformance(total_training_set_size=77, real_training_set_size=35, online_training_set_size=77, trial_index=0, num_samples=100, accuracy=0.7949824333190918, crossentropy=0.6923753619194031)
Online Training Size/Num Samples/Trial: 78/100/0
OBIPerformance(total_training_set_size=78, real_training_set_size=35, online_training_set_size=78, trial_index=0, num_samples=100, accuracy=0.7952834963798523, crossentropy=0.6794764995574951)
Online Training Size/Num Samples/Trial: 79/100/0
OBIPerformance(total_training_set_size=79, real_training_set_size=35, online_training_set_size=79, trial_index=0, num_samples=100, accuracy=0.7897641658782959, crossentropy=0.7070302963256836)
Online Training Size/Num Samples/Trial: 80/100/0
OBIPerformance(total_training_set_size=80, real_training_set_size=35, online_training_set_size=80, trial_index=0, num_samples=100, accuracy=0.8070245981216431, crossentropy=0.6738825440406799)
Online Training Size/Num Samples/Trial: 81/100/0
OBIPerformance(total_training_set_size=81, real_training_set_size=35, online_training_set_size=81, trial_index=0, num_samples=100, accuracy=0.7925739884376526, crossentropy=0.7080333232879639)
Online Training Size/Num Samples/Trial: 82/100/0
OBIPerformance(total_training_set_size=82, real_training_set_size=35, online_training_set_size=82, trial_index=0, num_samples=100, accuracy=0.7829402685165405, crossentropy=0.7770246267318726)
Online Training Size/Num Samples/Trial: 83/100/0
OBIPerformance(total_training_set_size=83, real_training_set_size=35, online_training_set_size=83, trial_index=0, num_samples=100, accuracy=0.7978926301002502, crossentropy=0.6900596022605896)
Online Training Size/Num Samples/Trial: 84/100/0
OBIPerformance(total_training_set_size=84, real_training_set_size=35, online_training_set_size=84, trial_index=0, num_samples=100, accuracy=0.7787255644798279, crossentropy=0.7678052186965942)
Online Training Size/Num Samples/Trial: 85/100/0
OBIPerformance(total_training_set_size=85, real_training_set_size=35, online_training_set_size=85, trial_index=0, num_samples=100, accuracy=0.799397885799408, crossentropy=0.7163575291633606)
Online Training Size/Num Samples/Trial: 86/100/0
OBIPerformance(total_training_set_size=86, real_training_set_size=35, online_training_set_size=86, trial_index=0, num_samples=100, accuracy=0.8004013895988464, crossentropy=0.640066385269165)
Online Training Size/Num Samples/Trial: 87/100/0
OBIPerformance(total_training_set_size=87, real_training_set_size=35, online_training_set_size=87, trial_index=0, num_samples=100, accuracy=0.8020070195198059, crossentropy=0.7565041780471802)
Online Training Size/Num Samples/Trial: 88/100/0
OBIPerformance(total_training_set_size=88, real_training_set_size=35, online_training_set_size=88, trial_index=0, num_samples=100, accuracy=0.8018063306808472, crossentropy=0.6778466105461121)
Online Training Size/Num Samples/Trial: 89/100/0
OBIPerformance(total_training_set_size=89, real_training_set_size=35, online_training_set_size=89, trial_index=0, num_samples=100, accuracy=0.8029102087020874, crossentropy=0.6793418526649475)
Online Training Size/Num Samples/Trial: 90/100/0
OBIPerformance(total_training_set_size=90, real_training_set_size=35, online_training_set_size=90, trial_index=0, num_samples=100, accuracy=0.7652784585952759, crossentropy=0.7427279949188232)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[OBIPerformance(total_training_set_size=35, real_training_set_size=35, online_training_set_size=35, trial_index=0, num_samples=100, accuracy=0.7770195603370667, crossentropy=0.8479147553443909),
 OBIPerformance(total_training_set_size=36, real_training_set_size=35, online_training_set_size=36, trial_index=0, num_samples=100, accuracy=0.7488209009170532, crossentropy=0.8137223720550537),
 OBIPerformance(total_training_set_size=37, real_training_set_size=35, online_training_set_size=37, trial_index=0, num_samples=100, accuracy=0.7607626914978027, crossentropy=0.7960487008094788),
 OBIPerformance(total_training_set_size=38, real_training_set_size=35, online_training_set_size=38, trial_index=0, num_samples=100, accuracy=0.7780230641365051, crossentropy=0.7317031621932983),
 OBIPerformance(total_training_set_size=39, real_training_set_size=35, online_training_set_size=39, trial_index=0, num_samples=100, accuracy=0.7616658210754395, crossentropy=0.8316002488136292),
 OBIPerformance(total_training_set_size=40, real_training_set_size=35, online_training_set_size=40, trial_index=0, num_samples=100, accuracy=0.7856497764587402, crossentropy=0.7273717522621155),
 OBIPerformance(total_training_set_size=41, real_training_set_size=35, online_training_set_size=41, trial_index=0, num_samples=100, accuracy=0.7850476503372192, crossentropy=0.707657516002655),
 OBIPerformance(total_training_set_size=42, real_training_set_size=35, online_training_set_size=42, trial_index=0, num_samples=100, accuracy=0.7799297571182251, crossentropy=0.7383816242218018),
 OBIPerformance(total_training_set_size=43, real_training_set_size=35, online_training_set_size=43, trial_index=0, num_samples=100, accuracy=0.7803311347961426, crossentropy=0.7184941172599792),
 OBIPerformance(total_training_set_size=44, real_training_set_size=35, online_training_set_size=44, trial_index=0, num_samples=100, accuracy=0.7768188714981079, crossentropy=0.7665050029754639),
 OBIPerformance(total_training_set_size=45, real_training_set_size=35, online_training_set_size=45, trial_index=0, num_samples=100, accuracy=0.8093326687812805, crossentropy=0.7240161895751953),
 OBIPerformance(total_training_set_size=46, real_training_set_size=35, online_training_set_size=46, trial_index=0, num_samples=100, accuracy=0.7915704846382141, crossentropy=0.710840106010437),
 OBIPerformance(total_training_set_size=47, real_training_set_size=35, online_training_set_size=47, trial_index=0, num_samples=100, accuracy=0.7809332609176636, crossentropy=0.7367756962776184),
 OBIPerformance(total_training_set_size=48, real_training_set_size=35, online_training_set_size=48, trial_index=0, num_samples=100, accuracy=0.758053183555603, crossentropy=0.7657304406166077),
 OBIPerformance(total_training_set_size=49, real_training_set_size=35, online_training_set_size=49, trial_index=0, num_samples=100, accuracy=0.7909684181213379, crossentropy=0.731301486492157),
 OBIPerformance(total_training_set_size=50, real_training_set_size=35, online_training_set_size=50, trial_index=0, num_samples=100, accuracy=0.8030105233192444, crossentropy=0.6577921509742737),
 OBIPerformance(total_training_set_size=51, real_training_set_size=35, online_training_set_size=51, trial_index=0, num_samples=100, accuracy=0.7762167453765869, crossentropy=0.7812309265136719),
 OBIPerformance(total_training_set_size=52, real_training_set_size=35, online_training_set_size=52, trial_index=0, num_samples=100, accuracy=0.787757158279419, crossentropy=0.7557998895645142),
 OBIPerformance(total_training_set_size=53, real_training_set_size=35, online_training_set_size=53, trial_index=0, num_samples=100, accuracy=0.79488205909729, crossentropy=0.7514387965202332),
 OBIPerformance(total_training_set_size=54, real_training_set_size=35, online_training_set_size=54, trial_index=0, num_samples=100, accuracy=0.786552906036377, crossentropy=0.7609745860099792),
 OBIPerformance(total_training_set_size=55, real_training_set_size=35, online_training_set_size=55, trial_index=0, num_samples=100, accuracy=0.7781234383583069, crossentropy=0.7315252423286438),
 OBIPerformance(total_training_set_size=56, real_training_set_size=35, online_training_set_size=56, trial_index=0, num_samples=100, accuracy=0.7876567840576172, crossentropy=0.7171401381492615),
 OBIPerformance(total_training_set_size=57, real_training_set_size=35, online_training_set_size=57, trial_index=0, num_samples=100, accuracy=0.7728047966957092, crossentropy=0.7655290365219116),
 OBIPerformance(total_training_set_size=58, real_training_set_size=35, online_training_set_size=58, trial_index=0, num_samples=100, accuracy=0.7800301313400269, crossentropy=0.7450839281082153),
 OBIPerformance(total_training_set_size=59, real_training_set_size=35, online_training_set_size=59, trial_index=0, num_samples=100, accuracy=0.7826392650604248, crossentropy=0.7280413508415222),
 OBIPerformance(total_training_set_size=60, real_training_set_size=35, online_training_set_size=60, trial_index=0, num_samples=100, accuracy=0.7823382019996643, crossentropy=0.704192578792572),
 OBIPerformance(total_training_set_size=61, real_training_set_size=35, online_training_set_size=61, trial_index=0, num_samples=100, accuracy=0.7790265679359436, crossentropy=0.7586090564727783),
 OBIPerformance(total_training_set_size=62, real_training_set_size=35, online_training_set_size=62, trial_index=0, num_samples=100, accuracy=0.7892624139785767, crossentropy=0.7391437292098999),
 OBIPerformance(total_training_set_size=63, real_training_set_size=35, online_training_set_size=63, trial_index=0, num_samples=100, accuracy=0.7846462726593018, crossentropy=0.7559781670570374),
 OBIPerformance(total_training_set_size=64, real_training_set_size=35, online_training_set_size=64, trial_index=0, num_samples=100, accuracy=0.7941796183586121, crossentropy=0.708406925201416),
 OBIPerformance(total_training_set_size=65, real_training_set_size=35, online_training_set_size=65, trial_index=0, num_samples=100, accuracy=0.7760160565376282, crossentropy=0.739191472530365),
 OBIPerformance(total_training_set_size=66, real_training_set_size=35, online_training_set_size=66, trial_index=0, num_samples=100, accuracy=0.7800301313400269, crossentropy=0.7429972887039185),
 OBIPerformance(total_training_set_size=67, real_training_set_size=35, online_training_set_size=67, trial_index=0, num_samples=100, accuracy=0.7947817444801331, crossentropy=0.6933515071868896),
 OBIPerformance(total_training_set_size=68, real_training_set_size=35, online_training_set_size=68, trial_index=0, num_samples=100, accuracy=0.7931761145591736, crossentropy=0.7475882768630981),
 OBIPerformance(total_training_set_size=69, real_training_set_size=35, online_training_set_size=69, trial_index=0, num_samples=100, accuracy=0.7765178084373474, crossentropy=0.7455720901489258),
 OBIPerformance(total_training_set_size=70, real_training_set_size=35, online_training_set_size=70, trial_index=0, num_samples=100, accuracy=0.7638735771179199, crossentropy=0.8138070106506348),
 OBIPerformance(total_training_set_size=71, real_training_set_size=35, online_training_set_size=71, trial_index=0, num_samples=100, accuracy=0.7897641658782959, crossentropy=0.7759979963302612),
 OBIPerformance(total_training_set_size=72, real_training_set_size=35, online_training_set_size=72, trial_index=0, num_samples=100, accuracy=0.7899648547172546, crossentropy=0.7359782457351685),
 OBIPerformance(total_training_set_size=73, real_training_set_size=35, online_training_set_size=73, trial_index=0, num_samples=100, accuracy=0.7772202491760254, crossentropy=0.7255714535713196),
 OBIPerformance(total_training_set_size=74, real_training_set_size=35, online_training_set_size=74, trial_index=0, num_samples=100, accuracy=0.757451057434082, crossentropy=0.7953479290008545),
 OBIPerformance(total_training_set_size=75, real_training_set_size=35, online_training_set_size=75, trial_index=0, num_samples=100, accuracy=0.7801304459571838, crossentropy=0.7367581129074097),
 OBIPerformance(total_training_set_size=76, real_training_set_size=35, online_training_set_size=76, trial_index=0, num_samples=100, accuracy=0.7903662919998169, crossentropy=0.7410944104194641),
 OBIPerformance(total_training_set_size=77, real_training_set_size=35, online_training_set_size=77, trial_index=0, num_samples=100, accuracy=0.7949824333190918, crossentropy=0.6923753619194031),
 OBIPerformance(total_training_set_size=78, real_training_set_size=35, online_training_set_size=78, trial_index=0, num_samples=100, accuracy=0.7952834963798523, crossentropy=0.6794764995574951),
 OBIPerformance(total_training_set_size=79, real_training_set_size=35, online_training_set_size=79, trial_index=0, num_samples=100, accuracy=0.7897641658782959, crossentropy=0.7070302963256836),
 OBIPerformance(total_training_set_size=80, real_training_set_size=35, online_training_set_size=80, trial_index=0, num_samples=100, accuracy=0.8070245981216431, crossentropy=0.6738825440406799),
 OBIPerformance(total_training_set_size=81, real_training_set_size=35, online_training_set_size=81, trial_index=0, num_samples=100, accuracy=0.7925739884376526, crossentropy=0.7080333232879639),
 OBIPerformance(total_training_set_size=82, real_training_set_size=35, online_training_set_size=82, trial_index=0, num_samples=100, accuracy=0.7829402685165405, crossentropy=0.7770246267318726),
 OBIPerformance(total_training_set_size=83, real_training_set_size=35, online_training_set_size=83, trial_index=0, num_samples=100, accuracy=0.7978926301002502, crossentropy=0.6900596022605896),
 OBIPerformance(total_training_set_size=84, real_training_set_size=35, online_training_set_size=84, trial_index=0, num_samples=100, accuracy=0.7787255644798279, crossentropy=0.7678052186965942),
 OBIPerformance(total_training_set_size=85, real_training_set_size=35, online_training_set_size=85, trial_index=0, num_samples=100, accuracy=0.799397885799408, crossentropy=0.7163575291633606),
 OBIPerformance(total_training_set_size=86, real_training_set_size=35, online_training_set_size=86, trial_index=0, num_samples=100, accuracy=0.8004013895988464, crossentropy=0.640066385269165),
 OBIPerformance(total_training_set_size=87, real_training_set_size=35, online_training_set_size=87, trial_index=0, num_samples=100, accuracy=0.8020070195198059, crossentropy=0.7565041780471802),
 OBIPerformance(total_training_set_size=88, real_training_set_size=35, online_training_set_size=88, trial_index=0, num_samples=100, accuracy=0.8018063306808472, crossentropy=0.6778466105461121),
 OBIPerformance(total_training_set_size=89, real_training_set_size=35, online_training_set_size=89, trial_index=0, num_samples=100, accuracy=0.8029102087020874, crossentropy=0.6793418526649475),
 OBIPerformance(total_training_set_size=90, real_training_set_size=35, online_training_set_size=90, trial_index=0, num_samples=100, accuracy=0.7652784585952759, crossentropy=0.7427279949188232)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">online_bayesian_inference</span><span class="o">.</span><span class="n">evaluate_online_bayesian_inference</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span>
    <span class="n">real_training_set_size</span><span class="o">=</span><span class="mi">69</span><span class="p">,</span>
    <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
    <span class="n">test_dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span>
    <span class="n">additional_training_indices</span><span class="o">=</span><span class="n">training_set_90</span><span class="p">[</span><span class="mi">69</span><span class="p">:</span><span class="mi">72</span><span class="p">],</span>
    <span class="n">num_samples_list</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="n">num_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">up_factor</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">eval_batchsize</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Online Training Size/Num Samples/Trial: 0/10/0
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=0, num_samples=10, accuracy=0.9053000211715698, crossentropy=0.36478863752452756)
Online Training Size/Num Samples/Trial: 0/10/1
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=1, num_samples=10, accuracy=0.8996999859809875, crossentropy=0.36229836322350656)
Online Training Size/Num Samples/Trial: 0/10/2
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=2, num_samples=10, accuracy=0.8970999717712402, crossentropy=0.38442623740958404)
Online Training Size/Num Samples/Trial: 0/10/3
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=3, num_samples=10, accuracy=0.9082000255584717, crossentropy=0.36399307377589557)
Online Training Size/Num Samples/Trial: 0/10/4
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=4, num_samples=10, accuracy=0.8938999772071838, crossentropy=0.3908146566503921)
Online Training Size/Num Samples/Trial: 0/10/5
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=5, num_samples=10, accuracy=0.8910999894142151, crossentropy=0.4314833914073963)
Online Training Size/Num Samples/Trial: 0/10/6
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=6, num_samples=10, accuracy=0.8842999935150146, crossentropy=0.42853751638220017)
Online Training Size/Num Samples/Trial: 0/10/7
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=7, num_samples=10, accuracy=0.8883000016212463, crossentropy=0.4136911141287668)
Online Training Size/Num Samples/Trial: 0/10/8
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=8, num_samples=10, accuracy=0.8888000249862671, crossentropy=0.3776440472437381)
Online Training Size/Num Samples/Trial: 0/10/9
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=9, num_samples=10, accuracy=0.9035999774932861, crossentropy=0.3980903666231778)
Online Training Size/Num Samples/Trial: 0/100/0
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=0, num_samples=100, accuracy=0.9118000268936157, crossentropy=0.35984886000282656)
Online Training Size/Num Samples/Trial: 0/100/1
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=1, num_samples=100, accuracy=0.9089000225067139, crossentropy=0.3705087606296952)
Online Training Size/Num Samples/Trial: 0/100/2
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=2, num_samples=100, accuracy=0.9106000065803528, crossentropy=0.3725522936325272)
Online Training Size/Num Samples/Trial: 0/100/3
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=3, num_samples=100, accuracy=0.9110999703407288, crossentropy=0.3716479269684275)
Online Training Size/Num Samples/Trial: 0/100/4
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=4, num_samples=100, accuracy=0.9053000211715698, crossentropy=0.37490209982884704)
Online Training Size/Num Samples/Trial: 0/100/5
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=5, num_samples=100, accuracy=0.9099000096321106, crossentropy=0.36786316889518833)
Online Training Size/Num Samples/Trial: 0/100/6
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=6, num_samples=100, accuracy=0.9122999906539917, crossentropy=0.36561871702215887)
Online Training Size/Num Samples/Trial: 0/100/7
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=7, num_samples=100, accuracy=0.9108999967575073, crossentropy=0.3644811486630545)
Online Training Size/Num Samples/Trial: 0/100/8
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=8, num_samples=100, accuracy=0.90829998254776, crossentropy=0.36808180929790824)
Online Training Size/Num Samples/Trial: 0/100/9
OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=9, num_samples=100, accuracy=0.9096999764442444, crossentropy=0.3678230134242324)
Online Training Size/Num Samples/Trial: 1/10/0
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=0, num_samples=10, accuracy=0.7904000282287598, crossentropy=0.5478878641682172)
Online Training Size/Num Samples/Trial: 1/10/1
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=1, num_samples=10, accuracy=0.8371999859809875, crossentropy=0.4772958154861873)
Online Training Size/Num Samples/Trial: 1/10/2
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=2, num_samples=10, accuracy=0.8209999799728394, crossentropy=0.5138269679412618)
Online Training Size/Num Samples/Trial: 1/10/3
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=3, num_samples=10, accuracy=0.7325000166893005, crossentropy=0.7573227365610191)
Online Training Size/Num Samples/Trial: 1/10/4
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=4, num_samples=10, accuracy=0.652400016784668, crossentropy=0.7087094585680983)
Online Training Size/Num Samples/Trial: 1/10/5
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=5, num_samples=10, accuracy=0.8303999900817871, crossentropy=0.4925802400616678)
Online Training Size/Num Samples/Trial: 1/10/6
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=6, num_samples=10, accuracy=0.8812000155448914, crossentropy=0.3865544362144568)
Online Training Size/Num Samples/Trial: 1/10/7
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=7, num_samples=10, accuracy=0.7789999842643738, crossentropy=0.6010243038633556)
Online Training Size/Num Samples/Trial: 1/10/8
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=8, num_samples=10, accuracy=0.8202999830245972, crossentropy=0.5350575576605358)
Online Training Size/Num Samples/Trial: 1/10/9
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=9, num_samples=10, accuracy=0.8616999983787537, crossentropy=0.4813957902027909)
Online Training Size/Num Samples/Trial: 1/100/0
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=0, num_samples=100, accuracy=0.8640999794006348, crossentropy=0.4276024249410253)
Online Training Size/Num Samples/Trial: 1/100/1
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=1, num_samples=100, accuracy=0.8580999970436096, crossentropy=0.41114853133906964)
Online Training Size/Num Samples/Trial: 1/100/2
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=2, num_samples=100, accuracy=0.8925999999046326, crossentropy=0.38569833822565597)
Online Training Size/Num Samples/Trial: 1/100/3
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=3, num_samples=100, accuracy=0.8697999715805054, crossentropy=0.4143738198808436)
Online Training Size/Num Samples/Trial: 1/100/4
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=4, num_samples=100, accuracy=0.829200029373169, crossentropy=0.4719128246434698)
Online Training Size/Num Samples/Trial: 1/100/5
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=5, num_samples=100, accuracy=0.887499988079071, crossentropy=0.3782739077526661)
Online Training Size/Num Samples/Trial: 1/100/6
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=6, num_samples=100, accuracy=0.854200005531311, crossentropy=0.44162428666594167)
Online Training Size/Num Samples/Trial: 1/100/7
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=7, num_samples=100, accuracy=0.8799999952316284, crossentropy=0.38294158796589234)
Online Training Size/Num Samples/Trial: 1/100/8
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=8, num_samples=100, accuracy=0.8726000189781189, crossentropy=0.39955210256172713)
Online Training Size/Num Samples/Trial: 1/100/9
OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=9, num_samples=100, accuracy=0.8532000184059143, crossentropy=0.41414733387350444)
Online Training Size/Num Samples/Trial: 2/10/0
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=0, num_samples=10, accuracy=0.7466999888420105, crossentropy=0.7180620791080632)
Online Training Size/Num Samples/Trial: 2/10/1
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=1, num_samples=10, accuracy=0.8248999714851379, crossentropy=0.4668208957307903)
Online Training Size/Num Samples/Trial: 2/10/2
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=2, num_samples=10, accuracy=0.7384999990463257, crossentropy=0.7081790430098936)
Online Training Size/Num Samples/Trial: 2/10/3
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=3, num_samples=10, accuracy=0.8219000101089478, crossentropy=0.5017717095991371)
Online Training Size/Num Samples/Trial: 2/10/4
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=4, num_samples=10, accuracy=0.7889999747276306, crossentropy=0.7162158974442849)
Online Training Size/Num Samples/Trial: 2/10/5
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=5, num_samples=10, accuracy=0.7734000086784363, crossentropy=0.7217206572519664)
Online Training Size/Num Samples/Trial: 2/10/6
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=6, num_samples=10, accuracy=0.8009999990463257, crossentropy=0.5720905099586308)
Online Training Size/Num Samples/Trial: 2/10/7
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=7, num_samples=10, accuracy=0.8184000253677368, crossentropy=0.49770110874915946)
Online Training Size/Num Samples/Trial: 2/10/8
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=8, num_samples=10, accuracy=0.8337000012397766, crossentropy=0.5165073682376791)
Online Training Size/Num Samples/Trial: 2/10/9
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=9, num_samples=10, accuracy=0.7013000249862671, crossentropy=1.070837669585442)
Online Training Size/Num Samples/Trial: 2/100/0
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=0, num_samples=100, accuracy=0.863099992275238, crossentropy=0.47769419096863286)
Online Training Size/Num Samples/Trial: 2/100/1
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=1, num_samples=100, accuracy=0.8673999905586243, crossentropy=0.42740240105972827)
Online Training Size/Num Samples/Trial: 2/100/2
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=2, num_samples=100, accuracy=0.8600000143051147, crossentropy=0.4534642354057479)
Online Training Size/Num Samples/Trial: 2/100/3
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=3, num_samples=100, accuracy=0.8288000226020813, crossentropy=0.46345326248679775)
Online Training Size/Num Samples/Trial: 2/100/4
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=4, num_samples=100, accuracy=0.7809000015258789, crossentropy=0.5897158366440284)
Online Training Size/Num Samples/Trial: 2/100/5
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=5, num_samples=100, accuracy=0.8640000224113464, crossentropy=0.45516917489060504)
Online Training Size/Num Samples/Trial: 2/100/6
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=6, num_samples=100, accuracy=0.867900013923645, crossentropy=0.44087181071308623)
Online Training Size/Num Samples/Trial: 2/100/7
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=7, num_samples=100, accuracy=0.8907999992370605, crossentropy=0.3883709308047926)
Online Training Size/Num Samples/Trial: 2/100/8
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=8, num_samples=100, accuracy=0.875, crossentropy=0.4061719222327063)
Online Training Size/Num Samples/Trial: 2/100/9
OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=9, num_samples=100, accuracy=0.8603000044822693, crossentropy=0.4343936621008379)
Online Training Size/Num Samples/Trial: 3/10/0
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=0, num_samples=10, accuracy=0.7247999906539917, crossentropy=0.8670848720399669)
Online Training Size/Num Samples/Trial: 3/10/1
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=1, num_samples=10, accuracy=0.7918000221252441, crossentropy=0.5995849338621014)
Online Training Size/Num Samples/Trial: 3/10/2
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=2, num_samples=10, accuracy=0.7997999787330627, crossentropy=0.6532767671640377)
Online Training Size/Num Samples/Trial: 3/10/3
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=3, num_samples=10, accuracy=0.6029000282287598, crossentropy=1.7496904675888647)
Online Training Size/Num Samples/Trial: 3/10/4
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=4, num_samples=10, accuracy=0.7297000288963318, crossentropy=0.8419253370201006)
Online Training Size/Num Samples/Trial: 3/10/5
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=5, num_samples=10, accuracy=0.8151000142097473, crossentropy=0.5745683954562035)
Online Training Size/Num Samples/Trial: 3/10/6
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=6, num_samples=10, accuracy=0.7706000208854675, crossentropy=0.5909426203558266)
Online Training Size/Num Samples/Trial: 3/10/7
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=7, num_samples=10, accuracy=0.7132999897003174, crossentropy=0.7581075125298933)
Online Training Size/Num Samples/Trial: 3/10/8
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=8, num_samples=10, accuracy=0.6036999821662903, crossentropy=1.4294244397813043)
Online Training Size/Num Samples/Trial: 3/10/9
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=9, num_samples=10, accuracy=0.8004000186920166, crossentropy=0.6743935979734801)
Online Training Size/Num Samples/Trial: 3/100/0
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=0, num_samples=100, accuracy=0.7354999780654907, crossentropy=0.6745917480774888)
Online Training Size/Num Samples/Trial: 3/100/1
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=1, num_samples=100, accuracy=0.7871999740600586, crossentropy=0.5722652857416788)
Online Training Size/Num Samples/Trial: 3/100/2
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=2, num_samples=100, accuracy=0.7416999936103821, crossentropy=0.6001434608703752)
Online Training Size/Num Samples/Trial: 3/100/3
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=3, num_samples=100, accuracy=0.826200008392334, crossentropy=0.5393007495835952)
Online Training Size/Num Samples/Trial: 3/100/4
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=4, num_samples=100, accuracy=0.8147000074386597, crossentropy=0.48882683687420925)
Online Training Size/Num Samples/Trial: 3/100/5
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=5, num_samples=100, accuracy=0.8651999831199646, crossentropy=0.49774643429460047)
Online Training Size/Num Samples/Trial: 3/100/6
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=6, num_samples=100, accuracy=0.7322999835014343, crossentropy=0.5937744542892096)
Online Training Size/Num Samples/Trial: 3/100/7
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=7, num_samples=100, accuracy=0.8144999742507935, crossentropy=0.5194894618545757)
Online Training Size/Num Samples/Trial: 3/100/8
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=8, num_samples=100, accuracy=0.8098000288009644, crossentropy=0.5048562950047071)
Online Training Size/Num Samples/Trial: 3/100/9
OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=9, num_samples=100, accuracy=0.803600013256073, crossentropy=0.523545556921369)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=0, num_samples=10, accuracy=0.9053000211715698, crossentropy=0.36478863752452756),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=1, num_samples=10, accuracy=0.8996999859809875, crossentropy=0.36229836322350656),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=2, num_samples=10, accuracy=0.8970999717712402, crossentropy=0.38442623740958404),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=3, num_samples=10, accuracy=0.9082000255584717, crossentropy=0.36399307377589557),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=4, num_samples=10, accuracy=0.8938999772071838, crossentropy=0.3908146566503921),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=5, num_samples=10, accuracy=0.8910999894142151, crossentropy=0.4314833914073963),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=6, num_samples=10, accuracy=0.8842999935150146, crossentropy=0.42853751638220017),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=7, num_samples=10, accuracy=0.8883000016212463, crossentropy=0.4136911141287668),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=8, num_samples=10, accuracy=0.8888000249862671, crossentropy=0.3776440472437381),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=9, num_samples=10, accuracy=0.9035999774932861, crossentropy=0.3980903666231778),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=0, num_samples=100, accuracy=0.9118000268936157, crossentropy=0.35984886000282656),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=1, num_samples=100, accuracy=0.9089000225067139, crossentropy=0.3705087606296952),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=2, num_samples=100, accuracy=0.9106000065803528, crossentropy=0.3725522936325272),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=3, num_samples=100, accuracy=0.9110999703407288, crossentropy=0.3716479269684275),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=4, num_samples=100, accuracy=0.9053000211715698, crossentropy=0.37490209982884704),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=5, num_samples=100, accuracy=0.9099000096321106, crossentropy=0.36786316889518833),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=6, num_samples=100, accuracy=0.9122999906539917, crossentropy=0.36561871702215887),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=7, num_samples=100, accuracy=0.9108999967575073, crossentropy=0.3644811486630545),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=8, num_samples=100, accuracy=0.90829998254776, crossentropy=0.36808180929790824),
 OBIPerformance(total_training_set_size=69, real_training_set_size=69, online_training_set_size=0, trial_index=9, num_samples=100, accuracy=0.9096999764442444, crossentropy=0.3678230134242324),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=0, num_samples=10, accuracy=0.7904000282287598, crossentropy=0.5478878641682172),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=1, num_samples=10, accuracy=0.8371999859809875, crossentropy=0.4772958154861873),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=2, num_samples=10, accuracy=0.8209999799728394, crossentropy=0.5138269679412618),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=3, num_samples=10, accuracy=0.7325000166893005, crossentropy=0.7573227365610191),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=4, num_samples=10, accuracy=0.652400016784668, crossentropy=0.7087094585680983),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=5, num_samples=10, accuracy=0.8303999900817871, crossentropy=0.4925802400616678),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=6, num_samples=10, accuracy=0.8812000155448914, crossentropy=0.3865544362144568),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=7, num_samples=10, accuracy=0.7789999842643738, crossentropy=0.6010243038633556),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=8, num_samples=10, accuracy=0.8202999830245972, crossentropy=0.5350575576605358),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=9, num_samples=10, accuracy=0.8616999983787537, crossentropy=0.4813957902027909),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=0, num_samples=100, accuracy=0.8640999794006348, crossentropy=0.4276024249410253),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=1, num_samples=100, accuracy=0.8580999970436096, crossentropy=0.41114853133906964),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=2, num_samples=100, accuracy=0.8925999999046326, crossentropy=0.38569833822565597),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=3, num_samples=100, accuracy=0.8697999715805054, crossentropy=0.4143738198808436),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=4, num_samples=100, accuracy=0.829200029373169, crossentropy=0.4719128246434698),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=5, num_samples=100, accuracy=0.887499988079071, crossentropy=0.3782739077526661),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=6, num_samples=100, accuracy=0.854200005531311, crossentropy=0.44162428666594167),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=7, num_samples=100, accuracy=0.8799999952316284, crossentropy=0.38294158796589234),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=8, num_samples=100, accuracy=0.8726000189781189, crossentropy=0.39955210256172713),
 OBIPerformance(total_training_set_size=70, real_training_set_size=69, online_training_set_size=1, trial_index=9, num_samples=100, accuracy=0.8532000184059143, crossentropy=0.41414733387350444),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=0, num_samples=10, accuracy=0.7466999888420105, crossentropy=0.7180620791080632),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=1, num_samples=10, accuracy=0.8248999714851379, crossentropy=0.4668208957307903),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=2, num_samples=10, accuracy=0.7384999990463257, crossentropy=0.7081790430098936),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=3, num_samples=10, accuracy=0.8219000101089478, crossentropy=0.5017717095991371),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=4, num_samples=10, accuracy=0.7889999747276306, crossentropy=0.7162158974442849),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=5, num_samples=10, accuracy=0.7734000086784363, crossentropy=0.7217206572519664),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=6, num_samples=10, accuracy=0.8009999990463257, crossentropy=0.5720905099586308),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=7, num_samples=10, accuracy=0.8184000253677368, crossentropy=0.49770110874915946),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=8, num_samples=10, accuracy=0.8337000012397766, crossentropy=0.5165073682376791),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=9, num_samples=10, accuracy=0.7013000249862671, crossentropy=1.070837669585442),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=0, num_samples=100, accuracy=0.863099992275238, crossentropy=0.47769419096863286),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=1, num_samples=100, accuracy=0.8673999905586243, crossentropy=0.42740240105972827),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=2, num_samples=100, accuracy=0.8600000143051147, crossentropy=0.4534642354057479),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=3, num_samples=100, accuracy=0.8288000226020813, crossentropy=0.46345326248679775),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=4, num_samples=100, accuracy=0.7809000015258789, crossentropy=0.5897158366440284),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=5, num_samples=100, accuracy=0.8640000224113464, crossentropy=0.45516917489060504),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=6, num_samples=100, accuracy=0.867900013923645, crossentropy=0.44087181071308623),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=7, num_samples=100, accuracy=0.8907999992370605, crossentropy=0.3883709308047926),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=8, num_samples=100, accuracy=0.875, crossentropy=0.4061719222327063),
 OBIPerformance(total_training_set_size=71, real_training_set_size=69, online_training_set_size=2, trial_index=9, num_samples=100, accuracy=0.8603000044822693, crossentropy=0.4343936621008379),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=0, num_samples=10, accuracy=0.7247999906539917, crossentropy=0.8670848720399669),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=1, num_samples=10, accuracy=0.7918000221252441, crossentropy=0.5995849338621014),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=2, num_samples=10, accuracy=0.7997999787330627, crossentropy=0.6532767671640377),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=3, num_samples=10, accuracy=0.6029000282287598, crossentropy=1.7496904675888647),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=4, num_samples=10, accuracy=0.7297000288963318, crossentropy=0.8419253370201006),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=5, num_samples=10, accuracy=0.8151000142097473, crossentropy=0.5745683954562035),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=6, num_samples=10, accuracy=0.7706000208854675, crossentropy=0.5909426203558266),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=7, num_samples=10, accuracy=0.7132999897003174, crossentropy=0.7581075125298933),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=8, num_samples=10, accuracy=0.6036999821662903, crossentropy=1.4294244397813043),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=9, num_samples=10, accuracy=0.8004000186920166, crossentropy=0.6743935979734801),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=0, num_samples=100, accuracy=0.7354999780654907, crossentropy=0.6745917480774888),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=1, num_samples=100, accuracy=0.7871999740600586, crossentropy=0.5722652857416788),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=2, num_samples=100, accuracy=0.7416999936103821, crossentropy=0.6001434608703752),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=3, num_samples=100, accuracy=0.826200008392334, crossentropy=0.5393007495835952),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=4, num_samples=100, accuracy=0.8147000074386597, crossentropy=0.48882683687420925),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=5, num_samples=100, accuracy=0.8651999831199646, crossentropy=0.49774643429460047),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=6, num_samples=100, accuracy=0.7322999835014343, crossentropy=0.5937744542892096),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=7, num_samples=100, accuracy=0.8144999742507935, crossentropy=0.5194894618545757),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=8, num_samples=100, accuracy=0.8098000288009644, crossentropy=0.5048562950047071),
 OBIPerformance(total_training_set_size=72, real_training_set_size=69, online_training_set_size=3, trial_index=9, num_samples=100, accuracy=0.803600013256073, crossentropy=0.523545556921369)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub_train_set</span> <span class="o">=</span> <span class="n">train_dataset</span> <span class="o">*</span> <span class="mf">0.1</span>
<span class="n">joint_set</span> <span class="o">=</span> <span class="n">sub_train_set</span> <span class="o">+</span> <span class="n">test_dataset</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">sub_train_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6000</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">joint_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">joint_set</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Model-Sampling">Model Sampling<a class="anchor-link" href="#Model-Sampling"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#     num_samples=10000, loader=joint_loader, device=&quot;cuda&quot;, storage_device=&quot;cpu&quot;</span>
<span class="c1"># )</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N_M_C</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([10055, 10000, 10])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">offset</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">virtual_training_set_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># len(training_set_90)</span>
<span class="n">evidence_factor</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true_train_predictions_n_M</span> <span class="o">=</span> <span class="n">predictions_N_M_C</span><span class="p">[</span>
    <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">virtual_training_set_size</span><span class="p">)),</span> <span class="p">:,</span> <span class="n">labels_N</span><span class="p">[</span><span class="n">offset</span> <span class="p">:</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">virtual_training_set_size</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true_train_predictions_n_M</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([20, 10000])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mix_weights_M</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">true_train_predictions_n_M</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># / (virtual_training_set_size*evidence_factor)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mix_weights_M</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([10000])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mix_weights_M</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-192.5637, -225.6693, -218.5273,  ..., -108.0355, -171.4913,
        -169.5077])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">mix_weights_M</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">split_joints</span> <span class="o">=</span> <span class="n">mix_weights_M</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">predictions_N_M_C</span><span class="p">[</span><span class="mi">55</span><span class="p">:]</span>  <span class="c1"># [:, mix_weights_M &gt; -40, :]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">split_joints</span><span class="o">.</span><span class="n">exp</span><span class="p">(),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># predictions_N = torch.argmax(torch.log_softmax(torch.logsumexp(split_joints, dim=1), dim=1), dim=1)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([10000])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">predictions_N</span> <span class="o">==</span> <span class="n">labels_N</span><span class="p">[</span><span class="mi">55</span><span class="p">:])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions_N</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.7097)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Prior-Sampling">Prior Sampling<a class="anchor-link" href="#Prior-Sampling"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span>
<span class="kn">import</span> <span class="nn">torch.optim</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span> <span class="k">as</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Module</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">functional</span> <span class="k">as</span> <span class="n">F</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">Dataset</span>

<span class="kn">from</span> <span class="nn">batchbald_redux.active_learning</span> <span class="kn">import</span> <span class="n">RandomFixedLengthSampler</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.black_box_model_training</span> <span class="kn">import</span> <span class="n">train</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.consistent_mc_dropout</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BayesianModule</span><span class="p">,</span>
    <span class="n">ConsistentMCDropout</span><span class="p">,</span>
    <span class="n">ConsistentMCDropout2d</span><span class="p">,</span>
    <span class="n">GradEmbeddingType</span><span class="p">,</span>
    <span class="n">freeze_encoder_context</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.model_optimizer_factory</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ModelOptimizer</span><span class="p">,</span>
    <span class="n">ModelOptimizerFactory</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cell</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.trained_model</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ModelTrainer</span><span class="p">,</span>
    <span class="n">TrainedBayesianModel</span><span class="p">,</span>
    <span class="n">TrainedModel</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">class</span> <span class="nc">MNISTCNN</span><span class="p">(</span><span class="n">BayesianModule</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mc_forward_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">freeze_encoder</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">freeze_encoder_context</span><span class="p">(</span><span class="n">freeze_encoder</span><span class="p">):</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>

        <span class="n">embedding</span> <span class="o">=</span> <span class="nb">input</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">input</span><span class="p">,</span> <span class="n">embedding</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">nullcontext</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">blackhc.progress_bar</span> <span class="kn">import</span> <span class="n">create_progress_bar</span>
<span class="kn">from</span> <span class="nn">toma</span> <span class="kn">import</span> <span class="n">toma</span>
<span class="kn">from</span> <span class="nn">torch.nn</span> <span class="kn">import</span> <span class="n">Module</span>
<span class="c1"># Cell</span>
<span class="kn">from</span> <span class="nn">torch.utils</span> <span class="kn">import</span> <span class="n">data</span>


<span class="k">def</span> <span class="nf">assert_no_shuffling_no_augmentations_dataloader</span><span class="p">(</span><span class="n">dataloader</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">):</span>
    <span class="n">batch_x_A</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">batch_labels_A</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">batch_x_B</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">batch_labels_B</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">batch_x_A</span><span class="p">,</span> <span class="n">batch_labels_A</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="k">for</span> <span class="n">batch_x_B</span><span class="p">,</span> <span class="n">batch_labels_B</span> <span class="ow">in</span> <span class="n">dataloader</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
        <span class="n">batch_x_A</span> <span class="o">==</span> <span class="n">batch_x_B</span>
    <span class="p">),</span> <span class="s2">&quot;Batch inputs different. Augmentations enabled, or dataloader shuffles data?!&quot;</span>


    <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">batch_labels_A</span> <span class="o">==</span> <span class="n">batch_labels_B</span><span class="p">),</span> <span class="s2">&quot;Batch labels different. Augmentations enabled, or dataloader shuffles data?!&quot;</span>

    
<span class="nd">@torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">reinit_model_get_predictions_labels</span><span class="p">(</span>
    <span class="n">model_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">loader</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">storage_device</span>
<span class="p">):</span>
    <span class="n">assert_no_shuffling_no_augmentations_dataloader</span><span class="p">(</span><span class="n">loader</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">num_samples</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">loader</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">pbar</span> <span class="o">=</span> <span class="n">create_progress_bar</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">num_samples</span><span class="p">,</span> <span class="n">tqdm_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s2">&quot;get_predictions_labels&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">pbar</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nd">@toma</span><span class="o">.</span><span class="n">execute</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_prediction_batch</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">predictions</span>
        <span class="k">nonlocal</span> <span class="n">labels</span>

        <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">pbar</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>

        <span class="n">num_sub_samples</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span>

        <span class="n">data_start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_labels</span> <span class="ow">in</span> <span class="n">loader</span><span class="p">:</span>
            <span class="n">batch_x</span> <span class="o">=</span> <span class="n">batch_x</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="n">model</span> <span class="o">=</span> <span class="n">model_class</span><span class="p">()</span>
            <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
            <span class="n">batch_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">batch_x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">batch_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">)</span>
            <span class="n">data_end</span> <span class="o">=</span> <span class="n">data_start</span> <span class="o">+</span> <span class="n">batch_size</span>

            <span class="c1"># Support multi-dim predictions.</span>
            <span class="k">if</span> <span class="n">predictions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">predictions_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">num_samples</span><span class="p">,</span> <span class="o">*</span><span class="n">batch_predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">predictions_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">batch_predictions</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">storage_device</span><span class="p">)</span>
            <span class="c1"># Support multi-dim labels.</span>
            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">labels_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="o">*</span><span class="n">batch_labels</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">labels_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">batch_labels</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">storage_device</span><span class="p">)</span>

            <span class="n">predictions</span><span class="p">[</span><span class="n">data_start</span><span class="p">:</span><span class="n">data_end</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="n">batch_predictions</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">labels</span><span class="p">[</span><span class="n">data_start</span><span class="p">:</span><span class="n">data_end</span><span class="p">]</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="n">batch_labels</span><span class="p">,</span> <span class="n">non_blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">data_start</span> <span class="o">=</span> <span class="n">data_end</span>

            <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">batch_size</span> <span class="o">*</span> <span class="n">num_sub_samples</span><span class="p">)</span>

    <span class="n">pbar</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">labels</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N_M_C</span><span class="p">,</span> <span class="n">labels_N</span> <span class="o">=</span> <span class="n">reinit_model_get_predictions_labels</span><span class="p">(</span>
    <span class="n">MNISTCNN</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="n">joint_loader</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="n">storage_device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">virtual_training_set_size</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># len(training_set_90)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true_train_predictions_n_M</span> <span class="o">=</span> <span class="n">predictions_N_M_C</span><span class="p">[</span>
    <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">virtual_training_set_size</span><span class="p">)),</span> <span class="p">:,</span> <span class="n">labels_N</span><span class="p">[:</span><span class="n">virtual_training_set_size</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">true_train_predictions_n_M</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([50, 100])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mix_weights_M</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">true_train_predictions_n_M</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">virtual_training_set_size</span> <span class="o">/</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mix_weights_M</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([100])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mix_weights_M</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([-93.7274, -92.3730, -93.3257, -91.8971, -93.8792, -91.4355, -91.9618,
        -91.4423, -92.1715, -92.9064, -92.6598, -92.2078, -91.6831, -91.3584,
        -93.7402, -91.9232, -92.2881, -92.1177, -93.3058, -92.1556, -92.6762,
        -91.8038, -91.6045, -91.4175, -91.6196, -93.0117, -92.9579, -92.6618,
        -93.0963, -91.6542, -92.2731, -92.0759, -93.4786, -91.4171, -91.0366,
        -91.8476, -92.0384, -91.8310, -93.4134, -91.3530, -92.2231, -93.8096,
        -92.9808, -93.4071, -92.2301, -92.4571, -90.6741, -92.9026, -91.6518,
        -92.1958, -92.3968, -92.5815, -92.6207, -92.3945, -93.0710, -93.0059,
        -92.5404, -92.4819, -91.7358, -91.9300, -92.0748, -91.9805, -92.0914,
        -91.6912, -92.9176, -91.7888, -92.1684, -92.1748, -92.5272, -91.5815,
        -91.3627, -92.4682, -92.4429, -92.1385, -92.1866, -92.6167, -93.1052,
        -91.1981, -92.6332, -92.6460, -91.6807, -92.7387, -91.6578, -92.4994,
        -92.3912, -92.1155, -92.2767, -91.4916, -93.1281, -91.9997, -91.2743,
        -92.2799, -91.4912, -91.6274, -93.1408, -94.0916, -92.0254, -92.7102,
        -92.6852, -92.7951])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">mix_weights_M</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;AxesSubplot:ylabel=&#39;Density&#39;&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">split_joints</span> <span class="o">=</span> <span class="n">mix_weights_M</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">predictions_N_M_C</span><span class="p">[</span><span class="n">virtual_training_set_size</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">split_joints</span><span class="o">.</span><span class="n">exp</span><span class="p">(),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># predictions_N = torch.argmax(torch.log_softmax(torch.logsumexp(split_joints, dim=1), dim=1), dim=1)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions_N</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([10005])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">predictions_N</span> <span class="o">==</span> <span class="n">labels_N</span><span class="p">[</span><span class="n">virtual_training_set_size</span><span class="p">:])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions_N</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.1070)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

