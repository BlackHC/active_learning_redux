---

title: Datasets


keywords: fastai
sidebar: home_sidebar

summary: "What the name says..."
description: "What the name says..."
nb_path: "05c_more_datasets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 05c_more_datasets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>

<span class="kn">import</span> <span class="nn">kornia.augmentation</span> <span class="k">as</span> <span class="nn">K</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedShuffleSplit</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils</span> <span class="kn">import</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>

<span class="kn">from</span> <span class="nn">batchbald_redux.dataset_challenges</span> <span class="kn">import</span> <span class="n">NamedDataset</span><span class="p">,</span> <span class="n">get_targets</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.cinic10</span> <span class="kn">import</span> <span class="n">CINIC10</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.fast_mnist</span> <span class="kn">import</span> <span class="n">FastFashionMNIST</span><span class="p">,</span> <span class="n">FastMNIST</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To speed up experiments, we are going to use Joost's FastMNIST (<a href="https://tinyurl.com/pytorch-fast-mnist">https://tinyurl.com/pytorch-fast-mnist</a>), which preloads the dataset onto the device.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SplitDataset" class="doc_header"><code>class</code> <code>SplitDataset</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L29" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SplitDataset</code>(<strong><code>input_size</code></strong>:<code>int</code>, <strong><code>num_classes</code></strong>:<code>int</code>, <strong><code>options</code></strong>:<code>dict</code>, <strong><code>train</code></strong>:<a href="/batchbald_redux/dataset_challenges.html#NamedDataset"><code>NamedDataset</code></a>, <strong><code>validation</code></strong>:<a href="/batchbald_redux/dataset_challenges.html#NamedDataset"><code>NamedDataset</code></a>, <strong><code>test</code></strong>:<a href="/batchbald_redux/dataset_challenges.html#NamedDataset"><code>NamedDataset</code></a>, <strong><code>train_augmentations</code></strong>:<code>Sequential</code>, <strong><code>device</code></strong>:<code>str</code>)</p>
</blockquote>
<p>SplitDataset(input_size: int, num_classes: int, options: dict, train: batchbald_redux.dataset_challenges.NamedDataset, validation: batchbald_redux.dataset_challenges.NamedDataset, test: batchbald_redux.dataset_challenges.NamedDataset, train_augmentations: torch.nn.modules.container.Sequential, device: str)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SplitDataLoader" class="doc_header"><code>class</code> <code>SplitDataLoader</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L43" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SplitDataLoader</code>(<strong><code>input_size</code></strong>:<code>int</code>, <strong><code>num_class</code></strong>:<code>int</code>, <strong><code>options</code></strong>:<code>dict</code>, <strong><code>train</code></strong>:<code>DataLoader</code>, <strong><code>validation</code></strong>:<code>DataLoader</code>, <strong><code>test</code></strong>:<code>DataLoader</code>, <strong><code>train_augmentations</code></strong>:<code>Sequential</code>)</p>
</blockquote>
<p>SplitDataLoader(input_size: int, num_class: int, options: dict, train: torch.utils.data.dataloader.DataLoader, validation: torch.utils.data.dataloader.DataLoader, test: torch.utils.data.dataloader.DataLoader, train_augmentations: torch.nn.modules.container.Sequential)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SplitDataset</span><span class="p">:</span>
    <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">num_classes</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span>

    <span class="n">train</span><span class="p">:</span> <span class="n">NamedDataset</span>
    <span class="n">validation</span><span class="p">:</span> <span class="n">NamedDataset</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">NamedDataset</span>

    <span class="n">train_augmentations</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SplitDataLoader</span><span class="p">:</span>
    <span class="n">input_size</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">num_class</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span>

    <span class="n">train</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span>
    <span class="n">validation</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span>
    <span class="n">test</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span>

    <span class="n">train_augmentations</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_validation_split" class="doc_header"><code>train_validation_split</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L57" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_validation_split</code>(<strong><code>full_train_dataset</code></strong>, <strong><code>train_labels</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train_validation_split</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">full_train_dataset</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">):</span>
    <span class="c1"># Split off validation set</span>
    <span class="k">if</span> <span class="n">validation_set_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedShuffleSplit</span><span class="p">(</span>
            <span class="n">n_splits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">train_indices</span><span class="p">,</span> <span class="n">validation_indices</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span>
            <span class="n">X</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">full_train_dataset</span><span class="p">)),</span> <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">(</span><span class="n">train_labels</span><span class="p">)</span><span class="o">.</span><span class="n">cpu</span><span class="p">())</span>
        <span class="p">):</span>
            <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Always wrap the dataset in a subset so there</span>
        <span class="n">train_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">full_train_dataset</span><span class="p">)))</span>
        <span class="n">validation_indices</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">full_train_dataset</span><span class="p">,</span> <span class="n">train_indices</span><span class="p">)</span>
    <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">full_train_dataset</span><span class="p">,</span> <span class="n">validation_indices</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_SVHN" class="doc_header"><code>get_SVHN</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_SVHN</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_CIFAR10" class="doc_header"><code>get_CIFAR10</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_CIFAR10</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_CINIC10" class="doc_header"><code>get_CINIC10</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L175" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_CINIC10</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>imagenet_only</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_CIFAR100" class="doc_header"><code>get_CIFAR100</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L232" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_CIFAR100</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_MNIST" class="doc_header"><code>get_MNIST</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L285" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_MNIST</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_FashionMNIST" class="doc_header"><code>get_FashionMNIST</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L320" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_FashionMNIST</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_EMNIST" class="doc_header"><code>get_EMNIST</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L355" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_EMNIST</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_balanced_EMNIST" class="doc_header"><code>get_balanced_EMNIST</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L406" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_balanced_EMNIST</code>(<strong><code>root</code></strong>, <strong><code>validation_set_size</code></strong>, <strong><code>validation_split_random_state</code></strong>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>device_hint</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CIFAR10_NORMALIZE</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.4914</span><span class="p">,</span> <span class="mf">0.4822</span><span class="p">,</span> <span class="mf">0.4465</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2023</span><span class="p">,</span> <span class="mf">0.1994</span><span class="p">,</span> <span class="mf">0.2010</span><span class="p">))</span>
<span class="n">CIFAR10_BATCH_NORMALIZE</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">([</span><span class="mf">0.4914</span><span class="p">,</span> <span class="mf">0.4822</span><span class="p">,</span> <span class="mf">0.4465</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">([</span><span class="mf">0.2023</span><span class="p">,</span> <span class="mf">0.1994</span><span class="p">,</span> <span class="mf">0.2010</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">CIFAR10_BATCH_DENORMALIZE</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">Denormalize</span><span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">([</span><span class="mf">0.4914</span><span class="p">,</span> <span class="mf">0.4822</span><span class="p">,</span> <span class="mf">0.4465</span><span class="p">]),</span> <span class="n">torch</span><span class="o">.</span><span class="n">as_tensor</span><span class="p">([</span><span class="mf">0.2023</span><span class="p">,</span> <span class="mf">0.1994</span><span class="p">,</span> <span class="mf">0.2010</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">CINIC10_NORMALIZE</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.47889522</span><span class="p">,</span> <span class="mf">0.47227842</span><span class="p">,</span> <span class="mf">0.43047404</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.24205776</span><span class="p">,</span> <span class="mf">0.23828046</span><span class="p">,</span> <span class="mf">0.25874835</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">get_SVHN</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># NOTE: these are not correct mean and std for SVHN, but are commonly used</span>
    <span class="n">normalize</span> <span class="o">=</span> <span class="n">CIFAR10_NORMALIZE</span> <span class="k">if</span> <span class="n">normalize_like_cifar10</span> <span class="k">else</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">normalize</span><span class="p">])</span>

    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">SVHN</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s2">&quot;/SVHN&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">SVHN</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s2">&quot;/SVHN&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;SVHN (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;SVHN (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;SVHN (Test)&quot;</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(),</span>
        <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_CIFAR10</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">dataset_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">CIFAR10_NORMALIZE</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">train_augmentations</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">K</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
        <span class="n">K</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
    <span class="p">)</span>

    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s2">&quot;/CIFAR10&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s2">&quot;/CIFAR10&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;CIFAR-10 (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;CIFAR-10 (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;CIFAR-10 (Test)&quot;</span><span class="p">),</span>
        <span class="n">train_augmentations</span><span class="p">,</span>
        <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_CINIC10</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">imagenet_only</span><span class="p">,</span> <span class="n">device_hint</span>
<span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># NOTE: these are not correct mean and std for SVHN, but are commonly used</span>
    <span class="n">normalize</span> <span class="o">=</span> <span class="n">CIFAR10_NORMALIZE</span> <span class="k">if</span> <span class="n">normalize_like_cifar10</span> <span class="k">else</span> <span class="n">CINIC10_NORMALIZE</span>
    <span class="n">dataset_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">normalize</span><span class="p">])</span>

    <span class="n">train_augmentations</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">K</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
        <span class="n">K</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
    <span class="p">)</span>

    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">CINIC10</span><span class="p">(</span>
        <span class="n">root</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">imagenet_only</span><span class="o">=</span><span class="n">imagenet_only</span>
    <span class="p">)</span>
    <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">CINIC10</span><span class="p">(</span>
        <span class="n">root</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">imagenet_only</span><span class="o">=</span><span class="n">imagenet_only</span>
    <span class="p">)</span>

    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ConcatDataset</span><span class="p">([</span><span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">])</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">get_targets</span><span class="p">(</span><span class="n">full_train_dataset</span><span class="p">),</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">CINIC10</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">imagenet_only</span><span class="o">=</span><span class="n">imagenet_only</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;CINIC-10 (Train, imagenet_only=</span><span class="si">{</span><span class="n">imagenet_only</span><span class="si">}</span><span class="s2">, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;CINIC-10 (Validation, imagenet_only=</span><span class="si">{</span><span class="n">imagenet_only</span><span class="si">}</span><span class="s2">, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;CINIC-10 (Test, imagenet_only=</span><span class="si">{imagenet_only}</span><span class="s2">)&quot;</span><span class="p">),</span>
        <span class="n">train_augmentations</span><span class="p">,</span>
        <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_CIFAR100</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="n">normalize</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">CIFAR10_NORMALIZE</span>
        <span class="k">if</span> <span class="n">normalize_like_cifar10</span>
        <span class="k">else</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5071</span><span class="p">,</span> <span class="mf">0.4866</span><span class="p">,</span> <span class="mf">0.4409</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.2673</span><span class="p">,</span> <span class="mf">0.2564</span><span class="p">,</span> <span class="mf">0.2762</span><span class="p">))</span>
    <span class="p">)</span>

    <span class="n">dataset_transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span>
            <span class="n">normalize</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">train_augmentations</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
        <span class="n">K</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">((</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
        <span class="n">K</span><span class="o">.</span><span class="n">RandomHorizontalFlip</span><span class="p">(),</span>
    <span class="p">)</span>

    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR100</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s2">&quot;/CIFAR100&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR100</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="s2">&quot;/CIFAR100&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">dataset_transform</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;CIFAR-100 (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;CIFAR-100 (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;CIFAR-100 (Test)&quot;</span><span class="p">),</span>
        <span class="n">train_augmentations</span><span class="p">,</span>
        <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_MNIST</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">28</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device_hint</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device_hint</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;MNIST (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;MNIST (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;MNIST (Test)&quot;</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(),</span>
        <span class="n">device_hint</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_FashionMNIST</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">28</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">FastFashionMNIST</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device_hint</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastFashionMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device_hint</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FashionMNIST (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;FashionMNIST (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;FashionMNIST (Test)&quot;</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(),</span>
        <span class="n">device_hint</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_EMNIST</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">28</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">47</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    EMNIST ByClass: 814,255 characters. 62 unbalanced classes.</span>

<span class="sd">    EMNIST ByMerge: 814,255 characters. 47 unbalanced classes.</span>

<span class="sd">    EMNIST Balanced: 131,600 characters. 47 balanced classes.</span>

<span class="sd">    EMNIST Letters: 145,600 characters. 26 balanced classes.</span>

<span class="sd">    EMNIST Digits: 280,000 characters. 10 balanced classes.</span>

<span class="sd">    EMNIST MNIST: 70,000 characters. 10 balanced classes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">split</span> <span class="o">=</span> <span class="s2">&quot;bymerge&quot;</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))])</span>
    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">EMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">EMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;EMNIST (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;EMNIST (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;EMNIST (Test)&quot;</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(),</span>
        <span class="n">device_hint</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">get_balanced_EMNIST</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="p">,</span> <span class="n">validation_split_random_state</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="p">,</span> <span class="n">device_hint</span><span class="p">):</span>
    <span class="n">input_size</span> <span class="o">=</span> <span class="mi">28</span>
    <span class="n">num_classes</span> <span class="o">=</span> <span class="mi">47</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    EMNIST ByClass: 814,255 characters. 62 unbalanced classes.</span>

<span class="sd">    EMNIST ByMerge: 814,255 characters. 47 unbalanced classes.</span>

<span class="sd">    EMNIST Balanced: 131,600 characters. 47 balanced classes.</span>

<span class="sd">    EMNIST Letters: 145,600 characters. 26 balanced classes.</span>

<span class="sd">    EMNIST Digits: 280,000 characters. 10 balanced classes.</span>

<span class="sd">    EMNIST MNIST: 70,000 characters. 10 balanced classes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">split</span> <span class="o">=</span> <span class="s2">&quot;balanced&quot;</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.3081</span><span class="p">,))])</span>
    <span class="n">full_train_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">EMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">EMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">split</span><span class="o">=</span><span class="n">split</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>

    <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
        <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="p">,</span>
        <span class="n">train_labels</span><span class="o">=</span><span class="n">full_train_dataset</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataset</span><span class="p">(</span>
        <span class="n">input_size</span><span class="p">,</span>
        <span class="n">num_classes</span><span class="p">,</span>
        <span class="nb">dict</span><span class="p">(</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
            <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;EMNIST (Train, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;EMNIST (Validation, seed=</span><span class="si">{</span><span class="n">validation_split_random_state</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="s2">&quot;EMNIST (Test)&quot;</span><span class="p">),</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(),</span>
        <span class="n">device_hint</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_dataset" class="doc_header"><code>get_dataset</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L472" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_dataset</code>(<strong><code>name</code></strong>:<code>str</code>, <strong><code>root</code></strong>=<em><code>None</code></em>, <strong><code>validation_set_size</code></strong>=<em><code>0</code></em>, <strong><code>validation_split_random_state</code></strong>=<em><code>0</code></em>, <strong><code>normalize_like_cifar10</code></strong>=<em><code>False</code></em>, <strong><code>device_hint</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_dataloaders" class="doc_header"><code>get_dataloaders</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L496" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_dataloaders</code>(<strong><code>split_dataset</code></strong>:<a href="/batchbald_redux/more_datasets.html#SplitDataset"><code>SplitDataset</code></a>, <strong><code>train_batch_size</code></strong>=<em><code>128</code></em>, <strong><code>eval_batch_size</code></strong>=<em><code>512</code></em>, <strong><code>train_shuffle</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_dataloaders_by_name" class="doc_header"><code>get_dataloaders_by_name</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/datasets.py#L516" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_dataloaders_by_name</code>(<strong><code>name</code></strong>:<code>str</code>, <strong><code>normalize_like_cifar10</code></strong>, <strong><code>root</code></strong>=<em><code>None</code></em>, <strong><code>validation_set_size</code></strong>=<em><code>None</code></em>, <strong><code>validation_split_random_state</code></strong>=<em><code>None</code></em>, <strong><code>train_batch_size</code></strong>=<em><code>128</code></em>, <strong><code>eval_batch_size</code></strong>=<em><code>512</code></em>, <strong><code>train_shuffle</code></strong>=<em><code>True</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset_factories</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;SVHN&quot;</span><span class="p">:</span> <span class="n">get_SVHN</span><span class="p">,</span>
    <span class="s2">&quot;CIFAR-10&quot;</span><span class="p">:</span> <span class="n">get_CIFAR10</span><span class="p">,</span>
    <span class="s2">&quot;CIFAR-100&quot;</span><span class="p">:</span> <span class="n">get_CIFAR100</span><span class="p">,</span>
    <span class="s2">&quot;CINIC-10&quot;</span><span class="p">:</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">get_CINIC10</span><span class="p">,</span> <span class="n">imagenet_only</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="s2">&quot;IMAGENET-CINIC-10&quot;</span><span class="p">:</span> <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">get_CINIC10</span><span class="p">,</span> <span class="n">imagenet_only</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="s2">&quot;MNIST&quot;</span><span class="p">:</span> <span class="n">get_MNIST</span><span class="p">,</span>
    <span class="s2">&quot;EMNIST&quot;</span><span class="p">:</span> <span class="n">get_EMNIST</span><span class="p">,</span>
    <span class="s2">&quot;BalancedEMNIST&quot;</span><span class="p">:</span> <span class="n">get_balanced_EMNIST</span><span class="p">,</span>
    <span class="s2">&quot;FashionMNIST&quot;</span><span class="p">:</span> <span class="n">get_FashionMNIST</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">get_dataset</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_set_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">validation_split_random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">device_hint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SplitDataset</span><span class="p">:</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">root</span> <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;./&quot;</span>
    <span class="n">validation_set_size</span> <span class="o">=</span> <span class="n">validation_set_size</span> <span class="k">if</span> <span class="n">validation_set_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">validation_split_random_state</span> <span class="o">=</span> <span class="n">validation_split_random_state</span> <span class="k">if</span> <span class="n">validation_split_random_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
    <span class="n">normalize_like_cifar10</span> <span class="o">=</span> <span class="n">normalize_like_cifar10</span> <span class="k">if</span> <span class="n">normalize_like_cifar10</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">False</span>

    <span class="n">split_dataset</span> <span class="o">=</span> <span class="n">dataset_factories</span><span class="p">[</span><span class="n">name</span><span class="p">](</span>
        <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
        <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
        <span class="n">device_hint</span><span class="o">=</span><span class="n">device_hint</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">split_dataset</span>


<span class="k">def</span> <span class="nf">get_dataloaders</span><span class="p">(</span><span class="n">split_dataset</span><span class="p">:</span> <span class="n">SplitDataset</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">eval_batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">train_shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="c1"># This only works well for CIFAR-10, etc and not FastMNIST, FashionMNIST!</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;pin_memory&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>

    <span class="n">train_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">split_dataset</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">train_batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="n">train_shuffle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">validation_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">split_dataset</span><span class="o">.</span><span class="n">validation</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">eval_batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">test_loader</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">split_dataset</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">eval_batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SplitDataLoader</span><span class="p">(</span>
        <span class="n">split_dataset</span><span class="o">.</span><span class="n">input_size</span><span class="p">,</span>
        <span class="n">split_dataset</span><span class="o">.</span><span class="n">num_classes</span><span class="p">,</span>
        <span class="n">split_dataset</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
        <span class="n">train_loader</span><span class="p">,</span>
        <span class="n">validation_loader</span><span class="p">,</span>
        <span class="n">test_loader</span><span class="p">,</span>
        <span class="n">split_dataset</span><span class="o">.</span><span class="n">train_augmentations</span><span class="p">,</span>
    <span class="p">)</span>


<span class="k">def</span> <span class="nf">get_dataloaders_by_name</span><span class="p">(</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">normalize_like_cifar10</span><span class="p">,</span>
    <span class="n">root</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_set_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">validation_split_random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">train_batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">eval_batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
    <span class="n">train_shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
    <span class="n">split_dataset</span> <span class="o">=</span> <span class="n">get_dataset</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">root</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
        <span class="n">validation_set_size</span><span class="o">=</span><span class="n">validation_set_size</span><span class="p">,</span>
        <span class="n">validation_split_random_state</span><span class="o">=</span><span class="n">validation_split_random_state</span><span class="p">,</span>
        <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="n">normalize_like_cifar10</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">split_dataloaders</span> <span class="o">=</span> <span class="n">get_dataloaders</span><span class="p">(</span>
        <span class="n">split_dataset</span><span class="p">,</span> <span class="n">train_batch_size</span><span class="o">=</span><span class="n">train_batch_size</span><span class="p">,</span> <span class="n">eval_batch_size</span><span class="o">=</span><span class="n">eval_batch_size</span><span class="p">,</span> <span class="n">train_shuffle</span><span class="o">=</span><span class="n">train_shuffle</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">split_dataloaders</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Validate-that-we-can-load-all-datasets">Validate that we can load all datasets<a class="anchor-link" href="#Validate-that-we-can-load-all-datasets"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataloaders_by_name</span><span class="p">(</span><span class="s2">&quot;CIFAR-10&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
Files already downloaded and verified
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataLoader(input_size=32, num_class=10, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8be6c5ef40&gt;, validation=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8be6c5e7c0&gt;, test=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8be6c5e490&gt;, train_augmentations=Sequential(
  (0): RandomCrop(crop_size=(32, 32), padding=4, fill=0, pad_if_needed=False, padding_mode=constant, resample=BILINEAR, p=1.0, p_batch=1.0, same_on_batch=False, return_transform=False)
  (1): RandomHorizontalFlip(p=0.5, p_batch=1.0, same_on_batch=False, return_transform=None)
))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataloaders_by_name</span><span class="p">(</span><span class="s2">&quot;CIFAR-100&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataLoader(input_size=32, num_class=100, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8be6de0c10&gt;, validation=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8be6de0af0&gt;, test=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8be6de0fa0&gt;, train_augmentations=Sequential(
  (0): RandomCrop(crop_size=(32, 32), padding=4, fill=0, pad_if_needed=False, padding_mode=constant, resample=BILINEAR, p=1.0, p_batch=1.0, same_on_batch=False, return_transform=False)
  (1): RandomHorizontalFlip(p=0.5, p_batch=1.0, same_on_batch=False, return_transform=None)
))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataloaders_by_name</span><span class="p">(</span><span class="s2">&quot;SVHN&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Using downloaded and verified file: data/SVHN/train_32x32.mat
Using downloaded and verified file: data/SVHN/train_32x32.mat
Using downloaded and verified file: data/SVHN/test_32x32.mat
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataLoader(input_size=32, num_class=10, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f4d7753c790&gt;, validation=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f4d7754da90&gt;, test=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f4d7754db80&gt;, train_augmentations=Sequential())</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataloaders_by_name</span><span class="p">(</span><span class="s2">&quot;CINIC-10&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
Files already downloaded and verified
Files already downloaded and verified
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataLoader(input_size=32, num_class=10, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f0c0f7e4250&gt;, validation=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f0c0f7f4af0&gt;, test=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f0c0f7d9fa0&gt;, train_augmentations=Sequential(
  (0): RandomCrop(crop_size=(32, 32), padding=4, fill=0, pad_if_needed=False, padding_mode=constant, resample=BILINEAR, p=1.0, p_batch=1.0, same_on_batch=False, return_transform=False)
  (1): RandomHorizontalFlip(p=0.5, p_batch=1.0, same_on_batch=False, return_transform=None)
))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataloaders_by_name</span><span class="p">(</span><span class="s2">&quot;EMNIST&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Downloading https://www.itl.nist.gov/iaui/vip/cs_links/EMNIST/gzip.zip to data/EMNIST/raw/gzip.zip
Extracting data/EMNIST/raw/gzip.zip to data/EMNIST/raw
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataLoader(input_size=28, num_class=47, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: False}, train=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8bdd7fad00&gt;, validation=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8bdd7fa580&gt;, test=&lt;torch.utils.data.dataloader.DataLoader object at 0x7f8bdd7fae20&gt;, train_augmentations=Sequential())</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Validate-that-we-can-create-a-validation-split">Validate that we can create a validation split<a class="anchor-link" href="#Validate-that-we-can-create-a-validation-split"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataset</span><span class="p">(</span><span class="s2">&quot;CIFAR-10&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
Files already downloaded and verified
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataset(input_size=32, num_classes=10, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&#39;CIFAR-10 (Train, seed=0, 45000 samples)&#39;, validation=&#39;CIFAR-10 (Validation, seed=0, 5000 samples)&#39;, test=&#39;CIFAR-10 (Test)&#39;, train_augmentations=Sequential(
  (0): RandomCrop(crop_size=(32, 32), padding=4, fill=0, pad_if_needed=False, padding_mode=constant, resample=BILINEAR, p=1.0, p_batch=1.0, same_on_batch=False, return_transform=False)
  (1): RandomHorizontalFlip(p=0.5, p_batch=1.0, same_on_batch=False, return_transform=None)
))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataset</span><span class="p">(</span><span class="s2">&quot;MNIST&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataset(input_size=28, num_classes=10, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&#39;MNIST (Train, seed=0, 55000 samples)&#39;, validation=&#39;MNIST (Validation, seed=0, 5000 samples)&#39;, test=&#39;MNIST (Test)&#39;, train_augmentations=Sequential())</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataset</span><span class="p">(</span><span class="s2">&quot;IMAGENET-CINIC-10&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
Files already downloaded and verified
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/blackhc/anaconda3/envs/active_learning/lib/python3.8/site-packages/sklearn/utils/__init__.py:1102: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  return floored.astype(np.int)
/home/blackhc/anaconda3/envs/active_learning/lib/python3.8/site-packages/sklearn/utils/__init__.py:1102: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  return floored.astype(np.int)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Files already downloaded and verified
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataset(input_size=32, num_classes=10, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: True}, train=&#39;CINIC-10 (Train, imagenet_only=True, seed=0, 135000 samples)&#39;, validation=&#39;CINIC-10 (Validation, imagenet_only=True, seed=0, 5000 samples)&#39;, test=&#39;CINIC-10 (Test, imagenet_only={imagenet_only})&#39;, train_augmentations=Sequential(
  (0): RandomCrop(crop_size=(32, 32), padding=4, fill=0, pad_if_needed=False, padding_mode=constant, resample=BILINEAR, p=1.0, p_batch=1.0, same_on_batch=False, return_transform=False)
  (1): RandomHorizontalFlip(p=0.5, p_batch=1.0, same_on_batch=False, return_transform=None)
), device=&#39;cpu&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_dataset</span><span class="p">(</span><span class="s2">&quot;EMNIST&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">validation_set_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/blackhc/anaconda3/envs/active_learning/lib/python3.8/site-packages/sklearn/utils/__init__.py:1102: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  return floored.astype(np.int)
/home/blackhc/anaconda3/envs/active_learning/lib/python3.8/site-packages/sklearn/utils/__init__.py:1102: DeprecationWarning: `np.int` is a deprecated alias for the builtin `int`. To silence this warning, use `int` by itself. Doing this will not modify any behavior and is safe. When replacing `np.int`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
  return floored.astype(np.int)
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SplitDataset(input_size=28, num_classes=47, options={&#39;validation_split_random_state&#39;: 0, &#39;normalize_like_cifar10&#39;: False}, train=&#39;EMNIST (Train, seed=0, 692932 samples)&#39;, validation=&#39;EMNIST (Validation, seed=0, 5000 samples)&#39;, test=&#39;EMNIST (Test)&#39;, train_augmentations=Sequential(), device=None)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Validate-Kornia-augmentations">Validate Kornia augmentations<a class="anchor-link" href="#Validate-Kornia-augmentations"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">kornia</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchvision</span>

<span class="n">split_dataloaders</span> <span class="o">=</span> <span class="n">get_dataloaders_by_name</span><span class="p">(</span><span class="s2">&quot;CIFAR-10&quot;</span><span class="p">,</span> <span class="n">normalize_like_cifar10</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">root</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">image_batch</span><span class="p">,</span> <span class="n">labels</span> <span class="ow">in</span> <span class="n">split_dataloaders</span><span class="o">.</span><span class="n">train</span><span class="p">:</span>
    <span class="k">break</span>

<span class="nb">print</span><span class="p">(</span><span class="n">image_batch</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">image_rgb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">kornia</span><span class="o">.</span><span class="n">tensor_to_image</span><span class="p">(</span><span class="n">CIFAR10_BATCH_DENORMALIZE</span><span class="p">(</span><span class="n">image_batch</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">axs</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">image_rgb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">kornia</span><span class="o">.</span><span class="n">tensor_to_image</span><span class="p">(</span>
    <span class="n">CIFAR10_BATCH_DENORMALIZE</span><span class="p">(</span><span class="n">split_dataloaders</span><span class="o">.</span><span class="n">train_augmentations</span><span class="p">(</span><span class="n">image_batch</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">axs</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">axs</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_rgb</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>torch.Size([128, 3, 32, 32])
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

