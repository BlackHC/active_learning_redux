---

title: Experiment POC OBI


keywords: fastai
sidebar: home_sidebar

summary: "Can we get better by training on our assumptions?"
description: "Can we get better by training on our assumptions?"
nb_path: "D_poc_online_bayesian_inference.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: D_poc_online_bayesian_inference.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Appended /home/blackhc/PycharmProjects/bald-ical/src to paths
Switched to directory /home/blackhc/PycharmProjects/bald-ical
%load_ext autoreload
%autoreload 2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import modules and functions were are going to use.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.utils.data</span>
<span class="kn">from</span> <span class="nn">blackhc.project</span> <span class="kn">import</span> <span class="n">is_run_from_ipython</span>
<span class="kn">from</span> <span class="nn">blackhc.project.experiment</span> <span class="kn">import</span> <span class="n">embedded_experiments</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="kn">import</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="k">as</span> <span class="nn">acquisition_functions</span>
<span class="kn">import</span> <span class="nn">wandb</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CandidateBatchComputer</span><span class="p">,</span>
    <span class="n">EvalModelBatchComputer</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.active_learning</span> <span class="kn">import</span> <span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">RandomFixedLengthSampler</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.black_box_model_training</span> <span class="kn">import</span> <span class="n">evaluate_old</span><span class="p">,</span> <span class="n">train</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.dataset_challenges</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AdditiveGaussianNoise</span><span class="p">,</span>
    <span class="n">NamedDataset</span><span class="p">,</span>
    <span class="n">create_repeated_MNIST_dataset</span><span class="p">,</span>
    <span class="n">get_balanced_sample_indices</span><span class="p">,</span>
    <span class="n">get_base_dataset_index</span><span class="p">,</span>
    <span class="n">get_target</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.di</span> <span class="kn">import</span> <span class="n">DependencyInjection</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.experiment_logging</span> <span class="kn">import</span> <span class="n">asclassdict</span><span class="p">,</span> <span class="n">init_wandb</span><span class="p">,</span> <span class="n">log2wandb</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.fast_mnist</span> <span class="kn">import</span> <span class="n">FastMNIST</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.model_optimizer_factory</span> <span class="kn">import</span> <span class="n">ModelOptimizerFactory</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.models</span> <span class="kn">import</span> <span class="n">MnistOptimizerFactory</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.online_bayesian_inference</span> <span class="kn">import</span> <span class="n">evaluate_online_bayesian_inference</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># From the BatchBALD Repo</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.train_eval_model</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TrainEvalModel</span><span class="p">,</span>
    <span class="n">TrainSelfDistillationEvalModel</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.trained_model</span> <span class="kn">import</span> <span class="n">TrainedBayesianModel</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compute_entropy_from_probs" class="doc_header"><code>compute_entropy_from_probs</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/poc_online_bayesian_inference.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compute_entropy_from_probs</code>(<strong><code>probs_N_K_C</code></strong>:<code>Tensor</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">blackhc.progress_bar</span> <span class="kn">import</span> <span class="n">create_progress_bar</span>
<span class="kn">from</span> <span class="nn">toma</span> <span class="kn">import</span> <span class="n">toma</span>


<span class="k">def</span> <span class="nf">compute_entropy_from_probs</span><span class="p">(</span><span class="n">probs_N_K_C</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">probs_N_K_C</span><span class="o">.</span><span class="n">shape</span>

    <span class="n">entropies_N</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">)</span>

    <span class="n">pbar</span> <span class="o">=</span> <span class="n">create_progress_bar</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">tqdm_args</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Entropy&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    <span class="n">pbar</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="nd">@toma</span><span class="o">.</span><span class="n">execute</span><span class="o">.</span><span class="n">chunked</span><span class="p">(</span><span class="n">probs_N_K_C</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">compute</span><span class="p">(</span><span class="n">probs_n_K_C</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">mean_probs_n_C</span> <span class="o">=</span> <span class="n">probs_n_K_C</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">nats_n_C</span> <span class="o">=</span> <span class="n">mean_probs_n_C</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mean_probs_n_C</span><span class="p">)</span>
        <span class="n">nats_n_C</span><span class="p">[</span><span class="n">mean_probs_n_C</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">entropies_N</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span><span class="o">.</span><span class="n">copy_</span><span class="p">(</span><span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">nats_n_C</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">pbar</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span>

    <span class="n">pbar</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">entropies_N</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_predictions</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;./data/mnist_train_predictions.pt&quot;</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="n">train_entropies</span> <span class="o">=</span> <span class="n">compute_entropy_from_probs</span><span class="p">(</span><span class="n">train_predictions</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">train_entropies</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(array([55951.,  1227.,   635.,   386.,   241.,   206.,   130.,   117.,
          118.,    74.]),
 array([0.  , 0.02, 0.04, 0.06, 0.08, 0.1 , 0.12, 0.14, 0.16, 0.18, 0.2 ]),
 &lt;BarContainer object of 10 artists&gt;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYQAAAD4CAYAAADsKpHdAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/Il7ecAAAACXBIWXMAAAsTAAALEwEAmpwYAAASJUlEQVR4nO3db6xddV7v8ffHdkTuOCB/CrdpuRalUYE4f+jlNneM0VuVOnNjuQkkNSp90KSRYDKTXHNv0QfqgyZgcuVKIiQ4TCj4ByrOhEbDVVKc3BixzGFkYAoynBGESqUVkMEHoMWvD/b3mN3DPufsc9qefdp5v5KdtfZ3rd9av7W6mM/5rbX3nlQVkiR926Q7IElaGQwESRJgIEiSmoEgSQIMBElSWz3pDizVxRdfXBs2bJh0NyTpjPLUU0/9Q1WtGbXsjA2EDRs2MDU1NeluSNIZJcnfzrXMW0aSJMBAkCQ1A0GSBBgIkqRmIEiSAANBktQMBEkSYCBIkpqBIEkCzuBvKp+MDbv/eGL7fvm2T09s35I0H0cIkiTAQJAkNQNBkgQYCJKkZiBIkgADQZLUDARJEmAgSJKagSBJAgwESVIzECRJgIEgSWoGgiQJMBAkSc1AkCQBBoIkqRkIkiTAQJAktbECIcnLSZ5N8nSSqa5dmOSxJC/29IKh9W9NMp3khSTXDdWv6e1MJ7kzSbp+TpKHun4wyYZTfJySpAUsZoTwo1X1sara1O93AweqaiNwoN+T5EpgO3AVsBW4K8mqbnM3sAvY2K+tXd8JvFVVVwB3ALcv/ZAkSUtxMreMtgF7e34vcP1Q/cGqeq+qXgKmgWuTrAXOq6onqqqA+2e1mdnWw8CWmdGDJGl5jBsIBfxpkqeS7OrapVV1BKCnl3R9HfDqUNvDXVvX87PrJ7SpquPA28BFszuRZFeSqSRTx44dG7PrkqRxrB5zvU9W1WtJLgEeS/LX86w76i/7mqc+X5sTC1X3APcAbNq06QPLJUlLN9YIoape6+lR4IvAtcDrfRuInh7t1Q8Dlw01Xw+81vX1I+ontEmyGjgfeHPxhyNJWqoFAyHJh5N8ZGYe+Anga8B+YEevtgN4pOf3A9v7k0OXM3h4/GTfVnonyeZ+PnDTrDYz27oBeLyfM0iSlsk4t4wuBb7Yz3hXA79XVf8vyZeBfUl2Aq8ANwJU1aEk+4DngOPALVX1fm/rZuA+4Fzg0X4B3As8kGSawchg+yk4NknSIiwYCFX1N8BHR9TfALbM0WYPsGdEfQq4ekT9XTpQJEmT4TeVJUmAgSBJagaCJAkwECRJzUCQJAEGgiSpGQiSJMBAkCQ1A0GSBBgIkqRmIEiSAANBktQMBEkSYCBIkpqBIEkCDARJUjMQJEmAgSBJagaCJAkwECRJzUCQJAEGgiSpGQiSJMBAkCQ1A0GSBBgIkqRmIEiSAANBktTGDoQkq5L8VZI/6vcXJnksyYs9vWBo3VuTTCd5Icl1Q/Vrkjzby+5Mkq6fk+Shrh9MsuEUHqMkaQyLGSF8Bnh+6P1u4EBVbQQO9HuSXAlsB64CtgJ3JVnVbe4GdgEb+7W16zuBt6rqCuAO4PYlHY0kacnGCoQk64FPA58bKm8D9vb8XuD6ofqDVfVeVb0ETAPXJlkLnFdVT1RVAffPajOzrYeBLTOjB0nS8hh3hPB/gf8F/OtQ7dKqOgLQ00u6vg54dWi9w11b1/Oz6ye0qarjwNvARbM7kWRXkqkkU8eOHRuz65KkcSwYCEn+O3C0qp4ac5uj/rKveerztTmxUHVPVW2qqk1r1qwZszuSpHGsHmOdTwI/leRTwHcA5yX5HeD1JGur6kjfDjra6x8GLhtqvx54revrR9SH2xxOsho4H3hzicckSVqCBUcIVXVrVa2vqg0MHhY/XlU/C+wHdvRqO4BHen4/sL0/OXQ5g4fHT/ZtpXeSbO7nAzfNajOzrRt6Hx8YIUiSTp9xRghzuQ3Yl2Qn8ApwI0BVHUqyD3gOOA7cUlXvd5ubgfuAc4FH+wVwL/BAkmkGI4PtJ9EvSdISLCoQqupLwJd6/g1gyxzr7QH2jKhPAVePqL9LB4okaTL8prIkCTAQJEnNQJAkAQaCJKkZCJIkwECQJDUDQZIEGAiSpGYgSJIAA0GS1AwESRJgIEiSmoEgSQIMBElSMxAkSYCBIElqBoIkCTAQJEnNQJAkAQaCJKkZCJIkwECQJDUDQZIEGAiSpGYgSJIAA0GS1AwESRJgIEiS2oKBkOQ7kjyZ5KtJDiX5ta5fmOSxJC/29IKhNrcmmU7yQpLrhurXJHm2l92ZJF0/J8lDXT+YZMNpOFZJ0jzGGSG8B/y3qvoo8DFga5LNwG7gQFVtBA70e5JcCWwHrgK2AnclWdXbuhvYBWzs19au7wTeqqorgDuA20/+0CRJi7FgINTAP/XbD/WrgG3A3q7vBa7v+W3Ag1X1XlW9BEwD1yZZC5xXVU9UVQH3z2ozs62HgS0zowdJ0vIY6xlCklVJngaOAo9V1UHg0qo6AtDTS3r1dcCrQ80Pd21dz8+un9Cmqo4DbwMXjejHriRTSaaOHTs21gFKksYzViBU1ftV9TFgPYO/9q+eZ/VRf9nXPPX52szuxz1VtamqNq1Zs2aBXkuSFmNRnzKqqn8EvsTg3v/rfRuInh7t1Q4Dlw01Ww+81vX1I+ontEmyGjgfeHMxfZMknZxxPmW0Jsl39fy5wI8Bfw3sB3b0ajuAR3p+P7C9Pzl0OYOHx0/2baV3kmzu5wM3zWozs60bgMf7OYMkaZmsHmOdtcDe/qTQtwH7quqPkjwB7EuyE3gFuBGgqg4l2Qc8BxwHbqmq93tbNwP3AecCj/YL4F7ggSTTDEYG20/FwUmSxrdgIFTVM8DHR9TfALbM0WYPsGdEfQr4wPOHqnqXDhRJ0mT4TWVJEmAgSJKagSBJAgwESVIzECRJgIEgSWoGgiQJMBAkSc1AkCQBBoIkqRkIkiTAQJAkNQNBkgQYCJKkZiBIkgADQZLUDARJEmAgSJKagSBJAgwESVIzECRJgIEgSWoGgiQJMBAkSc1AkCQBBoIkqRkIkiTAQJAktQUDIcllSf4syfNJDiX5TNcvTPJYkhd7esFQm1uTTCd5Icl1Q/Vrkjzby+5Mkq6fk+Shrh9MsuE0HKskaR7jjBCOA/+zqn4A2AzckuRKYDdwoKo2Agf6Pb1sO3AVsBW4K8mq3tbdwC5gY7+2dn0n8FZVXQHcAdx+Co5NkrQICwZCVR2pqq/0/DvA88A6YBuwt1fbC1zf89uAB6vqvap6CZgGrk2yFjivqp6oqgLun9VmZlsPA1tmRg+SpOWxqGcIfSvn48BB4NKqOgKD0AAu6dXWAa8ONTvctXU9P7t+QpuqOg68DVw0Yv+7kkwlmTp27Nhiui5JWsDYgZDkO4E/BD5bVd+cb9URtZqnPl+bEwtV91TVpqratGbNmoW6LElahLECIcmHGITB71bVF7r8et8GoqdHu34YuGyo+Xrgta6vH1E/oU2S1cD5wJuLPRhJ0tKN8ymjAPcCz1fVbwwt2g/s6PkdwCND9e39yaHLGTw8frJvK72TZHNv86ZZbWa2dQPweD9nkCQtk9VjrPNJ4OeAZ5M83bVfAm4D9iXZCbwC3AhQVYeS7AOeY/AJpVuq6v1udzNwH3Au8Gi/YBA4DySZZjAy2H5yhyVJWqwFA6Gq/pzR9/gBtszRZg+wZ0R9Crh6RP1dOlAkSZPhN5UlSYCBIElqBoIkCTAQJEnNQJAkAQaCJKkZCJIkwECQJDUDQZIEGAiSpGYgSJIAA0GS1AwESRJgIEiSmoEgSQIMBElSMxAkSYCBIElqBoIkCTAQJEnNQJAkAQaCJKkZCJIkwECQJDUDQZIEGAiSpGYgSJIAA0GS1BYMhCSfT3I0ydeGahcmeSzJiz29YGjZrUmmk7yQ5Lqh+jVJnu1ldyZJ189J8lDXDybZcIqPUZI0hnFGCPcBW2fVdgMHqmojcKDfk+RKYDtwVbe5K8mqbnM3sAvY2K+Zbe4E3qqqK4A7gNuXejCSpKVbMBCq6v8Db84qbwP29vxe4Pqh+oNV9V5VvQRMA9cmWQucV1VPVFUB989qM7Oth4EtM6MHSdLyWeozhEur6ghATy/p+jrg1aH1DndtXc/Prp/QpqqOA28DF43aaZJdSaaSTB07dmyJXZckjXKqHyqP+su+5qnP1+aDxap7qmpTVW1as2bNErsoSRplqYHwet8GoqdHu34YuGxovfXAa11fP6J+Qpskq4Hz+eAtKknSabbUQNgP7Oj5HcAjQ/Xt/cmhyxk8PH6ybyu9k2RzPx+4aVabmW3dADzezxkkScto9UIrJPl94EeAi5McBn4FuA3Yl2Qn8ApwI0BVHUqyD3gOOA7cUlXv96ZuZvCJpXOBR/sFcC/wQJJpBiOD7afkyCRJi7JgIFTVT8+xaMsc6+8B9oyoTwFXj6i/SweKJGly/KayJAkwECRJzUCQJAEGgiSpGQiSJMBAkCQ1A0GSBBgIkqRmIEiSAANBktQMBEkSYCBIkpqBIEkCDARJUjMQJEmAgSBJagaCJAkwECRJzUCQJAEGgiSpGQiSJMBAkCQ1A0GSBBgIkqRmIEiSAANBktRWT7oD32o27P7jiez35ds+PZH9SjpzOEKQJAEraISQZCvwm8Aq4HNVdduEu3RWmdTIBBydSGeKFREISVYBvwX8OHAY+HKS/VX13GR7plPB22TSmWFFBAJwLTBdVX8DkORBYBtgIGjJJjkq0tnvbPyDY6UEwjrg1aH3h4H/MnulJLuAXf32n5K8sMT9XQz8wxLbnk72a3Hs1+Kt1L6dcf3K7cvckxOdzPn67rkWrJRAyIhafaBQdQ9wz0nvLJmqqk0nu51TzX4tjv1avJXaN/u1OKerXyvlU0aHgcuG3q8HXptQXyTpW9JKCYQvAxuTXJ7k24HtwP4J90mSvqWsiFtGVXU8yS8Af8LgY6efr6pDp3GXJ33b6TSxX4tjvxZvpfbNfi3OaelXqj5wq16S9C1opdwykiRNmIEgSQLOkkBIsjXJC0mmk+wesTxJ7uzlzyT5xEJtk1yY5LEkL/b0guXqV5LLkvxZkueTHErymaE2v5rk75I83a9PLVe/etnLSZ7tfU8N1Sd5vr5v6Hw8neSbST7by5bjfH1/kieSvJfkF8dpu0zna2S/VsD1Nd/5muT1Ndf5mvT19TN9vT+T5C+SfHShtks+X1V1Rr8YPIT+BvA9wLcDXwWunLXOp4BHGXzfYTNwcKG2wK8Du3t+N3D7MvZrLfCJnv8I8PWhfv0q8IuTOF+97GXg4hHbndj5GrGdvwe+exnP1yXAfwb2DO9rBVxfc/Vr0tfXyH6tgOtrzn5N+Pr6r8AFPf+TnMb//TobRgj//rMXVfXPwMzPXgzbBtxfA38JfFeStQu03Qbs7fm9wPXL1a+qOlJVXwGoqneA5xl8m/tUOJnzNZ+Jna9Z62wBvlFVf7vI/S+5X1V1tKq+DPzLItqe9vM1V78mfX3Nc77mM7HzNcskrq+/qKq3+u1fMvie1kJtl3S+zoZAGPWzF7Mv7rnWma/tpVV1BAb/ATH462G5+vXvkmwAPg4cHCr/Qg8fP7+EofPJ9quAP03yVAY/JTJjRZwvBt9h+f1ZtdN9vpbSdjnO14ImdH3NZ5LX1zgmfX3tZDBKXqjtks7X2RAI4/zsxVzrjPWTGUt0Mv0aLEy+E/hD4LNV9c0u3w18L/Ax4Ajwf5a5X5+sqk8wGLrekuSHF7n/09UvMvhS408BfzC0fDnO1+loe9q3PcHraz6TvL7m38CEr68kP8ogEP73YtuO62wIhHF+9mKudeZr+/rM7YieHl3GfpHkQwz+Y/3dqvrCzApV9XpVvV9V/wr8NoNh47L1q6pmpkeBLw7tf6Lnq/0k8JWqen2msEznayltl+N8zWnC19ecJnx9LWRi11eSHwQ+B2yrqjfGaLuk83U2BMI4P3uxH7gpA5uBt3sYNV/b/cCOnt8BPLJc/UoS4F7g+ar6jeEGs+6Z/w/ga8vYrw8n+Uj348PATwztf2Lna2j5TzNrOL9M52spbZfjfI20Aq6vufo16etrIRO5vpL8J+ALwM9V1dfHbLu08zXOk+eV/mLw6ZOvM3ji/std+3ng53s+DP4PeL4BPAtsmq9t1y8CDgAv9vTC5eoX8EMMhn7PAE/361O97IFe95n+R1+7jP36HgafZPgqcGilnK9e9h+AN4DzZ21zOc7Xf2Tw19o3gX/s+fNWwPU1sl8r4Pqaq1+Tvr7m+3ec5PX1OeCtoX+rqfnansz58qcrJEnA2XHLSJJ0ChgIkiTAQJAkNQNBkgQYCJKkZiBIkgADQZLU/g0U0Vc6G15GGAAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">60000</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">train_entropies</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>5678</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">initial_training_set</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">51348</span><span class="p">,</span>
    <span class="mi">49110</span><span class="p">,</span>
    <span class="mi">8222</span><span class="p">,</span>
    <span class="mi">28130</span><span class="p">,</span>
    <span class="mi">13484</span><span class="p">,</span>
    <span class="mi">47685</span><span class="p">,</span>
    <span class="mi">3938</span><span class="p">,</span>
    <span class="mi">59930</span><span class="p">,</span>
    <span class="mi">49196</span><span class="p">,</span>
    <span class="mi">19427</span><span class="p">,</span>
    <span class="mi">4601</span><span class="p">,</span>
    <span class="mi">49922</span><span class="p">,</span>
    <span class="mi">45635</span><span class="p">,</span>
    <span class="mi">35684</span><span class="p">,</span>
    <span class="mi">3579</span><span class="p">,</span>
    <span class="mi">7621</span><span class="p">,</span>
    <span class="mi">8465</span><span class="p">,</span>
    <span class="mi">33959</span><span class="p">,</span>
    <span class="mi">27521</span><span class="p">,</span>
    <span class="mi">27015</span><span class="p">,</span>
<span class="p">]</span>


<span class="n">remaining_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">60000</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">initial_training_set</span><span class="p">]</span>
<span class="n">random_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">remaining_samples</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">initial_training_set</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">random_samples</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[51348,
 49110,
 8222,
 28130,
 13484,
 47685,
 3938,
 59930,
 49196,
 19427,
 4601,
 49922,
 45635,
 35684,
 3579,
 7621,
 8465,
 33959,
 27521,
 27015,
 14546,
 56672,
 29175,
 34788,
 8131,
 26332,
 38192,
 21892,
 39029,
 38998,
 5055,
 59421,
 38657,
 56902,
 12450,
 24639,
 40834,
 49727,
 36103,
 9254,
 9245,
 58379,
 23120,
 33276,
 4809,
 1912,
 21893,
 40110,
 13327,
 12976,
 32620,
 33379,
 46791,
 54018,
 56012,
 14950,
 23198,
 23621,
 8800,
 13812,
 39580,
 51209,
 890,
 47684,
 52758,
 53629,
 1215,
 31729,
 24465,
 50917,
 48575,
 47113,
 20236,
 39311,
 25944,
 43811,
 37921,
 6902,
 321,
 49988,
 9436,
 33907,
 56920,
 13604,
 29309,
 14098,
 22260,
 40723,
 27635,
 36611,
 57194,
 44682,
 55813,
 29089,
 23673,
 55498,
 636,
 32250,
 33342,
 34457]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Experiment" class="doc_header"><code>class</code> <code>Experiment</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/poc_online_bayesian_inference.py#L312" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Experiment</code>(<strong><code>seed</code></strong>:<code>int</code>=<em><code>1337</code></em>, <strong><code>num_pool_samples</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>num_validation_samples</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>num_training_samples</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>num_patience_epochs</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>max_training_epochs</code></strong>:<code>int</code>=<em><code>120</code></em>, <strong><code>training_batch_size</code></strong>:<code>int</code>=<em><code>64</code></em>, <strong><code>device</code></strong>:<code>str</code>=<em><code>'cuda'</code></em>, <strong><code>validation_set_size</code></strong>:<code>int</code>=<em><code>1024</code></em>, <strong><code>min_samples_per_epoch</code></strong>:<code>int</code>=<em><code>1024</code></em>, <strong><code>model_optimizer_factory</code></strong>:<code>Type</code>[<code>ModelOptimizerFactory</code>]=<em><code>MnistOptimizerFactory</code></em>, <strong><code>max_obi_steps</code></strong>:<code>int</code>=<em><code>10</code></em>, <strong><code>num_samples_list</code></strong>:<code>int</code>=<em><code>(100, 1000, 10000)</code></em>, <strong><code>up_factor</code></strong>:<code>int</code>=<em><code>2</code></em>, <strong><code>num_trials</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>acquisition_size</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>random_acquisition</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Experiment(seed: int = 1337, num_pool_samples: int = 20, num_validation_samples: int = 20, num_training_samples: int = 1, num_patience_epochs: int = 20, max_training_epochs: int = 120, training_batch_size: int = 64, device: str = 'cuda', validation_set_size: int = 1024, min_samples_per_epoch: int = 1024, model_optimizer_factory: Type[batchbald_redux.model_optimizer_factory.ModelOptimizerFactory] = &lt;class 'batchbald_redux.models.MnistOptimizerFactory'&gt;, max_obi_steps: int = 10, num_samples_list: int = (100, 1000, 10000), up_factor: int = 2, num_trials: int = 5, acquisition_size: int = 5, random_acquisition: bool = False)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Rerun from 2022/04/15</span>

<span class="n">training_set_90</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">46377</span><span class="p">,</span>
    <span class="mi">44390</span><span class="p">,</span>
    <span class="mi">7485</span><span class="p">,</span>
    <span class="mi">25450</span><span class="p">,</span>
    <span class="mi">12220</span><span class="p">,</span>
    <span class="mi">43112</span><span class="p">,</span>
    <span class="mi">3612</span><span class="p">,</span>
    <span class="mi">54256</span><span class="p">,</span>
    <span class="mi">44467</span><span class="p">,</span>
    <span class="mi">17555</span><span class="p">,</span>
    <span class="mi">4218</span><span class="p">,</span>
    <span class="mi">45101</span><span class="p">,</span>
    <span class="mi">41296</span><span class="p">,</span>
    <span class="mi">32261</span><span class="p">,</span>
    <span class="mi">3281</span><span class="p">,</span>
    <span class="mi">6944</span><span class="p">,</span>
    <span class="mi">7701</span><span class="p">,</span>
    <span class="mi">30692</span><span class="p">,</span>
    <span class="mi">24891</span><span class="p">,</span>
    <span class="mi">24436</span><span class="p">,</span>
    <span class="mi">17776</span><span class="p">,</span>
    <span class="mi">36852</span><span class="p">,</span>
    <span class="mi">26891</span><span class="p">,</span>
    <span class="mi">17001</span><span class="p">,</span>
    <span class="mi">44414</span><span class="p">,</span>
    <span class="mi">23050</span><span class="p">,</span>
    <span class="mi">30884</span><span class="p">,</span>
    <span class="mi">41516</span><span class="p">,</span>
    <span class="mi">8897</span><span class="p">,</span>
    <span class="mi">34608</span><span class="p">,</span>
    <span class="mi">11721</span><span class="p">,</span>
    <span class="mi">13127</span><span class="p">,</span>
    <span class="mi">9870</span><span class="p">,</span>
    <span class="mi">39700</span><span class="p">,</span>
    <span class="mi">13985</span><span class="p">,</span>
    <span class="mi">9608</span><span class="p">,</span>
    <span class="mi">17808</span><span class="p">,</span>
    <span class="mi">23028</span><span class="p">,</span>
    <span class="mi">3494</span><span class="p">,</span>
    <span class="mi">10210</span><span class="p">,</span>
    <span class="mi">42384</span><span class="p">,</span>
    <span class="mi">31742</span><span class="p">,</span>
    <span class="mi">17100</span><span class="p">,</span>
    <span class="mi">46530</span><span class="p">,</span>
    <span class="mi">26733</span><span class="p">,</span>
    <span class="mi">4762</span><span class="p">,</span>
    <span class="mi">14113</span><span class="p">,</span>
    <span class="mi">20798</span><span class="p">,</span>
    <span class="mi">28388</span><span class="p">,</span>
    <span class="mi">42973</span><span class="p">,</span>
    <span class="mi">37347</span><span class="p">,</span>
    <span class="mi">55042</span><span class="p">,</span>
    <span class="mi">41295</span><span class="p">,</span>
    <span class="mi">28310</span><span class="p">,</span>
    <span class="mi">19280</span><span class="p">,</span>
    <span class="mi">18501</span><span class="p">,</span>
    <span class="mi">274</span><span class="p">,</span>
    <span class="mi">11208</span><span class="p">,</span>
    <span class="mi">13335</span><span class="p">,</span>
    <span class="mi">24440</span><span class="p">,</span>
    <span class="mi">49493</span><span class="p">,</span>
    <span class="mi">58129</span><span class="p">,</span>
    <span class="mi">56210</span><span class="p">,</span>
    <span class="mi">40766</span><span class="p">,</span>
    <span class="mi">13318</span><span class="p">,</span>
    <span class="mi">50040</span><span class="p">,</span>
    <span class="mi">18408</span><span class="p">,</span>
    <span class="mi">7255</span><span class="p">,</span>
    <span class="mi">15494</span><span class="p">,</span>
    <span class="mi">7168</span><span class="p">,</span>
    <span class="mi">9472</span><span class="p">,</span>
    <span class="mi">14845</span><span class="p">,</span>
    <span class="mi">14096</span><span class="p">,</span>
    <span class="mi">26072</span><span class="p">,</span>
    <span class="mi">35944</span><span class="p">,</span>
    <span class="mi">34836</span><span class="p">,</span>
    <span class="mi">12655</span><span class="p">,</span>
    <span class="mi">991</span><span class="p">,</span>
    <span class="mi">38577</span><span class="p">,</span>
    <span class="mi">47322</span><span class="p">,</span>
    <span class="mi">45212</span><span class="p">,</span>
    <span class="mi">16286</span><span class="p">,</span>
    <span class="mi">5308</span><span class="p">,</span>
    <span class="mi">38182</span><span class="p">,</span>
    <span class="mi">31624</span><span class="p">,</span>
    <span class="mi">12702</span><span class="p">,</span>
    <span class="mi">30861</span><span class="p">,</span>
    <span class="mi">46320</span><span class="p">,</span>
    <span class="mi">36408</span><span class="p">,</span>
    <span class="mi">49841</span><span class="p">,</span>
    <span class="mi">33426</span><span class="p">,</span>
    <span class="mi">57527</span><span class="p">,</span>
    <span class="mi">3273</span><span class="p">,</span>
    <span class="mi">24740</span><span class="p">,</span>
    <span class="mi">39627</span><span class="p">,</span>
    <span class="mi">22199</span><span class="p">,</span>
    <span class="mi">19362</span><span class="p">,</span>
    <span class="mi">42136</span><span class="p">,</span>
    <span class="mi">41965</span><span class="p">,</span>
    <span class="mi">43095</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">training_set_90</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">51348</span><span class="p">,</span>
    <span class="mi">49110</span><span class="p">,</span>
    <span class="mi">8222</span><span class="p">,</span>
    <span class="mi">28130</span><span class="p">,</span>
    <span class="mi">13484</span><span class="p">,</span>
    <span class="mi">47685</span><span class="p">,</span>
    <span class="mi">3938</span><span class="p">,</span>
    <span class="mi">59930</span><span class="p">,</span>
    <span class="mi">49196</span><span class="p">,</span>
    <span class="mi">19427</span><span class="p">,</span>
    <span class="mi">4601</span><span class="p">,</span>
    <span class="mi">49922</span><span class="p">,</span>
    <span class="mi">45635</span><span class="p">,</span>
    <span class="mi">35684</span><span class="p">,</span>
    <span class="mi">3579</span><span class="p">,</span>
    <span class="mi">7621</span><span class="p">,</span>
    <span class="mi">8465</span><span class="p">,</span>
    <span class="mi">33959</span><span class="p">,</span>
    <span class="mi">27521</span><span class="p">,</span>
    <span class="mi">27015</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">training_set_random</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">51348</span><span class="p">,</span>
    <span class="mi">49110</span><span class="p">,</span>
    <span class="mi">8222</span><span class="p">,</span>
    <span class="mi">28130</span><span class="p">,</span>
    <span class="mi">13484</span><span class="p">,</span>
    <span class="mi">47685</span><span class="p">,</span>
    <span class="mi">3938</span><span class="p">,</span>
    <span class="mi">59930</span><span class="p">,</span>
    <span class="mi">49196</span><span class="p">,</span>
    <span class="mi">19427</span><span class="p">,</span>
    <span class="mi">4601</span><span class="p">,</span>
    <span class="mi">49922</span><span class="p">,</span>
    <span class="mi">45635</span><span class="p">,</span>
    <span class="mi">35684</span><span class="p">,</span>
    <span class="mi">3579</span><span class="p">,</span>
    <span class="mi">7621</span><span class="p">,</span>
    <span class="mi">8465</span><span class="p">,</span>
    <span class="mi">33959</span><span class="p">,</span>
    <span class="mi">27521</span><span class="p">,</span>
    <span class="mi">27015</span><span class="p">,</span>
    <span class="mi">14546</span><span class="p">,</span>
    <span class="mi">56672</span><span class="p">,</span>
    <span class="mi">29175</span><span class="p">,</span>
    <span class="mi">34788</span><span class="p">,</span>
    <span class="mi">8131</span><span class="p">,</span>
    <span class="mi">26332</span><span class="p">,</span>
    <span class="mi">38192</span><span class="p">,</span>
    <span class="mi">21892</span><span class="p">,</span>
    <span class="mi">39029</span><span class="p">,</span>
    <span class="mi">38998</span><span class="p">,</span>
    <span class="mi">5055</span><span class="p">,</span>
    <span class="mi">59421</span><span class="p">,</span>
    <span class="mi">38657</span><span class="p">,</span>
    <span class="mi">56902</span><span class="p">,</span>
    <span class="mi">12450</span><span class="p">,</span>
    <span class="mi">24639</span><span class="p">,</span>
    <span class="mi">40834</span><span class="p">,</span>
    <span class="mi">49727</span><span class="p">,</span>
    <span class="mi">36103</span><span class="p">,</span>
    <span class="mi">9254</span><span class="p">,</span>
    <span class="mi">9245</span><span class="p">,</span>
    <span class="mi">58379</span><span class="p">,</span>
    <span class="mi">23120</span><span class="p">,</span>
    <span class="mi">33276</span><span class="p">,</span>
    <span class="mi">4809</span><span class="p">,</span>
    <span class="mi">1912</span><span class="p">,</span>
    <span class="mi">21893</span><span class="p">,</span>
    <span class="mi">40110</span><span class="p">,</span>
    <span class="mi">13327</span><span class="p">,</span>
    <span class="mi">12976</span><span class="p">,</span>
    <span class="mi">32620</span><span class="p">,</span>
    <span class="mi">33379</span><span class="p">,</span>
    <span class="mi">46791</span><span class="p">,</span>
    <span class="mi">54018</span><span class="p">,</span>
    <span class="mi">56012</span><span class="p">,</span>
    <span class="mi">14950</span><span class="p">,</span>
    <span class="mi">23198</span><span class="p">,</span>
    <span class="mi">23621</span><span class="p">,</span>
    <span class="mi">8800</span><span class="p">,</span>
    <span class="mi">13812</span><span class="p">,</span>
    <span class="mi">39580</span><span class="p">,</span>
    <span class="mi">51209</span><span class="p">,</span>
    <span class="mi">890</span><span class="p">,</span>
    <span class="mi">47684</span><span class="p">,</span>
    <span class="mi">52758</span><span class="p">,</span>
    <span class="mi">53629</span><span class="p">,</span>
    <span class="mi">1215</span><span class="p">,</span>
    <span class="mi">31729</span><span class="p">,</span>
    <span class="mi">24465</span><span class="p">,</span>
    <span class="mi">50917</span><span class="p">,</span>
    <span class="mi">48575</span><span class="p">,</span>
    <span class="mi">47113</span><span class="p">,</span>
    <span class="mi">20236</span><span class="p">,</span>
    <span class="mi">39311</span><span class="p">,</span>
    <span class="mi">25944</span><span class="p">,</span>
    <span class="mi">43811</span><span class="p">,</span>
    <span class="mi">37921</span><span class="p">,</span>
    <span class="mi">6902</span><span class="p">,</span>
    <span class="mi">321</span><span class="p">,</span>
    <span class="mi">49988</span><span class="p">,</span>
    <span class="mi">9436</span><span class="p">,</span>
    <span class="mi">33907</span><span class="p">,</span>
    <span class="mi">56920</span><span class="p">,</span>
    <span class="mi">13604</span><span class="p">,</span>
    <span class="mi">29309</span><span class="p">,</span>
    <span class="mi">14098</span><span class="p">,</span>
    <span class="mi">22260</span><span class="p">,</span>
    <span class="mi">40723</span><span class="p">,</span>
    <span class="mi">27635</span><span class="p">,</span>
    <span class="mi">36611</span><span class="p">,</span>
    <span class="mi">57194</span><span class="p">,</span>
    <span class="mi">44682</span><span class="p">,</span>
    <span class="mi">55813</span><span class="p">,</span>
    <span class="mi">29089</span><span class="p">,</span>
    <span class="mi">23673</span><span class="p">,</span>
    <span class="mi">55498</span><span class="p">,</span>
    <span class="mi">636</span><span class="p">,</span>
    <span class="mi">32250</span><span class="p">,</span>
    <span class="mi">33342</span><span class="p">,</span>
    <span class="mi">34457</span><span class="p">,</span>
<span class="p">]</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Experiment</span><span class="p">:</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1337</span>
    <span class="n">num_pool_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_validation_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_training_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_patience_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">max_training_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="mi">4</span>
    <span class="n">training_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span>
    <span class="n">validation_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">min_samples_per_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">model_optimizer_factory</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">ModelOptimizerFactory</span><span class="p">]</span> <span class="o">=</span> <span class="n">MnistOptimizerFactory</span>
    <span class="n">max_obi_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">num_samples_list</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">up_factor</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_trials</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">acquisition_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">random_acquisition</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">training_set_indices</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">):</span>
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;FastMNIST (train)&quot;</span>
        <span class="p">)</span>

        <span class="n">active_learning_data</span> <span class="o">=</span> <span class="n">ActiveLearningData</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>

        <span class="n">active_learning_data</span><span class="o">.</span><span class="n">acquire_base_indices</span><span class="p">(</span><span class="n">training_set_indices</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>

        <span class="n">active_learning_data_validation_set</span> <span class="o">=</span> <span class="n">ActiveLearningData</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>
        <span class="n">active_learning_data_validation_set</span><span class="o">.</span><span class="n">acquire_base_indices</span><span class="p">(</span><span class="n">training_set_indices</span><span class="p">)</span>

        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">active_learning_data_validation_set</span><span class="o">.</span><span class="n">extract_dataset_from_pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">validation_set_size</span><span class="p">)</span>
        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (validation, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">)</span>

        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (test, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">active_learning_data</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">training_set_indices</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

    <span class="c1"># Simple Dependency Injection</span>
    <span class="k">def</span> <span class="nf">create_train_eval_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime_config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainEvalModel</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="o">**</span><span class="n">runtime_config</span><span class="p">}</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">DependencyInjection</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="n">di</span><span class="o">.</span><span class="n">create_dataclass_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_eval_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">):</span>
        <span class="n">init_wandb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">training_set_indices</span> <span class="o">=</span> <span class="n">training_set_random</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_acquisition</span> <span class="k">else</span> <span class="n">training_set_90</span>

        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

        <span class="c1"># Active Learning setup</span>
        <span class="n">active_learning_data</span><span class="p">,</span> <span class="n">validation_dataset</span><span class="p">,</span> <span class="n">test_dataset</span><span class="p">,</span> <span class="n">initial_training_set_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="n">training_set_indices</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;initial_training_set_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_training_set_indices</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;dataset_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">training</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">base_dataset</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">wandb</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

        <span class="n">wandb</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">initial_training_set_indices</span> <span class="o">=</span> <span class="n">initial_training_set_indices</span>
        <span class="n">wandb</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;dataset_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;dataset_info&quot;</span><span class="p">]</span>

        <span class="c1"># initial_training_set_indices = active_learning_data.get_random_pool_indices(self.initial_set_size)</span>
        <span class="c1"># initial_training_set_indices = get_balanced_sample_indices(</span>
        <span class="c1">#     active_learning_data.pool_dataset, 10, self.initial_set_size // 10</span>
        <span class="c1"># )</span>

        <span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">training_batch_size</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">RandomFixedLengthSampler</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_samples_per_epoch</span><span class="p">),</span>
            <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">validation_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;obi_performances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">obi_performances</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;obi_performances&quot;</span><span class="p">]</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;obi_topk_ensemble_performances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">obi_topk_ensemble_performances</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;obi_topk_ensemble_performances&quot;</span><span class="p">]</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">active_learning_steps</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span>

        <span class="c1"># Active Training Loop</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">training_set_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training set size </span><span class="si">{</span><span class="n">training_set_size</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

            <span class="c1"># iteration_log = dict(training={}, pool_training={}, evaluation_metrics=None, acquisition=None)</span>
            <span class="n">active_learning_steps</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
            <span class="n">iteration_log</span> <span class="o">=</span> <span class="n">active_learning_steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">model_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer_factory</span><span class="p">()</span><span class="o">.</span><span class="n">create_model_optimizer</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">training_set_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">train</span><span class="p">(</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                    <span class="n">optimizer</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
                    <span class="n">training_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_training_samples</span><span class="p">,</span>
                    <span class="n">validation_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_validation_samples</span><span class="p">,</span>
                    <span class="n">train_loader</span><span class="o">=</span><span class="n">train_loader</span><span class="p">,</span>
                    <span class="n">validation_loader</span><span class="o">=</span><span class="n">validation_loader</span><span class="p">,</span>
                    <span class="n">patience</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_patience_epochs</span><span class="p">,</span>
                    <span class="n">max_epochs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_training_epochs</span><span class="p">,</span>
                    <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                    <span class="n">training_log</span><span class="o">=</span><span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">],</span>
                    <span class="n">wandb_key_path</span><span class="o">=</span><span class="s2">&quot;model_training&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">evaluation_metrics</span> <span class="o">=</span> <span class="n">evaluate_old</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">num_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_validation_samples</span><span class="p">,</span>
                <span class="n">loader</span><span class="o">=</span><span class="n">test_loader</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;evaluation_metrics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluation_metrics</span>
            <span class="n">log2wandb</span><span class="p">(</span><span class="n">evaluation_metrics</span><span class="p">,</span> <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perf after training </span><span class="si">{</span><span class="n">evaluation_metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">obi_results</span><span class="p">,</span> <span class="n">obi_topk_ensemble_results</span> <span class="o">=</span> <span class="n">evaluate_online_bayesian_inference</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">real_training_set_size</span><span class="o">=</span><span class="n">training_set_size</span><span class="p">,</span>
                <span class="n">train_dataset</span><span class="o">=</span><span class="n">active_learning_data</span><span class="o">.</span><span class="n">base_dataset</span><span class="p">,</span>
                <span class="n">test_dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span>
                <span class="n">training_indices</span><span class="o">=</span><span class="n">training_set_indices</span><span class="p">[:</span> <span class="n">training_set_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_obi_steps</span><span class="p">],</span>
                <span class="n">start_index</span><span class="o">=</span><span class="n">training_set_size</span><span class="p">,</span>
                <span class="n">num_samples_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_samples_list</span><span class="p">,</span>
                <span class="n">num_trials</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_trials</span><span class="p">,</span>
                <span class="n">up_factor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">up_factor</span><span class="p">,</span>
                <span class="n">eval_batchsize</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">obi_performances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obi_results</span><span class="p">)</span>
            <span class="n">obi_topk_ensemble_performances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obi_topk_ensemble_results</span><span class="p">)</span>
            <span class="n">log2wandb</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">obi_performances</span><span class="o">=</span><span class="p">[</span><span class="n">asclassdict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">obi_results</span><span class="p">],</span>
                    <span class="n">obi_topk_ensemble_results</span><span class="o">=</span><span class="p">[</span><span class="n">asclassdict</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">obi_topk_ensemble_results</span><span class="p">],</span>
                <span class="p">),</span>
                <span class="n">commit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">training_set_size</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set_indices</span><span class="p">):</span>
                <span class="n">log2wandb</span><span class="p">({},</span> <span class="n">commit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">next_indices</span> <span class="o">=</span> <span class="n">training_set_indices</span><span class="p">[</span><span class="n">training_set_size</span> <span class="p">:</span> <span class="n">training_set_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_size</span><span class="p">]</span>
            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;acquisition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">next_indices</span><span class="p">)</span>

            <span class="n">active_learning_data</span><span class="o">.</span><span class="n">acquire_base_indices</span><span class="p">(</span><span class="n">next_indices</span><span class="p">)</span>
            <span class="n">log2wandb</span><span class="p">({},</span> <span class="n">commit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1120</span><span class="p">,</span> <span class="n">num_pool_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span> <span class="n">num_samples_list</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">random_acquisition</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Finishing last run (ID:1edm6a18) before initializing another...
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Waiting for W&B process to finish... <strong style="color:green">(success).</strong>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>accuracy</td><td></td></tr><tr><td>crossentropy</td><td></td></tr><tr><td>model_training/best_epoch</td><td></td></tr><tr><td>model_training/best_val_accuracy</td><td></td></tr><tr><td>model_training/best_val_crossentropy</td><td></td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>accuracy</td><td>0.5981</td></tr><tr><td>crossentropy</td><td>1.69386</td></tr><tr><td>model_training/best_epoch</td><td>29</td></tr><tr><td>model_training/best_val_accuracy</td><td>0.60742</td></tr><tr><td>model_training/best_val_crossentropy</td><td>1.78939</td></tr></table><br/></div></div>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Synced <strong style="color:#cdcd00">wise-sound-1147</strong>: <a href="https://wandb.ai/oatml-andreas-kirsch/balds/runs/1edm6a18" target="_blank">https://wandb.ai/oatml-andreas-kirsch/balds/runs/1edm6a18</a><br/>Synced 7 W&B file(s), 1 media file(s), 1 artifact file(s) and 2 other file(s)
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find logs at: <code>./wandb/run-20220429_000603-1edm6a18/logs</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Successfully finished last run (ID:1edm6a18). Initializing new run:<br/>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
wandb version 0.12.15 is available!  To upgrade, please run:
 $ pip install wandb --upgrade
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Tracking run with wandb version 0.12.11
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Run data is saved locally in <code>/home/blackhc/PycharmProjects/bald-ical/wandb/run-20220429_000743-bqy71pvx</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Syncing run <strong><a href="https://wandb.ai/oatml-andreas-kirsch/balds/runs/bqy71pvx" target="_blank">pleasant-pond-1148</a></strong> to <a href="https://wandb.ai/oatml-andreas-kirsch/balds" target="_blank">Weights & Biases</a> (<a href="https://wandb.me/run" target="_blank">docs</a>)<br/>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{&#39;Dataclass&#39;: &#39;__main__.Experiment&#39;, &#39;seed&#39;: 1120, &#39;num_pool_samples&#39;: 100, &#39;num_validation_samples&#39;: 20, &#39;num_training_samples&#39;: 1, &#39;num_patience_epochs&#39;: 20, &#39;max_training_epochs&#39;: 120, &#39;training_batch_size&#39;: 64, &#39;device&#39;: &#39;cuda&#39;, &#39;validation_set_size&#39;: 1024, &#39;min_samples_per_epoch&#39;: 1024, &#39;model_optimizer_factory&#39;: &#39;batchbald_redux.models.MnistOptimizerFactory&#39;, &#39;max_obi_steps&#39;: 10, &#39;num_samples_list&#39;: [10, 100], &#39;up_factor&#39;: 2, &#39;num_trials&#39;: 5, &#39;acquisition_size&#39;: 5, &#39;random_acquisition&#39;: True}
Training set size 20:
Epoch metrics: {&#39;accuracy&#39;: 0.53125, &#39;crossentropy&#39;: 1.6860700845718384}
Epoch metrics: {&#39;accuracy&#39;: 0.578125, &#39;crossentropy&#39;: 1.403245449066162}
Epoch metrics: {&#39;accuracy&#39;: 0.57421875, &#39;crossentropy&#39;: 1.6297085285186768}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5771484375, &#39;crossentropy&#39;: 1.6736737489700317}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5869140625, &#39;crossentropy&#39;: 1.6601365804672241}
Epoch metrics: {&#39;accuracy&#39;: 0.5703125, &#39;crossentropy&#39;: 1.8642305135726929}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5986328125, &#39;crossentropy&#39;: 1.7198810577392578}
Epoch metrics: {&#39;accuracy&#39;: 0.5751953125, &#39;crossentropy&#39;: 1.7458257675170898}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5595703125, &#39;crossentropy&#39;: 1.8030117750167847}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5712890625, &#39;crossentropy&#39;: 1.8639084100723267}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.583984375, &#39;crossentropy&#39;: 1.7130600214004517}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5966796875, &#39;crossentropy&#39;: 1.7583857774734497}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5947265625, &#39;crossentropy&#39;: 1.8011263608932495}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.578125, &#39;crossentropy&#39;: 1.8280960321426392}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5791015625, &#39;crossentropy&#39;: 1.884833574295044}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5703125, &#39;crossentropy&#39;: 1.9384914636611938}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.564453125, &#39;crossentropy&#39;: 2.026677131652832}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.591796875, &#39;crossentropy&#39;: 1.798771858215332}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5830078125, &#39;crossentropy&#39;: 1.8671399354934692}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5791015625, &#39;crossentropy&#39;: 1.967775821685791}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5654296875, &#39;crossentropy&#39;: 1.9399442672729492}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.580078125, &#39;crossentropy&#39;: 1.9851447343826294}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.583984375, &#39;crossentropy&#39;: 1.8897390365600586}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.568359375, &#39;crossentropy&#39;: 1.7665351629257202}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.556640625, &#39;crossentropy&#39;: 1.844299077987671}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5751953125, &#39;crossentropy&#39;: 1.8201444149017334}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5947265625, &#39;crossentropy&#39;: 1.7643983364105225}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.5986328125)
RestoringEarlyStopping: Restoring optimizer.
{&#39;model_training/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f4dc004b460&gt;, &#39;model_training/best_epoch&#39;: 6, &#39;model_training/best_val_accuracy&#39;: 0.5986328125, &#39;model_training/best_val_crossentropy&#39;: 1.7198810577392578}
Perf after training {&#39;accuracy&#39;: 0.5962, &#39;crossentropy&#39;: 1.685489453125, &#39;_timestamp&#39;: 1651187288, &#39;_runtime&#39;: 20}
Training set size 25:
Epoch metrics: {&#39;accuracy&#39;: 0.4697265625, &#39;crossentropy&#39;: 1.8736950159072876}
Epoch metrics: {&#39;accuracy&#39;: 0.5732421875, &#39;crossentropy&#39;: 1.5384868383407593}
Epoch metrics: {&#39;accuracy&#39;: 0.58984375, &#39;crossentropy&#39;: 1.5438417196273804}
Epoch metrics: {&#39;accuracy&#39;: 0.6025390625, &#39;crossentropy&#39;: 1.4993747472763062}
Epoch metrics: {&#39;accuracy&#39;: 0.6142578125, &#39;crossentropy&#39;: 1.546315312385559}
Epoch metrics: {&#39;accuracy&#39;: 0.603515625, &#39;crossentropy&#39;: 1.6430463790893555}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.60546875, &#39;crossentropy&#39;: 1.6495801210403442}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6162109375, &#39;crossentropy&#39;: 1.6413298845291138}
Epoch metrics: {&#39;accuracy&#39;: 0.6123046875, &#39;crossentropy&#39;: 1.7124134302139282}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 1.6137335300445557}
Epoch metrics: {&#39;accuracy&#39;: 0.60546875, &#39;crossentropy&#39;: 1.7820192575454712}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.619140625, &#39;crossentropy&#39;: 1.6584652662277222}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6162109375, &#39;crossentropy&#39;: 1.8200035095214844}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.599609375, &#39;crossentropy&#39;: 1.9349629878997803}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.623046875, &#39;crossentropy&#39;: 1.8347406387329102}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.623046875, &#39;crossentropy&#39;: 1.6977647542953491}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6181640625, &#39;crossentropy&#39;: 1.7811791896820068}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6181640625, &#39;crossentropy&#39;: 1.8008760213851929}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6044921875, &#39;crossentropy&#39;: 1.799109697341919}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6240234375, &#39;crossentropy&#39;: 1.8306230306625366}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.615234375, &#39;crossentropy&#39;: 1.9417650699615479}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6142578125, &#39;crossentropy&#39;: 1.872727632522583}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.623046875, &#39;crossentropy&#39;: 1.802254557609558}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6044921875, &#39;crossentropy&#39;: 2.0551059246063232}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6005859375, &#39;crossentropy&#39;: 2.042090892791748}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.59375, &#39;crossentropy&#39;: 1.961662769317627}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5947265625, &#39;crossentropy&#39;: 1.9146138429641724}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6015625, &#39;crossentropy&#39;: 1.8821790218353271}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.59375, &#39;crossentropy&#39;: 2.0446882247924805}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.5908203125, &#39;crossentropy&#39;: 2.081068992614746}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.6318359375)
RestoringEarlyStopping: Restoring optimizer.
{&#39;model_training/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f4d8c6689a0&gt;, &#39;model_training/best_epoch&#39;: 9, &#39;model_training/best_val_accuracy&#39;: 0.6318359375, &#39;model_training/best_val_crossentropy&#39;: 1.6137335300445557}
Perf after training {&#39;accuracy&#39;: 0.6053, &#39;crossentropy&#39;: 1.6513515625, &#39;_timestamp&#39;: 1651187320, &#39;_runtime&#39;: 52}
Training set size 30:
Epoch metrics: {&#39;accuracy&#39;: 0.4833984375, &#39;crossentropy&#39;: 1.7939091920852661}
Epoch metrics: {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 1.3598222732543945}
Epoch metrics: {&#39;accuracy&#39;: 0.63671875, &#39;crossentropy&#39;: 1.2715601921081543}
Epoch metrics: {&#39;accuracy&#39;: 0.6357421875, &#39;crossentropy&#39;: 1.4956834316253662}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6474609375, &#39;crossentropy&#39;: 1.3535583019256592}
Epoch metrics: {&#39;accuracy&#39;: 0.640625, &#39;crossentropy&#39;: 1.4745161533355713}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.634765625, &#39;crossentropy&#39;: 1.5511658191680908}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6279296875, &#39;crossentropy&#39;: 1.675184726715088}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.630859375, &#39;crossentropy&#39;: 1.646170973777771}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6328125, &#39;crossentropy&#39;: 1.6516377925872803}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.640625, &#39;crossentropy&#39;: 1.606212854385376}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.638671875, &#39;crossentropy&#39;: 1.576488733291626}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6259765625, &#39;crossentropy&#39;: 1.8811843395233154}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.886958360671997}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.638671875, &#39;crossentropy&#39;: 1.863370418548584}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.62890625, &#39;crossentropy&#39;: 1.8208427429199219}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.646484375, &#39;crossentropy&#39;: 1.6873459815979004}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.642578125, &#39;crossentropy&#39;: 1.7016938924789429}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.638671875, &#39;crossentropy&#39;: 1.8637508153915405}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6337890625, &#39;crossentropy&#39;: 1.780155062675476}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.7387900352478027}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 1.8353168964385986}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.638671875, &#39;crossentropy&#39;: 2.0483360290527344}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6357421875, &#39;crossentropy&#39;: 1.9495981931686401}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.638671875, &#39;crossentropy&#39;: 1.749145746231079}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.6474609375)
RestoringEarlyStopping: Restoring optimizer.
{&#39;model_training/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f4d8c4de520&gt;, &#39;model_training/best_epoch&#39;: 4, &#39;model_training/best_val_accuracy&#39;: 0.6474609375, &#39;model_training/best_val_crossentropy&#39;: 1.3535583019256592}
Perf after training {&#39;accuracy&#39;: 0.6322, &#39;crossentropy&#39;: 1.4178912109375, &#39;_timestamp&#39;: 1651187348, &#39;_runtime&#39;: 80}
Training set size 35:
Epoch metrics: {&#39;accuracy&#39;: 0.3642578125, &#39;crossentropy&#39;: 1.9549784660339355}
Epoch metrics: {&#39;accuracy&#39;: 0.6015625, &#39;crossentropy&#39;: 1.375648856163025}
Epoch metrics: {&#39;accuracy&#39;: 0.6259765625, &#39;crossentropy&#39;: 1.3033690452575684}
Epoch metrics: {&#39;accuracy&#39;: 0.6220703125, &#39;crossentropy&#39;: 1.4706107378005981}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6474609375, &#39;crossentropy&#39;: 1.4281833171844482}
Epoch metrics: {&#39;accuracy&#39;: 0.646484375, &#39;crossentropy&#39;: 1.4908554553985596}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6591796875, &#39;crossentropy&#39;: 1.466894268989563}
Epoch metrics: {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 1.6962484121322632}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6552734375, &#39;crossentropy&#39;: 1.5402953624725342}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.63671875, &#39;crossentropy&#39;: 1.6579644680023193}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6328125, &#39;crossentropy&#39;: 1.7331483364105225}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6337890625, &#39;crossentropy&#39;: 1.6831144094467163}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6279296875, &#39;crossentropy&#39;: 1.7526617050170898}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.626953125, &#39;crossentropy&#39;: 1.7761213779449463}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.6970536708831787}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6396484375, &#39;crossentropy&#39;: 1.6380906105041504}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.7314889430999756}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.63671875, &#39;crossentropy&#39;: 1.7219301462173462}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 1.6900439262390137}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.646484375, &#39;crossentropy&#39;: 1.6780420541763306}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.638671875, &#39;crossentropy&#39;: 1.7592166662216187}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 1.6724780797958374}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6357421875, &#39;crossentropy&#39;: 1.7193139791488647}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.7677066326141357}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6376953125, &#39;crossentropy&#39;: 1.6754975318908691}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.64453125, &#39;crossentropy&#39;: 1.7246756553649902}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6455078125, &#39;crossentropy&#39;: 1.6523017883300781}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.6591796875)
RestoringEarlyStopping: Restoring optimizer.
{&#39;model_training/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f4d8c34f4c0&gt;, &#39;model_training/best_epoch&#39;: 6, &#39;model_training/best_val_accuracy&#39;: 0.6591796875, &#39;model_training/best_val_crossentropy&#39;: 1.466894268989563}
Perf after training {&#39;accuracy&#39;: 0.6465, &#39;crossentropy&#39;: 1.47599228515625, &#39;_timestamp&#39;: 1651187378, &#39;_runtime&#39;: 110}
Training set size 40:
Epoch metrics: {&#39;accuracy&#39;: 0.5361328125, &#39;crossentropy&#39;: 1.92691969871521}
Epoch metrics: {&#39;accuracy&#39;: 0.642578125, &#39;crossentropy&#39;: 1.2635858058929443}
Epoch metrics: {&#39;accuracy&#39;: 0.7001953125, &#39;crossentropy&#39;: 1.0416051149368286}
Epoch metrics: {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 1.2102819681167603}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.69921875, &#39;crossentropy&#39;: 1.1185848712921143}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6923828125, &#39;crossentropy&#39;: 1.154073715209961}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6982421875, &#39;crossentropy&#39;: 1.2469472885131836}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7109375, &#39;crossentropy&#39;: 1.2077317237854004}
Epoch metrics: {&#39;accuracy&#39;: 0.69140625, &#39;crossentropy&#39;: 1.256813645362854}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6806640625, &#39;crossentropy&#39;: 1.3001667261123657}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6875, &#39;crossentropy&#39;: 1.2882323265075684}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6875, &#39;crossentropy&#39;: 1.3296780586242676}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7236328125, &#39;crossentropy&#39;: 1.1155086755752563}
Epoch metrics: {&#39;accuracy&#39;: 0.70703125, &#39;crossentropy&#39;: 1.1215099096298218}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.6923828125, &#39;crossentropy&#39;: 1.3070564270019531}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 1.3424241542816162}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 1.2745146751403809}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.724609375, &#39;crossentropy&#39;: 1.2535779476165771}
Epoch metrics: {&#39;accuracy&#39;: 0.6982421875, &#39;crossentropy&#39;: 1.2466461658477783}
RestoringEarlyStopping: 1 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 1.298054575920105}
RestoringEarlyStopping: 2 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7177734375, &#39;crossentropy&#39;: 1.2564595937728882}
RestoringEarlyStopping: 3 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 1.1964534521102905}
RestoringEarlyStopping: 4 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 1.2139276266098022}
RestoringEarlyStopping: 5 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 1.248416543006897}
RestoringEarlyStopping: 6 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.712890625, &#39;crossentropy&#39;: 1.3274636268615723}
RestoringEarlyStopping: 7 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 1.3250964879989624}
RestoringEarlyStopping: 8 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.720703125, &#39;crossentropy&#39;: 1.3411786556243896}
RestoringEarlyStopping: 9 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.708984375, &#39;crossentropy&#39;: 1.400192379951477}
RestoringEarlyStopping: 10 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7041015625, &#39;crossentropy&#39;: 1.4479238986968994}
RestoringEarlyStopping: 11 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7119140625, &#39;crossentropy&#39;: 1.277262568473816}
RestoringEarlyStopping: 12 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.708984375, &#39;crossentropy&#39;: 1.358046531677246}
RestoringEarlyStopping: 13 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 1.4503519535064697}
RestoringEarlyStopping: 14 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.71875, &#39;crossentropy&#39;: 1.342147946357727}
RestoringEarlyStopping: 15 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7197265625, &#39;crossentropy&#39;: 1.2747952938079834}
RestoringEarlyStopping: 16 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7080078125, &#39;crossentropy&#39;: 1.4223017692565918}
RestoringEarlyStopping: 17 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7158203125, &#39;crossentropy&#39;: 1.2920024394989014}
RestoringEarlyStopping: 18 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.716796875, &#39;crossentropy&#39;: 1.279114842414856}
RestoringEarlyStopping: 19 / 20
Epoch metrics: {&#39;accuracy&#39;: 0.7060546875, &#39;crossentropy&#39;: 1.3292289972305298}
RestoringEarlyStopping: 20 / 20
RestoringEarlyStopping: Out of patience
RestoringEarlyStopping: Restoring best parameters. (Score: 0.724609375)
RestoringEarlyStopping: Restoring optimizer.
{&#39;model_training/val_metrics&#39;: &lt;wandb.data_types.Table object at 0x7f4d8c152460&gt;, &#39;model_training/best_epoch&#39;: 17, &#39;model_training/best_val_accuracy&#39;: 0.724609375, &#39;model_training/best_val_crossentropy&#39;: 1.2535779476165771}
Perf after training {&#39;accuracy&#39;: 0.7121, &#39;crossentropy&#39;: 1.22771279296875, &#39;_timestamp&#39;: 1651187413, &#39;_runtime&#39;: 145}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-19-d6b98c690543&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> 
<span class="ansi-green-intense-fg ansi-bold">      5</span> results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">}</span>
<span class="ansi-green-fg">----&gt; 6</span><span class="ansi-red-fg"> </span>experiment<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>results<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-17-514dc4e0fe0e&gt;</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self, store)</span>
<span class="ansi-green-intense-fg ansi-bold">    360</span>             print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#34;Perf after training {evaluation_metrics}&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    361</span> 
<span class="ansi-green-fg">--&gt; 362</span><span class="ansi-red-fg">             obi_results, obi_topk_ensemble_results = evaluate_online_bayesian_inference(
</span><span class="ansi-green-intense-fg ansi-bold">    363</span>                 model<span class="ansi-blue-fg">=</span>model_optimizer<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    364</span>                 real_training_set_size<span class="ansi-blue-fg">=</span>training_set_size<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/online_bayesian_inference.py</span> in <span class="ansi-cyan-fg">evaluate_online_bayesian_inference</span><span class="ansi-blue-fg">(model, real_training_set_size, train_dataset, test_dataset, training_indices, start_index, num_samples_list, num_trials, up_factor, eval_batchsize, device)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span>                                        num_trials<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     34</span>                                        up_factor: int, eval_batchsize: int, device) -&gt; List[OBIPerformance]:
<span class="ansi-green-fg">---&gt; 35</span><span class="ansi-red-fg">     log_probs_N_M_C, labels_N = get_obi_predictions_labels(model, test_dataset=test_dataset,
</span><span class="ansi-green-intense-fg ansi-bold">     36</span>                                                            train_dataset<span class="ansi-blue-fg">=</span>train_dataset<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     37</span>                                                            training_indices<span class="ansi-blue-fg">=</span>training_indices<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/online_bayesian_inference.py</span> in <span class="ansi-cyan-fg">get_obi_predictions_labels</span><span class="ansi-blue-fg">(model, test_dataset, train_dataset, training_indices, num_samples, eval_batchsize, device)</span>
<span class="ansi-green-intense-fg ansi-bold">     73</span>         joint_set<span class="ansi-blue-fg">,</span> batch_size<span class="ansi-blue-fg">=</span>eval_batchsize<span class="ansi-blue-fg">,</span> drop_last<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">     74</span>     )
<span class="ansi-green-fg">---&gt; 75</span><span class="ansi-red-fg">     log_probs_N_M_C, labels_N = model.get_predictions_labels(num_samples=num_samples, loader=joint_loader,
</span><span class="ansi-green-intense-fg ansi-bold">     76</span>                                                              device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">     77</span>                                                              storage_device=&#34;cpu&#34;)

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/consistent_mc_dropout.py</span> in <span class="ansi-cyan-fg">get_predictions_labels</span><span class="ansi-blue-fg">(self, num_samples, loader, device, storage_device)</span>
<span class="ansi-green-intense-fg ansi-bold">    147</span>         self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">,</span> num_samples<span class="ansi-blue-fg">:</span> int<span class="ansi-blue-fg">,</span> loader<span class="ansi-blue-fg">:</span> data<span class="ansi-blue-fg">.</span>DataLoader<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">,</span> storage_device
<span class="ansi-green-intense-fg ansi-bold">    148</span>     ):
<span class="ansi-green-fg">--&gt; 149</span><span class="ansi-red-fg">         return bmodule_get_predictions_labels(
</span><span class="ansi-green-intense-fg ansi-bold">    150</span>             self<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span>             num_samples<span class="ansi-blue-fg">=</span>num_samples<span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/autograd/grad_mode.py</span> in <span class="ansi-cyan-fg">decorate_context</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span>         <span class="ansi-green-fg">def</span> decorate_context<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span>             <span class="ansi-green-fg">with</span> self<span class="ansi-blue-fg">.</span>__class__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 28</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     29</span>         <span class="ansi-green-fg">return</span> cast<span class="ansi-blue-fg">(</span>F<span class="ansi-blue-fg">,</span> decorate_context<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span> 

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/consistent_mc_dropout.py</span> in <span class="ansi-cyan-fg">bmodule_get_predictions_labels</span><span class="ansi-blue-fg">(self, num_samples, loader, device, storage_device)</span>
<span class="ansi-green-intense-fg ansi-bold">    391</span> 
<span class="ansi-green-intense-fg ansi-bold">    392</span>     <span class="ansi-blue-fg">@</span>toma<span class="ansi-blue-fg">.</span>execute<span class="ansi-blue-fg">.</span>range<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> num_samples<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">128</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 393</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">def</span> get_prediction_batch<span class="ansi-blue-fg">(</span>start<span class="ansi-blue-fg">,</span> end<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    394</span>         <span class="ansi-green-fg">nonlocal</span> predictions
<span class="ansi-green-intense-fg ansi-bold">    395</span>         <span class="ansi-green-fg">nonlocal</span> labels

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/toma/__init__.py</span> in <span class="ansi-cyan-fg">execute_range</span><span class="ansi-blue-fg">(func)</span>
<span class="ansi-green-intense-fg ansi-bold">    184</span> 
<span class="ansi-green-intense-fg ansi-bold">    185</span>             <span class="ansi-green-fg">def</span> execute_range<span class="ansi-blue-fg">(</span>func<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 186</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> explicit<span class="ansi-blue-fg">.</span>range<span class="ansi-blue-fg">(</span>func<span class="ansi-blue-fg">,</span> start<span class="ansi-blue-fg">,</span> end<span class="ansi-blue-fg">,</span> initial_step<span class="ansi-blue-fg">,</span> toma_cache_type<span class="ansi-blue-fg">=</span>cache_type<span class="ansi-blue-fg">,</span> toma_context<span class="ansi-blue-fg">=</span>context<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    187</span> 
<span class="ansi-green-intense-fg ansi-bold">    188</span>             <span class="ansi-green-fg">return</span> execute_range

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/toma/__init__.py</span> in <span class="ansi-cyan-fg">range</span><span class="ansi-blue-fg">(func, start, end, initial_step, toma_context, toma_cache_type, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    267</span>         <span class="ansi-green-fg">while</span> current <span class="ansi-blue-fg">&lt;</span> end<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    268</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 269</span><span class="ansi-red-fg">                 </span>func<span class="ansi-blue-fg">(</span>current<span class="ansi-blue-fg">,</span> min<span class="ansi-blue-fg">(</span>current <span class="ansi-blue-fg">+</span> batchsize<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> end<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    270</span>                 current <span class="ansi-blue-fg">+=</span> batchsize<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    271</span>                 gc_cuda<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/consistent_mc_dropout.py</span> in <span class="ansi-cyan-fg">get_prediction_batch</span><span class="ansi-blue-fg">(start, end)</span>
<span class="ansi-green-intense-fg ansi-bold">    405</span> 
<span class="ansi-green-intense-fg ansi-bold">    406</span>         data_start <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">0</span>
<span class="ansi-green-fg">--&gt; 407</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">for</span> batch_x<span class="ansi-blue-fg">,</span> batch_labels <span class="ansi-green-fg">in</span> loader<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    408</span>             batch_x <span class="ansi-blue-fg">=</span> batch_x<span class="ansi-blue-fg">.</span>to<span class="ansi-blue-fg">(</span>device<span class="ansi-blue-fg">=</span>device<span class="ansi-blue-fg">,</span> non_blocking<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    409</span>             batch_predictions <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">(</span>batch_x<span class="ansi-blue-fg">,</span> num_sub_samples<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/utils/data/dataloader.py</span> in <span class="ansi-cyan-fg">__next__</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    519</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_sampler_iter <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    520</span>                 self<span class="ansi-blue-fg">.</span>_reset<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 521</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_next_data<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    522</span>             self<span class="ansi-blue-fg">.</span>_num_yielded <span class="ansi-blue-fg">+=</span> <span class="ansi-cyan-fg">1</span>
<span class="ansi-green-intense-fg ansi-bold">    523</span>             <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_dataset_kind <span class="ansi-blue-fg">==</span> _DatasetKind<span class="ansi-blue-fg">.</span>Iterable <span class="ansi-green-fg">and</span><span class="ansi-red-fg"> </span><span class="ansi-red-fg">\</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/utils/data/dataloader.py</span> in <span class="ansi-cyan-fg">_next_data</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    559</span>     <span class="ansi-green-fg">def</span> _next_data<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    560</span>         index <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_next_index<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># may raise StopIteration</span>
<span class="ansi-green-fg">--&gt; 561</span><span class="ansi-red-fg">         </span>data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_dataset_fetcher<span class="ansi-blue-fg">.</span>fetch<span class="ansi-blue-fg">(</span>index<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># may raise StopIteration</span>
<span class="ansi-green-intense-fg ansi-bold">    562</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_pin_memory<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    563</span>             data <span class="ansi-blue-fg">=</span> _utils<span class="ansi-blue-fg">.</span>pin_memory<span class="ansi-blue-fg">.</span>pin_memory<span class="ansi-blue-fg">(</span>data<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py</span> in <span class="ansi-cyan-fg">fetch</span><span class="ansi-blue-fg">(self, possibly_batched_index)</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>     <span class="ansi-green-fg">def</span> fetch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> possibly_batched_index<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     48</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>auto_collation<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 49</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">[</span>idx<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> idx <span class="ansi-green-fg">in</span> possibly_batched_index<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     50</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     51</span>             data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">[</span>possibly_batched_index<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py</span> in <span class="ansi-cyan-fg">&lt;listcomp&gt;</span><span class="ansi-blue-fg">(.0)</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>     <span class="ansi-green-fg">def</span> fetch<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> possibly_batched_index<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     48</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>auto_collation<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 49</span><span class="ansi-red-fg">             </span>data <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">[</span>idx<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> idx <span class="ansi-green-fg">in</span> possibly_batched_index<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     50</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     51</span>             data <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">[</span>possibly_batched_index<span class="ansi-blue-fg">]</span>

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/dataset_challenges.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, idx)</span>
<span class="ansi-green-intense-fg ansi-bold">     51</span> 
<span class="ansi-green-intense-fg ansi-bold">     52</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 53</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">[</span>idx<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     54</span> 
<span class="ansi-green-intense-fg ansi-bold">     55</span>     <span class="ansi-green-fg">def</span> __len__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/utils/data/dataset.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, idx)</span>
<span class="ansi-green-intense-fg ansi-bold">    306</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    307</span>             sample_idx <span class="ansi-blue-fg">=</span> idx <span class="ansi-blue-fg">-</span> self<span class="ansi-blue-fg">.</span>cumulative_sizes<span class="ansi-blue-fg">[</span>dataset_idx <span class="ansi-blue-fg">-</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">--&gt; 308</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>datasets<span class="ansi-blue-fg">[</span>dataset_idx<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span>sample_idx<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    309</span> 
<span class="ansi-green-intense-fg ansi-bold">    310</span>     <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/dataset_challenges.py</span> in <span class="ansi-cyan-fg">__getitem__</span><span class="ansi-blue-fg">(self, idx)</span>
<span class="ansi-green-intense-fg ansi-bold">     51</span> 
<span class="ansi-green-intense-fg ansi-bold">     52</span>     <span class="ansi-green-fg">def</span> __getitem__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> idx<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 53</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>dataset<span class="ansi-blue-fg">[</span>idx<span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">     54</span> 
<span class="ansi-green-intense-fg ansi-bold">     55</span>     <span class="ansi-green-fg">def</span> __len__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;initial_training_set_indices&#39;: [51348,
  49110,
  8222,
  28130,
  13484,
  47685,
  3938,
  59930,
  49196,
  19427,
  4601,
  49922,
  45635,
  35684,
  3579,
  7621,
  8465,
  33959,
  27521,
  27015],
 &#39;dataset_info&#39;: {&#39;training&#39;: &#34;&#39;FastMNIST (train)&#39;&#34;,
  &#39;test&#39;: &#34;&#39;FastMNIST (test, 10000 samples)&#39;&#34;},
 &#39;obi_performances&#39;: [[OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=0, num_samples=10, accuracy=0.538100004196167, crossentropy=1.516221893453387),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=1, num_samples=10, accuracy=0.5690000057220459, crossentropy=1.394369463295061),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=2, num_samples=10, accuracy=0.578000009059906, crossentropy=1.4390312500523),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=3, num_samples=10, accuracy=0.5702999830245972, crossentropy=1.3985775331252561),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=4, num_samples=10, accuracy=0.5687000155448914, crossentropy=1.4096811979439918),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=0, num_samples=100, accuracy=0.589900016784668, crossentropy=1.335559089110711),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=1, num_samples=100, accuracy=0.5927000045776367, crossentropy=1.3349937885306855),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=2, num_samples=100, accuracy=0.5892999768257141, crossentropy=1.3305602299056785),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=3, num_samples=100, accuracy=0.5884000062942505, crossentropy=1.326474675328213),
   OBIPerformance(total_training_set_size=20, real_training_set_size=20, online_training_set_size=0, trial_index=4, num_samples=100, accuracy=0.5889999866485596, crossentropy=1.327846993107089),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=0, num_samples=10, accuracy=0.5108000040054321, crossentropy=1.4310323746858784),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=1, num_samples=10, accuracy=0.5382999777793884, crossentropy=1.4689672375465028),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=2, num_samples=10, accuracy=0.5706999897956848, crossentropy=1.3674014090958952),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=3, num_samples=10, accuracy=0.4722999930381775, crossentropy=1.7070471526844717),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=4, num_samples=10, accuracy=0.4941999912261963, crossentropy=1.5801827079626178),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=0, num_samples=100, accuracy=0.555899977684021, crossentropy=1.3692344624259745),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=1, num_samples=100, accuracy=0.5461999773979187, crossentropy=1.3893260465550705),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=2, num_samples=100, accuracy=0.5467000007629395, crossentropy=1.4121668238064042),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=3, num_samples=100, accuracy=0.5705000162124634, crossentropy=1.340967229007888),
   OBIPerformance(total_training_set_size=21, real_training_set_size=20, online_training_set_size=1, trial_index=4, num_samples=100, accuracy=0.5415999889373779, crossentropy=1.3909245617626436),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=0, num_samples=10, accuracy=0.4828000068664551, crossentropy=1.640097319819771),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=1, num_samples=10, accuracy=0.383899986743927, crossentropy=1.998316493829286),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=2, num_samples=10, accuracy=0.5619000196456909, crossentropy=1.3614083629595173),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=3, num_samples=10, accuracy=0.5605999827384949, crossentropy=1.5468709941090097),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=4, num_samples=10, accuracy=0.4586000144481659, crossentropy=1.5487413009570614),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=0, num_samples=100, accuracy=0.5400999784469604, crossentropy=1.4679958268059266),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=1, num_samples=100, accuracy=0.5325000286102295, crossentropy=1.4296249512044592),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=2, num_samples=100, accuracy=0.5491999983787537, crossentropy=1.4132995300598465),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=3, num_samples=100, accuracy=0.5425000190734863, crossentropy=1.4154437291381885),
   OBIPerformance(total_training_set_size=22, real_training_set_size=20, online_training_set_size=2, trial_index=4, num_samples=100, accuracy=0.5428000092506409, crossentropy=1.4202467605273033),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=0, num_samples=10, accuracy=0.46540001034736633, crossentropy=1.6941649669171794),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=1, num_samples=10, accuracy=0.5766000151634216, crossentropy=1.33491877038404),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=2, num_samples=10, accuracy=0.42559999227523804, crossentropy=1.9941827284583042),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=3, num_samples=10, accuracy=0.4498000144958496, crossentropy=1.9126078195619989),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=4, num_samples=10, accuracy=0.48429998755455017, crossentropy=1.5444571334279291),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=0, num_samples=100, accuracy=0.5055000185966492, crossentropy=1.4592617706394788),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=1, num_samples=100, accuracy=0.5791000127792358, crossentropy=1.3435869851745037),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=2, num_samples=100, accuracy=0.5246000289916992, crossentropy=1.4374560238386542),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=3, num_samples=100, accuracy=0.5454000234603882, crossentropy=1.4060078429477834),
   OBIPerformance(total_training_set_size=23, real_training_set_size=20, online_training_set_size=3, trial_index=4, num_samples=100, accuracy=0.507099986076355, crossentropy=1.4585205344874193),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=0, num_samples=10, accuracy=0.492000013589859, crossentropy=1.5434660181821085),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=1, num_samples=10, accuracy=0.5871000289916992, crossentropy=1.3112769217945621),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=2, num_samples=10, accuracy=0.5235000252723694, crossentropy=1.550065473856313),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=3, num_samples=10, accuracy=0.43810001015663147, crossentropy=1.6212727767219297),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=4, num_samples=10, accuracy=0.538100004196167, crossentropy=1.4224725189917262),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=0, num_samples=100, accuracy=0.5842000246047974, crossentropy=1.335075112353193),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=1, num_samples=100, accuracy=0.5770999789237976, crossentropy=1.4018046512510478),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=2, num_samples=100, accuracy=0.5723000168800354, crossentropy=1.4060498496145326),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=3, num_samples=100, accuracy=0.5763999819755554, crossentropy=1.3260788603580833),
   OBIPerformance(total_training_set_size=24, real_training_set_size=20, online_training_set_size=4, trial_index=4, num_samples=100, accuracy=0.6014000177383423, crossentropy=1.3545435081220982),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=0, num_samples=10, accuracy=0.4230000078678131, crossentropy=1.7063899486848353),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=1, num_samples=10, accuracy=0.4413999915122986, crossentropy=1.8784460713362507),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=2, num_samples=10, accuracy=0.4537999927997589, crossentropy=1.5809112179319735),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=3, num_samples=10, accuracy=0.4115999937057495, crossentropy=1.7492424631097518),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=4, num_samples=10, accuracy=0.5099999904632568, crossentropy=1.6358352208201898),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=0, num_samples=100, accuracy=0.4876999855041504, crossentropy=1.5200327706793209),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=1, num_samples=100, accuracy=0.567300021648407, crossentropy=1.4114834289959146),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=2, num_samples=100, accuracy=0.490200012922287, crossentropy=1.521271881289261),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=3, num_samples=100, accuracy=0.4586000144481659, crossentropy=1.571481322419214),
   OBIPerformance(total_training_set_size=25, real_training_set_size=20, online_training_set_size=5, trial_index=4, num_samples=100, accuracy=0.5403000116348267, crossentropy=1.4178464957416665),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=0, num_samples=10, accuracy=0.5253000259399414, crossentropy=1.4747099626123017),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=1, num_samples=10, accuracy=0.48399999737739563, crossentropy=1.554101437140076),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=2, num_samples=10, accuracy=0.4194999933242798, crossentropy=1.7205025649786614),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=3, num_samples=10, accuracy=0.44119998812675476, crossentropy=1.6098627574521018),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=4, num_samples=10, accuracy=0.5285000205039978, crossentropy=1.434040272415036),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=0, num_samples=100, accuracy=0.5637000203132629, crossentropy=1.4240856171016043),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=1, num_samples=100, accuracy=0.5626999735832214, crossentropy=1.417474933965884),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=2, num_samples=100, accuracy=0.5612000226974487, crossentropy=1.385929869604441),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=3, num_samples=100, accuracy=0.5623999834060669, crossentropy=1.4224550458626617),
   OBIPerformance(total_training_set_size=26, real_training_set_size=20, online_training_set_size=6, trial_index=4, num_samples=100, accuracy=0.5658000111579895, crossentropy=1.3812882008355278),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=0, num_samples=10, accuracy=0.5289999842643738, crossentropy=1.5204433397631762),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=1, num_samples=10, accuracy=0.427700012922287, crossentropy=1.698829331811973),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=2, num_samples=10, accuracy=0.5514000058174133, crossentropy=1.4818146365081875),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=3, num_samples=10, accuracy=0.46369999647140503, crossentropy=1.5850571383495478),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=4, num_samples=10, accuracy=0.43860000371932983, crossentropy=1.6193627475884438),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=0, num_samples=100, accuracy=0.48910000920295715, crossentropy=1.5199999125600345),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=1, num_samples=100, accuracy=0.48980000615119934, crossentropy=1.519081176457409),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=2, num_samples=100, accuracy=0.48590001463890076, crossentropy=1.529872042842119),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=3, num_samples=100, accuracy=0.5598000288009644, crossentropy=1.4015750651377823),
   OBIPerformance(total_training_set_size=27, real_training_set_size=20, online_training_set_size=7, trial_index=4, num_samples=100, accuracy=0.47540000081062317, crossentropy=1.5675185960155897),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=0, num_samples=10, accuracy=0.4433000087738037, crossentropy=1.6035994605316592),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=1, num_samples=10, accuracy=0.5253000259399414, crossentropy=1.4747343085858566),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=2, num_samples=10, accuracy=0.5228999853134155, crossentropy=1.7230733964234788),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=3, num_samples=10, accuracy=0.4957999885082245, crossentropy=1.7042442318957434),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=4, num_samples=10, accuracy=0.5604000091552734, crossentropy=1.6179471884154344),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=0, num_samples=100, accuracy=0.4406999945640564, crossentropy=1.6138038182093437),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=1, num_samples=100, accuracy=0.4952999949455261, crossentropy=1.5516442793194338),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=2, num_samples=100, accuracy=0.4147000014781952, crossentropy=1.73651682346683),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=3, num_samples=100, accuracy=0.4772999882698059, crossentropy=1.556860853399344),
   OBIPerformance(total_training_set_size=28, real_training_set_size=20, online_training_set_size=8, trial_index=4, num_samples=100, accuracy=0.4749999940395355, crossentropy=1.560255091366018),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=0, num_samples=10, accuracy=0.5460000038146973, crossentropy=1.5457934192441967),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=1, num_samples=10, accuracy=0.546500027179718, crossentropy=1.527443198214064),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=2, num_samples=10, accuracy=0.5333999991416931, crossentropy=1.4619989457136748),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=3, num_samples=10, accuracy=0.524399995803833, crossentropy=1.4459335009817293),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=4, num_samples=10, accuracy=0.5178999900817871, crossentropy=1.514726970924966),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=0, num_samples=100, accuracy=0.43959999084472656, crossentropy=1.6169641866016042),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=1, num_samples=100, accuracy=0.44190001487731934, crossentropy=1.6108624702045151),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=2, num_samples=100, accuracy=0.48399999737739563, crossentropy=1.5596720207710035),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=3, num_samples=100, accuracy=0.43950000405311584, crossentropy=1.6168463713939287),
   OBIPerformance(total_training_set_size=29, real_training_set_size=20, online_training_set_size=9, trial_index=4, num_samples=100, accuracy=0.5526000261306763, crossentropy=1.422336710444493),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=0, num_samples=10, accuracy=0.5146999955177307, crossentropy=1.59071577353385),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=1, num_samples=10, accuracy=0.48330000042915344, crossentropy=1.5600168334171838),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=2, num_samples=10, accuracy=0.5587000250816345, crossentropy=1.3704955509548913),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=3, num_samples=10, accuracy=0.4675000011920929, crossentropy=1.6099594739354792),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=4, num_samples=10, accuracy=0.43799999356269836, crossentropy=1.621819811882544),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=0, num_samples=100, accuracy=0.5471000075340271, crossentropy=1.4569512473178925),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=1, num_samples=100, accuracy=0.5024999976158142, crossentropy=1.5201764815928764),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=2, num_samples=100, accuracy=0.4814999997615814, crossentropy=1.523882362156875),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=3, num_samples=100, accuracy=0.4916999936103821, crossentropy=1.5245047330435468),
   OBIPerformance(total_training_set_size=30, real_training_set_size=20, online_training_set_size=10, trial_index=4, num_samples=100, accuracy=0.4390999972820282, crossentropy=1.6182969328551637)],
  [OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=0, num_samples=10, accuracy=0.6100999712944031, crossentropy=1.6376072416808467),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=1, num_samples=10, accuracy=0.6097999811172485, crossentropy=1.615296419706585),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=2, num_samples=10, accuracy=0.5914000272750854, crossentropy=1.9317943811467426),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=3, num_samples=10, accuracy=0.6015999913215637, crossentropy=1.4375807893623322),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=4, num_samples=10, accuracy=0.6104000210762024, crossentropy=1.8309441336785284),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=0, num_samples=100, accuracy=0.6100999712944031, crossentropy=1.5381897910683175),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=1, num_samples=100, accuracy=0.6074000000953674, crossentropy=1.5889133845215737),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=2, num_samples=100, accuracy=0.6078000068664551, crossentropy=1.5115162383650613),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=3, num_samples=100, accuracy=0.6104000210762024, crossentropy=1.5038056689931252),
   OBIPerformance(total_training_set_size=25, real_training_set_size=25, online_training_set_size=0, trial_index=4, num_samples=100, accuracy=0.6118000149726868, crossentropy=1.5320206094214917),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=0, num_samples=10, accuracy=0.5544000267982483, crossentropy=1.9709936213214279),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=1, num_samples=10, accuracy=0.6014999747276306, crossentropy=1.9488236465841866),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=2, num_samples=10, accuracy=0.5523999929428101, crossentropy=2.0429818992965467),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=3, num_samples=10, accuracy=0.5371999740600586, crossentropy=2.099833893563872),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=4, num_samples=10, accuracy=0.5705000162124634, crossentropy=1.8870867260437725),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=0, num_samples=100, accuracy=0.5992000102996826, crossentropy=1.654170173885335),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=1, num_samples=100, accuracy=0.6043999791145325, crossentropy=1.6092253931080474),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=2, num_samples=100, accuracy=0.5914999842643738, crossentropy=1.676038880737029),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=3, num_samples=100, accuracy=0.5961999893188477, crossentropy=1.6445126566418138),
   OBIPerformance(total_training_set_size=26, real_training_set_size=25, online_training_set_size=1, trial_index=4, num_samples=100, accuracy=0.5899999737739563, crossentropy=1.6852523026283797),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=0, num_samples=10, accuracy=0.5817000269889832, crossentropy=1.9717441695144633),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=1, num_samples=10, accuracy=0.5360999703407288, crossentropy=2.183609979635687),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=2, num_samples=10, accuracy=0.5899999737739563, crossentropy=1.889122755179886),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=3, num_samples=10, accuracy=0.5180000066757202, crossentropy=2.834119843432201),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=4, num_samples=10, accuracy=0.5260999798774719, crossentropy=2.2044175901266927),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=0, num_samples=100, accuracy=0.5857999920845032, crossentropy=1.7883326441781464),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=1, num_samples=100, accuracy=0.5080999732017517, crossentropy=2.2506345206153635),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=2, num_samples=100, accuracy=0.5875999927520752, crossentropy=1.839266339663366),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=3, num_samples=100, accuracy=0.5813999772071838, crossentropy=1.8494240900683825),
   OBIPerformance(total_training_set_size=27, real_training_set_size=25, online_training_set_size=2, trial_index=4, num_samples=100, accuracy=0.5268999934196472, crossentropy=2.2260231643049293),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=0, num_samples=10, accuracy=0.5751000046730042, crossentropy=1.7488442436620844),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=1, num_samples=10, accuracy=0.5726000070571899, crossentropy=2.240477478330983),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=2, num_samples=10, accuracy=0.58160001039505, crossentropy=2.01932261751905),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=3, num_samples=10, accuracy=0.5756000280380249, crossentropy=1.8769506062711927),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=4, num_samples=10, accuracy=0.5889999866485596, crossentropy=1.9076354853849629),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=0, num_samples=100, accuracy=0.519599974155426, crossentropy=2.2496125445840387),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=1, num_samples=100, accuracy=0.5202000141143799, crossentropy=2.2396571847792197),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=2, num_samples=100, accuracy=0.5157999992370605, crossentropy=2.2125949128246485),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=3, num_samples=100, accuracy=0.5889999866485596, crossentropy=1.8628801053480448),
   OBIPerformance(total_training_set_size=28, real_training_set_size=25, online_training_set_size=3, trial_index=4, num_samples=100, accuracy=0.5224999785423279, crossentropy=2.3735127332052395),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=0, num_samples=10, accuracy=0.5767999887466431, crossentropy=2.641944438443787),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=1, num_samples=10, accuracy=0.58160001039505, crossentropy=1.985471471506219),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=2, num_samples=10, accuracy=0.5898000001907349, crossentropy=2.02617115135217),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=3, num_samples=10, accuracy=0.5501000285148621, crossentropy=2.4420125597094775),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=4, num_samples=10, accuracy=0.5867000222206116, crossentropy=1.8085561077739978),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=0, num_samples=100, accuracy=0.607699990272522, crossentropy=1.6434745846272796),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=1, num_samples=100, accuracy=0.6273000240325928, crossentropy=1.5586418345181836),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=2, num_samples=100, accuracy=0.623199999332428, crossentropy=1.6223923761514683),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=3, num_samples=100, accuracy=0.5976999998092651, crossentropy=1.769269589450079),
   OBIPerformance(total_training_set_size=29, real_training_set_size=25, online_training_set_size=4, trial_index=4, num_samples=100, accuracy=0.6086999773979187, crossentropy=1.6456227645143096),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=0, num_samples=10, accuracy=0.597599983215332, crossentropy=1.736539457927888),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=1, num_samples=10, accuracy=0.5728999972343445, crossentropy=1.7106097900693544),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=2, num_samples=10, accuracy=0.5656999945640564, crossentropy=1.6273046869569054),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=3, num_samples=10, accuracy=0.5623999834060669, crossentropy=2.700319981735113),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=4, num_samples=10, accuracy=0.5582000017166138, crossentropy=2.0554589601092697),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=0, num_samples=100, accuracy=0.5694000124931335, crossentropy=1.638806473920221),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=1, num_samples=100, accuracy=0.5414999723434448, crossentropy=1.7817528223899666),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=2, num_samples=100, accuracy=0.5687999725341797, crossentropy=1.736103958209068),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=3, num_samples=100, accuracy=0.5788000226020813, crossentropy=1.6854608578821277),
   OBIPerformance(total_training_set_size=30, real_training_set_size=25, online_training_set_size=5, trial_index=4, num_samples=100, accuracy=0.5608999729156494, crossentropy=1.7576803008335282),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=0, num_samples=10, accuracy=0.5526999831199646, crossentropy=2.162691137476734),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=1, num_samples=10, accuracy=0.6323000192642212, crossentropy=1.7017910256220676),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=2, num_samples=10, accuracy=0.5940999984741211, crossentropy=1.8202552528398432),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=3, num_samples=10, accuracy=0.5676000118255615, crossentropy=1.8005403523684373),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=4, num_samples=10, accuracy=0.5103999972343445, crossentropy=2.961633716206063),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=0, num_samples=100, accuracy=0.5952000021934509, crossentropy=1.5563478480702626),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=1, num_samples=100, accuracy=0.6051999926567078, crossentropy=1.5486998200622526),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=2, num_samples=100, accuracy=0.5985999703407288, crossentropy=1.6610404141810795),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=3, num_samples=100, accuracy=0.5896000266075134, crossentropy=1.5953753865617757),
   OBIPerformance(total_training_set_size=31, real_training_set_size=25, online_training_set_size=6, trial_index=4, num_samples=100, accuracy=0.6049000024795532, crossentropy=1.5607134193468577),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=0, num_samples=10, accuracy=0.5371000170707703, crossentropy=2.043801463605277),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=1, num_samples=10, accuracy=0.5932000279426575, crossentropy=1.9111877533216954),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=2, num_samples=10, accuracy=0.5785999894142151, crossentropy=1.8704877449817596),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=3, num_samples=10, accuracy=0.5956000089645386, crossentropy=1.8987038980257671),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=4, num_samples=10, accuracy=0.5250999927520752, crossentropy=2.388334066223233),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=0, num_samples=100, accuracy=0.6198999881744385, crossentropy=1.479960824291604),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=1, num_samples=100, accuracy=0.59579998254776, crossentropy=1.480162888433034),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=2, num_samples=100, accuracy=0.5475999712944031, crossentropy=1.7789497137354484),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=3, num_samples=100, accuracy=0.5507000088691711, crossentropy=1.7265107611438162),
   OBIPerformance(total_training_set_size=32, real_training_set_size=25, online_training_set_size=7, trial_index=4, num_samples=100, accuracy=0.546500027179718, crossentropy=1.7856688982373592),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=0, num_samples=10, accuracy=0.5442000031471252, crossentropy=2.1340101865426444),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=1, num_samples=10, accuracy=0.5533999800682068, crossentropy=1.9940055103193088),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=2, num_samples=10, accuracy=0.5953999757766724, crossentropy=1.7291821105081828),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=3, num_samples=10, accuracy=0.5864999890327454, crossentropy=1.8024592735243607),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=4, num_samples=10, accuracy=0.5371000170707703, crossentropy=2.0309373522256426),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=0, num_samples=100, accuracy=0.5400000214576721, crossentropy=1.9180752324110844),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=1, num_samples=100, accuracy=0.541100025177002, crossentropy=1.916601084240894),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=2, num_samples=100, accuracy=0.5891000032424927, crossentropy=1.6037420898884498),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=3, num_samples=100, accuracy=0.5406000018119812, crossentropy=1.9299277980448255),
   OBIPerformance(total_training_set_size=33, real_training_set_size=25, online_training_set_size=8, trial_index=4, num_samples=100, accuracy=0.5386999845504761, crossentropy=1.9910045475259932),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=0, num_samples=10, accuracy=0.5411999821662903, crossentropy=1.921045141596812),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=1, num_samples=10, accuracy=0.5717999935150146, crossentropy=1.8601931519355615),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=2, num_samples=10, accuracy=0.5764999985694885, crossentropy=1.9161851874110973),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=3, num_samples=10, accuracy=0.5925999879837036, crossentropy=1.7674351697271835),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=4, num_samples=10, accuracy=0.5735999941825867, crossentropy=1.84517442854294),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=0, num_samples=100, accuracy=0.5674999952316284, crossentropy=1.6574367656371642),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=1, num_samples=100, accuracy=0.5475000143051147, crossentropy=1.7657161202990383),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=2, num_samples=100, accuracy=0.5613999962806702, crossentropy=1.682907977431608),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=3, num_samples=100, accuracy=0.5701000094413757, crossentropy=1.6488591451325487),
   OBIPerformance(total_training_set_size=34, real_training_set_size=25, online_training_set_size=9, trial_index=4, num_samples=100, accuracy=0.5996999740600586, crossentropy=1.6469500130991968),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=0, num_samples=10, accuracy=0.5860000252723694, crossentropy=1.7037003220558622),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=1, num_samples=10, accuracy=0.5260999798774719, crossentropy=2.375470636791103),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=2, num_samples=10, accuracy=0.5447999835014343, crossentropy=2.1348407867910284),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=3, num_samples=10, accuracy=0.5562999844551086, crossentropy=2.52490240724365),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=4, num_samples=10, accuracy=0.5253999829292297, crossentropy=2.4174216976274874),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=0, num_samples=100, accuracy=0.550000011920929, crossentropy=1.8399666425114811),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=1, num_samples=100, accuracy=0.5371000170707703, crossentropy=2.009523930110315),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=2, num_samples=100, accuracy=0.5400000214576721, crossentropy=1.9460873576058846),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=3, num_samples=100, accuracy=0.5440000295639038, crossentropy=1.8489375667687349),
   OBIPerformance(total_training_set_size=35, real_training_set_size=25, online_training_set_size=10, trial_index=4, num_samples=100, accuracy=0.5401999950408936, crossentropy=1.943040866485901)],
  [OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=0, num_samples=10, accuracy=0.6553000211715698, crossentropy=1.6493704446256634),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=1, num_samples=10, accuracy=0.6798999905586243, crossentropy=1.6922504163094116),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=2, num_samples=10, accuracy=0.6682999730110168, crossentropy=1.414807733161789),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=3, num_samples=10, accuracy=0.6841999888420105, crossentropy=1.4658374798565494),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=4, num_samples=10, accuracy=0.6717000007629395, crossentropy=1.3567051124058678),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=0, num_samples=100, accuracy=0.6816999912261963, crossentropy=1.1340940909650736),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=1, num_samples=100, accuracy=0.6814000010490417, crossentropy=1.1347216911569669),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=2, num_samples=100, accuracy=0.682200014591217, crossentropy=1.1236202621514846),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=3, num_samples=100, accuracy=0.6754000186920166, crossentropy=1.1721064034197455),
   OBIPerformance(total_training_set_size=30, real_training_set_size=30, online_training_set_size=0, trial_index=4, num_samples=100, accuracy=0.6815999746322632, crossentropy=1.121347171405315),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=0, num_samples=10, accuracy=0.6553000211715698, crossentropy=1.4524667810426912),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=1, num_samples=10, accuracy=0.6897000074386597, crossentropy=1.4149371504469928),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=2, num_samples=10, accuracy=0.6757000088691711, crossentropy=1.2541490635351915),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=3, num_samples=10, accuracy=0.6563000082969666, crossentropy=1.4237299721431738),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=4, num_samples=10, accuracy=0.6753000020980835, crossentropy=1.5763221266863),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=0, num_samples=100, accuracy=0.6700999736785889, crossentropy=1.1714726240937405),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=1, num_samples=100, accuracy=0.6764000058174133, crossentropy=1.138640144460815),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=2, num_samples=100, accuracy=0.671999990940094, crossentropy=1.182803313953726),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=3, num_samples=100, accuracy=0.6783999800682068, crossentropy=1.1525015029739432),
   OBIPerformance(total_training_set_size=31, real_training_set_size=30, online_training_set_size=1, trial_index=4, num_samples=100, accuracy=0.6657000184059143, crossentropy=1.187274606455306),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=0, num_samples=10, accuracy=0.5821999907493591, crossentropy=2.5594327522993057),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=1, num_samples=10, accuracy=0.6704999804496765, crossentropy=1.7988378700426055),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=2, num_samples=10, accuracy=0.6640999913215637, crossentropy=1.5021631476989874),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=3, num_samples=10, accuracy=0.6389999985694885, crossentropy=1.634070684146529),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=4, num_samples=10, accuracy=0.6636000275611877, crossentropy=1.4739030518835055),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=0, num_samples=100, accuracy=0.6625000238418579, crossentropy=1.346377788587259),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=1, num_samples=100, accuracy=0.6776000261306763, crossentropy=1.3129367489640071),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=2, num_samples=100, accuracy=0.6402000188827515, crossentropy=1.41925491939407),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=3, num_samples=100, accuracy=0.6628000140190125, crossentropy=1.368467045584973),
   OBIPerformance(total_training_set_size=32, real_training_set_size=30, online_training_set_size=2, trial_index=4, num_samples=100, accuracy=0.6751999855041504, crossentropy=1.3167524451265453),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=0, num_samples=10, accuracy=0.6342999935150146, crossentropy=2.0022730890381477),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=1, num_samples=10, accuracy=0.6389999985694885, crossentropy=1.8626000776625922),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=2, num_samples=10, accuracy=0.6514000296592712, crossentropy=1.8712996796753723),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=3, num_samples=10, accuracy=0.6489999890327454, crossentropy=2.1929052006429566),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=4, num_samples=10, accuracy=0.6703000068664551, crossentropy=1.2695603980805839),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=0, num_samples=100, accuracy=0.63919997215271, crossentropy=1.7552481527257358),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=1, num_samples=100, accuracy=0.6780999898910522, crossentropy=1.3721962224523077),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=2, num_samples=100, accuracy=0.6651999950408936, crossentropy=1.4142157744747847),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=3, num_samples=100, accuracy=0.6765999794006348, crossentropy=1.5898312683172524),
   OBIPerformance(total_training_set_size=33, real_training_set_size=30, online_training_set_size=3, trial_index=4, num_samples=100, accuracy=0.6394000053405762, crossentropy=1.7385163196039393),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=0, num_samples=10, accuracy=0.6730999946594238, crossentropy=1.6124593873953357),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=1, num_samples=10, accuracy=0.6614999771118164, crossentropy=1.5500862244402387),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=2, num_samples=10, accuracy=0.6341000199317932, crossentropy=2.8499686744612482),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=3, num_samples=10, accuracy=0.6245999932289124, crossentropy=2.225383406484064),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=4, num_samples=10, accuracy=0.6699000000953674, crossentropy=2.43924555588654),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=0, num_samples=100, accuracy=0.6434000134468079, crossentropy=1.4408952797417467),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=1, num_samples=100, accuracy=0.6736999750137329, crossentropy=1.2670047682392436),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=2, num_samples=100, accuracy=0.675000011920929, crossentropy=1.2566334408193587),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=3, num_samples=100, accuracy=0.663100004196167, crossentropy=1.3139963246928392),
   OBIPerformance(total_training_set_size=34, real_training_set_size=30, online_training_set_size=4, trial_index=4, num_samples=100, accuracy=0.6377999782562256, crossentropy=1.7989955081662152),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=0, num_samples=10, accuracy=0.6337000131607056, crossentropy=1.621878388148549),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=1, num_samples=10, accuracy=0.6068999767303467, crossentropy=1.5787162078077182),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=2, num_samples=10, accuracy=0.6740000247955322, crossentropy=2.3762723518704676),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=3, num_samples=10, accuracy=0.6470000147819519, crossentropy=1.3758278633622474),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=4, num_samples=10, accuracy=0.6256999969482422, crossentropy=2.247413437185756),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=0, num_samples=100, accuracy=0.6180999875068665, crossentropy=1.6989354545876478),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=1, num_samples=100, accuracy=0.6244000196456909, crossentropy=1.652026832367172),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=2, num_samples=100, accuracy=0.6097999811172485, crossentropy=1.75485667395258),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=3, num_samples=100, accuracy=0.6632999777793884, crossentropy=1.2801276899349716),
   OBIPerformance(total_training_set_size=35, real_training_set_size=30, online_training_set_size=5, trial_index=4, num_samples=100, accuracy=0.6279000043869019, crossentropy=1.6459553694103917),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=0, num_samples=10, accuracy=0.6018999814987183, crossentropy=2.438453357602158),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=1, num_samples=10, accuracy=0.5849999785423279, crossentropy=1.941975553342779),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=2, num_samples=10, accuracy=0.6477000117301941, crossentropy=1.3948290968555317),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=3, num_samples=10, accuracy=0.5821999907493591, crossentropy=2.782713331242634),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=4, num_samples=10, accuracy=0.6599000096321106, crossentropy=1.7235108682882736),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=0, num_samples=100, accuracy=0.6244999766349792, crossentropy=2.1108565640522605),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=1, num_samples=100, accuracy=0.6154999732971191, crossentropy=1.6200696691320677),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=2, num_samples=100, accuracy=0.616599977016449, crossentropy=1.5560327729411818),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=3, num_samples=100, accuracy=0.6302000284194946, crossentropy=1.9502134978798218),
   OBIPerformance(total_training_set_size=36, real_training_set_size=30, online_training_set_size=6, trial_index=4, num_samples=100, accuracy=0.6137999892234802, crossentropy=2.329690273102308),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=0, num_samples=10, accuracy=0.6700000166893005, crossentropy=1.2903394765002443),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=1, num_samples=10, accuracy=0.6624000072479248, crossentropy=1.6861538863940442),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=2, num_samples=10, accuracy=0.6636999845504761, crossentropy=1.707168538409896),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=3, num_samples=10, accuracy=0.6327000260353088, crossentropy=1.435496116435163),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=4, num_samples=10, accuracy=0.6366999745368958, crossentropy=1.696861206913655),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=0, num_samples=100, accuracy=0.5985000133514404, crossentropy=1.5828351865074972),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=1, num_samples=100, accuracy=0.6148999929428101, crossentropy=1.858025368344777),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=2, num_samples=100, accuracy=0.6151000261306763, crossentropy=1.797645964622296),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=3, num_samples=100, accuracy=0.583899974822998, crossentropy=1.900472710284993),
   OBIPerformance(total_training_set_size=37, real_training_set_size=30, online_training_set_size=7, trial_index=4, num_samples=100, accuracy=0.5837000012397766, crossentropy=1.9078268146905382),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=0, num_samples=10, accuracy=0.6468999981880188, crossentropy=1.3773340618385852),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=1, num_samples=10, accuracy=0.5841000080108643, crossentropy=1.6926345731538186),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=2, num_samples=10, accuracy=0.5989999771118164, crossentropy=2.1149583038456012),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=3, num_samples=10, accuracy=0.6309000253677368, crossentropy=2.549013394315134),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=4, num_samples=10, accuracy=0.5242000222206116, crossentropy=2.5725474325188245),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=0, num_samples=100, accuracy=0.6284000277519226, crossentropy=1.4928710347176422),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=1, num_samples=100, accuracy=0.650600016117096, crossentropy=1.2694906775073143),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=2, num_samples=100, accuracy=0.6337000131607056, crossentropy=1.32450354602736),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=3, num_samples=100, accuracy=0.5835000276565552, crossentropy=1.9356446377142213),
   OBIPerformance(total_training_set_size=38, real_training_set_size=30, online_training_set_size=8, trial_index=4, num_samples=100, accuracy=0.6478000283241272, crossentropy=1.3522311789602597),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=0, num_samples=10, accuracy=0.6452999711036682, crossentropy=2.2725632833513627),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=1, num_samples=10, accuracy=0.6504999995231628, crossentropy=1.5006043189246367),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=2, num_samples=10, accuracy=0.6496999859809875, crossentropy=1.9761713030065653),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=3, num_samples=10, accuracy=0.6543999910354614, crossentropy=2.230876908722793),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=4, num_samples=10, accuracy=0.6137999892234802, crossentropy=2.5416660894777885),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=0, num_samples=100, accuracy=0.5835000276565552, crossentropy=1.9363986560383157),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=1, num_samples=100, accuracy=0.5835000276565552, crossentropy=1.9363860123499559),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=2, num_samples=100, accuracy=0.659600019454956, crossentropy=1.4345601121815714),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=3, num_samples=100, accuracy=0.6470999717712402, crossentropy=1.370131597463961),
   OBIPerformance(total_training_set_size=39, real_training_set_size=30, online_training_set_size=9, trial_index=4, num_samples=100, accuracy=0.5838000178337097, crossentropy=1.8621107786563578),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=0, num_samples=10, accuracy=0.6657999753952026, crossentropy=2.257695189509324),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=1, num_samples=10, accuracy=0.656000018119812, crossentropy=1.9094349899939305),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=2, num_samples=10, accuracy=0.6468999981880188, crossentropy=1.3773340619232308),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=3, num_samples=10, accuracy=0.6468999981880188, crossentropy=1.3773340616290546),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=4, num_samples=10, accuracy=0.5821999907493591, crossentropy=2.6430894823362987),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=0, num_samples=100, accuracy=0.6136999726295471, crossentropy=1.377590983900062),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=1, num_samples=100, accuracy=0.6057000160217285, crossentropy=1.444698800121636),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=2, num_samples=100, accuracy=0.6468999981880188, crossentropy=1.3767018222480536),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=3, num_samples=100, accuracy=0.669700026512146, crossentropy=1.2587810059010185),
   OBIPerformance(total_training_set_size=40, real_training_set_size=30, online_training_set_size=10, trial_index=4, num_samples=100, accuracy=0.6468999981880188, crossentropy=1.3773262465297014)]],
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.498046875,
      &#39;crossentropy&#39;: 1.6982649564743042},
     {&#39;accuracy&#39;: 0.5888671875, &#39;crossentropy&#39;: 1.4402198791503906},
     {&#39;accuracy&#39;: 0.5654296875, &#39;crossentropy&#39;: 1.6309633255004883},
     {&#39;accuracy&#39;: 0.5732421875, &#39;crossentropy&#39;: 1.6977273225784302},
     {&#39;accuracy&#39;: 0.57421875, &#39;crossentropy&#39;: 1.7026183605194092},
     {&#39;accuracy&#39;: 0.556640625, &#39;crossentropy&#39;: 1.87465500831604},
     {&#39;accuracy&#39;: 0.5830078125, &#39;crossentropy&#39;: 1.8215177059173584},
     {&#39;accuracy&#39;: 0.576171875, &#39;crossentropy&#39;: 1.8394629955291748},
     {&#39;accuracy&#39;: 0.556640625, &#39;crossentropy&#39;: 1.8409117460250854},
     {&#39;accuracy&#39;: 0.5771484375, &#39;crossentropy&#39;: 1.8598860502243042},
     {&#39;accuracy&#39;: 0.5751953125, &#39;crossentropy&#39;: 1.8028939962387085},
     {&#39;accuracy&#39;: 0.5830078125, &#39;crossentropy&#39;: 1.797486424446106},
     {&#39;accuracy&#39;: 0.5849609375, &#39;crossentropy&#39;: 1.8238229751586914},
     {&#39;accuracy&#39;: 0.5869140625, &#39;crossentropy&#39;: 1.8789403438568115},
     {&#39;accuracy&#39;: 0.5791015625, &#39;crossentropy&#39;: 1.8765678405761719},
     {&#39;accuracy&#39;: 0.556640625, &#39;crossentropy&#39;: 1.9669631719589233},
     {&#39;accuracy&#39;: 0.5625, &#39;crossentropy&#39;: 2.0490760803222656},
     {&#39;accuracy&#39;: 0.5869140625, &#39;crossentropy&#39;: 1.8095895051956177},
     {&#39;accuracy&#39;: 0.5810546875, &#39;crossentropy&#39;: 1.956794261932373},
     {&#39;accuracy&#39;: 0.5849609375, &#39;crossentropy&#39;: 2.0158591270446777},
     {&#39;accuracy&#39;: 0.5439453125, &#39;crossentropy&#39;: 2.0667121410369873},
     {&#39;accuracy&#39;: 0.568359375, &#39;crossentropy&#39;: 2.01694917678833}],
    &#39;best_epoch&#39;: 1},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.5835,
    &#39;crossentropy&#39;: 1.39644130859375,
    &#39;_timestamp&#39;: 1650146633,
    &#39;_runtime&#39;: 23},
   &#39;acquisition&#39;: {&#39;indices&#39;: [17776, 36852, 26891, 17001, 44414]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.392578125,
      &#39;crossentropy&#39;: 1.7610929012298584},
     {&#39;accuracy&#39;: 0.580078125, &#39;crossentropy&#39;: 1.499049186706543},
     {&#39;accuracy&#39;: 0.578125, &#39;crossentropy&#39;: 1.642911672592163},
     {&#39;accuracy&#39;: 0.5888671875, &#39;crossentropy&#39;: 1.6243882179260254},
     {&#39;accuracy&#39;: 0.599609375, &#39;crossentropy&#39;: 1.553757667541504},
     {&#39;accuracy&#39;: 0.6044921875, &#39;crossentropy&#39;: 1.6975044012069702},
     {&#39;accuracy&#39;: 0.5712890625, &#39;crossentropy&#39;: 1.8377858400344849},
     {&#39;accuracy&#39;: 0.5712890625, &#39;crossentropy&#39;: 1.9138169288635254},
     {&#39;accuracy&#39;: 0.5888671875, &#39;crossentropy&#39;: 1.722456932067871},
     {&#39;accuracy&#39;: 0.5810546875, &#39;crossentropy&#39;: 1.8387601375579834},
     {&#39;accuracy&#39;: 0.5615234375, &#39;crossentropy&#39;: 1.9316930770874023},
     {&#39;accuracy&#39;: 0.564453125, &#39;crossentropy&#39;: 2.07055401802063},
     {&#39;accuracy&#39;: 0.5771484375, &#39;crossentropy&#39;: 1.830942153930664},
     {&#39;accuracy&#39;: 0.5859375, &#39;crossentropy&#39;: 1.721291184425354},
     {&#39;accuracy&#39;: 0.5830078125, &#39;crossentropy&#39;: 2.021444797515869},
     {&#39;accuracy&#39;: 0.5478515625, &#39;crossentropy&#39;: 2.004549741744995},
     {&#39;accuracy&#39;: 0.5712890625, &#39;crossentropy&#39;: 2.0528836250305176},
     {&#39;accuracy&#39;: 0.57421875, &#39;crossentropy&#39;: 1.9162685871124268},
     {&#39;accuracy&#39;: 0.5947265625, &#39;crossentropy&#39;: 1.8648276329040527},
     {&#39;accuracy&#39;: 0.595703125, &#39;crossentropy&#39;: 2.074589729309082},
     {&#39;accuracy&#39;: 0.5908203125, &#39;crossentropy&#39;: 1.8965049982070923},
     {&#39;accuracy&#39;: 0.5986328125, &#39;crossentropy&#39;: 1.8511106967926025},
     {&#39;accuracy&#39;: 0.5888671875, &#39;crossentropy&#39;: 1.79728102684021},
     {&#39;accuracy&#39;: 0.56640625, &#39;crossentropy&#39;: 2.104839563369751},
     {&#39;accuracy&#39;: 0.5625, &#39;crossentropy&#39;: 2.0135533809661865},
     {&#39;accuracy&#39;: 0.576171875, &#39;crossentropy&#39;: 1.929125189781189}],
    &#39;best_epoch&#39;: 5},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.6058,
    &#39;crossentropy&#39;: 1.6094099609375,
    &#39;_timestamp&#39;: 1650146660,
    &#39;_runtime&#39;: 50},
   &#39;acquisition&#39;: {&#39;indices&#39;: [23050, 30884, 41516, 8897, 34608]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.384765625,
      &#39;crossentropy&#39;: 1.8451828956604004},
     {&#39;accuracy&#39;: 0.5068359375, &#39;crossentropy&#39;: 1.4651920795440674},
     {&#39;accuracy&#39;: 0.5791015625, &#39;crossentropy&#39;: 1.3441417217254639},
     {&#39;accuracy&#39;: 0.59375, &#39;crossentropy&#39;: 1.2797155380249023},
     {&#39;accuracy&#39;: 0.6044921875, &#39;crossentropy&#39;: 1.2529510259628296},
     {&#39;accuracy&#39;: 0.5869140625, &#39;crossentropy&#39;: 1.4234411716461182},
     {&#39;accuracy&#39;: 0.6103515625, &#39;crossentropy&#39;: 1.368377923965454},
     {&#39;accuracy&#39;: 0.6044921875, &#39;crossentropy&#39;: 1.4224683046340942},
     {&#39;accuracy&#39;: 0.619140625, &#39;crossentropy&#39;: 1.3120524883270264},
     {&#39;accuracy&#39;: 0.5986328125, &#39;crossentropy&#39;: 1.4843430519104004},
     {&#39;accuracy&#39;: 0.630859375, &#39;crossentropy&#39;: 1.2483532428741455},
     {&#39;accuracy&#39;: 0.6201171875, &#39;crossentropy&#39;: 1.359853982925415},
     {&#39;accuracy&#39;: 0.6435546875, &#39;crossentropy&#39;: 1.3114601373672485},
     {&#39;accuracy&#39;: 0.64453125, &#39;crossentropy&#39;: 1.2504527568817139},
     {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 1.3473081588745117},
     {&#39;accuracy&#39;: 0.619140625, &#39;crossentropy&#39;: 1.3479756116867065},
     {&#39;accuracy&#39;: 0.6279296875, &#39;crossentropy&#39;: 1.3399513959884644},
     {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 1.4034274816513062},
     {&#39;accuracy&#39;: 0.6494140625, &#39;crossentropy&#39;: 1.3031257390975952},
     {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 1.38523268699646},
     {&#39;accuracy&#39;: 0.615234375, &#39;crossentropy&#39;: 1.5263015031814575},
     {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 1.4069820642471313},
     {&#39;accuracy&#39;: 0.63671875, &#39;crossentropy&#39;: 1.325340986251831},
     {&#39;accuracy&#39;: 0.619140625, &#39;crossentropy&#39;: 1.4355727434158325},
     {&#39;accuracy&#39;: 0.607421875, &#39;crossentropy&#39;: 1.5232502222061157},
     {&#39;accuracy&#39;: 0.6298828125, &#39;crossentropy&#39;: 1.3429975509643555},
     {&#39;accuracy&#39;: 0.6064453125, &#39;crossentropy&#39;: 1.5156619548797607},
     {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 1.4553465843200684},
     {&#39;accuracy&#39;: 0.6435546875, &#39;crossentropy&#39;: 1.378708004951477},
     {&#39;accuracy&#39;: 0.6455078125, &#39;crossentropy&#39;: 1.3057401180267334},
     {&#39;accuracy&#39;: 0.623046875, &#39;crossentropy&#39;: 1.4687678813934326},
     {&#39;accuracy&#39;: 0.6259765625, &#39;crossentropy&#39;: 1.5313355922698975},
     {&#39;accuracy&#39;: 0.671875, &#39;crossentropy&#39;: 1.4225190877914429},
     {&#39;accuracy&#39;: 0.658203125, &#39;crossentropy&#39;: 1.3263912200927734},
     {&#39;accuracy&#39;: 0.6201171875, &#39;crossentropy&#39;: 1.5050984621047974},
     {&#39;accuracy&#39;: 0.6552734375, &#39;crossentropy&#39;: 1.3476742506027222},
     {&#39;accuracy&#39;: 0.642578125, &#39;crossentropy&#39;: 1.3577030897140503},
     {&#39;accuracy&#39;: 0.6162109375, &#39;crossentropy&#39;: 1.4826518297195435},
     {&#39;accuracy&#39;: 0.6689453125, &#39;crossentropy&#39;: 1.1885735988616943},
     {&#39;accuracy&#39;: 0.625, &#39;crossentropy&#39;: 1.386590600013733},
     {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.3295832872390747},
     {&#39;accuracy&#39;: 0.65234375, &#39;crossentropy&#39;: 1.3120930194854736},
     {&#39;accuracy&#39;: 0.6572265625, &#39;crossentropy&#39;: 1.375509262084961},
     {&#39;accuracy&#39;: 0.650390625, &#39;crossentropy&#39;: 1.4387462139129639},
     {&#39;accuracy&#39;: 0.654296875, &#39;crossentropy&#39;: 1.3311309814453125},
     {&#39;accuracy&#39;: 0.6328125, &#39;crossentropy&#39;: 1.388687014579773},
     {&#39;accuracy&#39;: 0.6318359375, &#39;crossentropy&#39;: 1.413032054901123},
     {&#39;accuracy&#39;: 0.646484375, &#39;crossentropy&#39;: 1.3818559646606445},
     {&#39;accuracy&#39;: 0.6337890625, &#39;crossentropy&#39;: 1.4675642251968384},
     {&#39;accuracy&#39;: 0.6259765625, &#39;crossentropy&#39;: 1.480331301689148},
     {&#39;accuracy&#39;: 0.630859375, &#39;crossentropy&#39;: 1.3433988094329834},
     {&#39;accuracy&#39;: 0.6416015625, &#39;crossentropy&#39;: 1.3653669357299805},
     {&#39;accuracy&#39;: 0.6357421875, &#39;crossentropy&#39;: 1.3764736652374268}],
    &#39;best_epoch&#39;: 32},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.6791,
    &#39;crossentropy&#39;: 1.2912138671875,
    &#39;_timestamp&#39;: 1650146696,
    &#39;_runtime&#39;: 86},
   &#39;acquisition&#39;: {&#39;indices&#39;: [11721, 13127, 9870, 39700, 13985]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.2861328125,
      &#39;crossentropy&#39;: 2.0189788341522217},
     {&#39;accuracy&#39;: 0.5595703125, &#39;crossentropy&#39;: 1.376032829284668},
     {&#39;accuracy&#39;: 0.6162109375, &#39;crossentropy&#39;: 1.3099182844161987},
     {&#39;accuracy&#39;: 0.6328125, &#39;crossentropy&#39;: 1.242930293083191},
     {&#39;accuracy&#39;: 0.6494140625, &#39;crossentropy&#39;: 1.209563136100769},
     {&#39;accuracy&#39;: 0.646484375, &#39;crossentropy&#39;: 1.3501644134521484},
     {&#39;accuracy&#39;: 0.66015625, &#39;crossentropy&#39;: 1.276748776435852},
     {&#39;accuracy&#39;: 0.65234375, &#39;crossentropy&#39;: 1.3631401062011719},
     {&#39;accuracy&#39;: 0.65625, &#39;crossentropy&#39;: 1.3457051515579224},
     {&#39;accuracy&#39;: 0.6533203125, &#39;crossentropy&#39;: 1.25152587890625},
     {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 1.284234642982483},
     {&#39;accuracy&#39;: 0.66015625, &#39;crossentropy&#39;: 1.304644227027893},
     {&#39;accuracy&#39;: 0.6455078125, &#39;crossentropy&#39;: 1.334561824798584},
     {&#39;accuracy&#39;: 0.642578125, &#39;crossentropy&#39;: 1.3373467922210693},
     {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 1.3325796127319336},
     {&#39;accuracy&#39;: 0.6669921875, &#39;crossentropy&#39;: 1.2678810358047485},
     {&#39;accuracy&#39;: 0.65234375, &#39;crossentropy&#39;: 1.3493870496749878},
     {&#39;accuracy&#39;: 0.6513671875, &#39;crossentropy&#39;: 1.4422907829284668},
     {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.402571439743042},
     {&#39;accuracy&#39;: 0.6689453125, &#39;crossentropy&#39;: 1.4179450273513794},
     {&#39;accuracy&#39;: 0.66015625, &#39;crossentropy&#39;: 1.2956926822662354},
     {&#39;accuracy&#39;: 0.6572265625, &#39;crossentropy&#39;: 1.413398027420044},
     {&#39;accuracy&#39;: 0.66796875, &#39;crossentropy&#39;: 1.2732652425765991},
     {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 1.2829333543777466},
     {&#39;accuracy&#39;: 0.6630859375, &#39;crossentropy&#39;: 1.2925512790679932},
     {&#39;accuracy&#39;: 0.6640625, &#39;crossentropy&#39;: 1.3245954513549805},
     {&#39;accuracy&#39;: 0.6669921875, &#39;crossentropy&#39;: 1.3267536163330078},
     {&#39;accuracy&#39;: 0.658203125, &#39;crossentropy&#39;: 1.3234596252441406},
     {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.320326805114746},
     {&#39;accuracy&#39;: 0.6630859375, &#39;crossentropy&#39;: 1.3857308626174927},
     {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 1.2790052890777588},
     {&#39;accuracy&#39;: 0.6650390625, &#39;crossentropy&#39;: 1.3205260038375854},
     {&#39;accuracy&#39;: 0.666015625, &#39;crossentropy&#39;: 1.3766523599624634},
     {&#39;accuracy&#39;: 0.6689453125, &#39;crossentropy&#39;: 1.2650502920150757},
     {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 1.3205281496047974},
     {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 1.349450945854187},
     {&#39;accuracy&#39;: 0.6767578125, &#39;crossentropy&#39;: 1.3711493015289307},
     {&#39;accuracy&#39;: 0.66796875, &#39;crossentropy&#39;: 1.366260051727295},
     {&#39;accuracy&#39;: 0.6767578125, &#39;crossentropy&#39;: 1.2759532928466797},
     {&#39;accuracy&#39;: 0.6806640625, &#39;crossentropy&#39;: 1.337022304534912},
     {&#39;accuracy&#39;: 0.68359375, &#39;crossentropy&#39;: 1.300515055656433},
     {&#39;accuracy&#39;: 0.671875, &#39;crossentropy&#39;: 1.4049433469772339},
     {&#39;accuracy&#39;: 0.6630859375, &#39;crossentropy&#39;: 1.339883804321289},
     {&#39;accuracy&#39;: 0.6884765625, &#39;crossentropy&#39;: 1.215468168258667},
     {&#39;accuracy&#39;: 0.6572265625, &#39;crossentropy&#39;: 1.3123524188995361},
     {&#39;accuracy&#39;: 0.6533203125, &#39;crossentropy&#39;: 1.2819137573242188},
     {&#39;accuracy&#39;: 0.69921875, &#39;crossentropy&#39;: 1.073171615600586},
     {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 1.360499620437622},
     {&#39;accuracy&#39;: 0.685546875, &#39;crossentropy&#39;: 1.3186885118484497},
     {&#39;accuracy&#39;: 0.6806640625, &#39;crossentropy&#39;: 1.2420796155929565},
     {&#39;accuracy&#39;: 0.6728515625, &#39;crossentropy&#39;: 1.2878775596618652},
     {&#39;accuracy&#39;: 0.67578125, &#39;crossentropy&#39;: 1.3673439025878906},
     {&#39;accuracy&#39;: 0.6640625, &#39;crossentropy&#39;: 1.4459720849990845},
     {&#39;accuracy&#39;: 0.6591796875, &#39;crossentropy&#39;: 1.4396723508834839},
     {&#39;accuracy&#39;: 0.64453125, &#39;crossentropy&#39;: 1.3584870100021362},
     {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 1.239335536956787},
     {&#39;accuracy&#39;: 0.669921875, &#39;crossentropy&#39;: 1.235924243927002},
     {&#39;accuracy&#39;: 0.6572265625, &#39;crossentropy&#39;: 1.4290560483932495},
     {&#39;accuracy&#39;: 0.66796875, &#39;crossentropy&#39;: 1.2773425579071045},
     {&#39;accuracy&#39;: 0.662109375, &#39;crossentropy&#39;: 1.2364497184753418},
     {&#39;accuracy&#39;: 0.6865234375, &#39;crossentropy&#39;: 1.2086702585220337},
     {&#39;accuracy&#39;: 0.677734375, &#39;crossentropy&#39;: 1.243868350982666},
     {&#39;accuracy&#39;: 0.673828125, &#39;crossentropy&#39;: 1.318315029144287},
     {&#39;accuracy&#39;: 0.6708984375, &#39;crossentropy&#39;: 1.3837350606918335},
     {&#39;accuracy&#39;: 0.6591796875, &#39;crossentropy&#39;: 1.3592121601104736},
     {&#39;accuracy&#39;: 0.6640625, &#39;crossentropy&#39;: 1.3860594034194946},
     {&#39;accuracy&#39;: 0.6787109375, &#39;crossentropy&#39;: 1.261418342590332}],
    &#39;best_epoch&#39;: 46},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.7008,
    &#39;crossentropy&#39;: 1.1200462890625,
    &#39;_timestamp&#39;: 1650146737,
    &#39;_runtime&#39;: 127}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">Experiment</span><span class="p">(</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">acquisition_size</span><span class="o">=</span><span class="n">acquisition_size</span><span class="p">,</span>
        <span class="n">num_pool_samples</span><span class="o">=</span><span class="n">num_pool_samples</span><span class="p">,</span>
        <span class="n">random_acquisition</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">acquisition_size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">num_pool_samples</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">is_run_from_ipython</span><span class="p">()</span> <span class="ow">and</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">store</span> <span class="ow">in</span> <span class="n">embedded_experiments</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">job_id</span><span class="p">]</span>
        <span class="n">config</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="n">job_id</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">store</span><span class="p">[</span><span class="s2">&quot;exception&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="k">raise</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">prettyprinter</span>

<span class="n">prettyprinter</span><span class="o">.</span><span class="n">install_extras</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;dataclasses&quot;</span><span class="p">})</span>

<span class="n">prettyprinter</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[Experiment(seed=0, num_pool_samples=100)]

</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Waiting for W&B process to finish... <strong style="color:green">(success).</strong>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    .wandb-row { display: flex; flex-direction: row; flex-wrap: wrap; width: 100% }
    .wandb-col { display: flex; flex-direction: column; flex-basis: 100%; flex: 1; padding: 10px; }
    </style>
<div class="wandb-row"><div class="wandb-col"><h3>Run history:</h3><br/><table class="wandb"><tr><td>accuracy</td><td></td></tr><tr><td>crossentropy</td><td></td></tr><tr><td>model_training/best_epoch</td><td></td></tr><tr><td>model_training/best_val_accuracy</td><td></td></tr><tr><td>model_training/best_val_crossentropy</td><td></td></tr></table><br/></div><div class="wandb-col"><h3>Run summary:</h3><br/><table class="wandb"><tr><td>accuracy</td><td>0.7008</td></tr><tr><td>crossentropy</td><td>1.12005</td></tr><tr><td>model_training/best_epoch</td><td>46</td></tr><tr><td>model_training/best_val_accuracy</td><td>0.69922</td></tr><tr><td>model_training/best_val_crossentropy</td><td>1.07317</td></tr></table><br/></div></div>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Synced <strong style="color:#cdcd00">rose-durian-280</strong>: <a href="https://wandb.ai/oatml-andreas-kirsch/balds/runs/sa8pzazv" target="_blank">https://wandb.ai/oatml-andreas-kirsch/balds/runs/sa8pzazv</a><br/>Synced 6 W&B file(s), 4 media file(s), 4 artifact file(s) and 0 other file(s)
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find logs at: <code>./wandb/run-20220416_230325-sa8pzazv/logs</code>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

