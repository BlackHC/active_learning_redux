---

title: Experiment


keywords: fastai
sidebar: home_sidebar

summary: "Can we get better by training on our assumptions?"
description: "Can we get better by training on our assumptions?"
nb_path: "09c_rejection_ood_experiment.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 09c_rejection_ood_experiment.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Appended /home/blackhc/PycharmProjects/bald-ical/src to paths
Switched to directory /home/blackhc/PycharmProjects/bald-ical
%load_ext autoreload
%autoreload 2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Import modules and functions were are going to use.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dataclasses</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.utils.data</span>
<span class="kn">from</span> <span class="nn">blackhc.project</span> <span class="kn">import</span> <span class="n">is_run_from_ipython</span>
<span class="kn">from</span> <span class="nn">blackhc.project.experiment</span> <span class="kn">import</span> <span class="n">embedded_experiments</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">Dataset</span>

<span class="kn">import</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="k">as</span> <span class="nn">acquisition_functions</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.acquisition_functions</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CandidateBatchComputer</span><span class="p">,</span>
    <span class="n">CoreSetPoolPredictions</span><span class="p">,</span>
    <span class="n">EvalCandidateBatchComputer</span><span class="p">,</span>
    <span class="n">PoolPredictions</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.active_learning</span> <span class="kn">import</span> <span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">RandomFixedLengthSampler</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.black_box_model_training</span> <span class="kn">import</span> <span class="n">evaluate</span><span class="p">,</span> <span class="n">train</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.dataset_challenges</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AdditiveGaussianNoise</span><span class="p">,</span>
    <span class="n">AliasDataset</span><span class="p">,</span>
    <span class="n">NamedDataset</span><span class="p">,</span>
    <span class="n">get_balanced_sample_indices</span><span class="p">,</span>
    <span class="n">get_base_dataset_index</span><span class="p">,</span>
    <span class="n">get_target</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.datasets</span> <span class="kn">import</span> <span class="n">train_validation_split</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.di</span> <span class="kn">import</span> <span class="n">DependencyInjection</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.fast_mnist</span> <span class="kn">import</span> <span class="n">FastFashionMNIST</span><span class="p">,</span> <span class="n">FastMNIST</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.model_optimizer_factory</span> <span class="kn">import</span> <span class="n">ModelOptimizerFactory</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.models</span> <span class="kn">import</span> <span class="n">MnistOptimizerFactory</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.train_eval_model</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">TrainEvalModel</span><span class="p">,</span>
    <span class="n">TrainSelfDistillationPoolModel</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">batchbald_redux.trained_model</span> <span class="kn">import</span> <span class="n">TrainedMCDropoutModel</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ExperimentDatasets" class="doc_header"><code>class</code> <code>ExperimentDatasets</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/rejection_ood_experiment.py#L50" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ExperimentDatasets</code>(<strong><code>active_learning</code></strong>:<a href="/batchbald_redux/active_learning.html#ActiveLearningData"><code>ActiveLearningData</code></a>, <strong><code>ood_dataset</code></strong>:<a href="/batchbald_redux/dataset_challenges.html#NamedDataset"><code>NamedDataset</code></a>, <strong><code>validation_dataset</code></strong>:<code>Dataset</code>, <strong><code>test_dataset</code></strong>:<code>Dataset</code>, <strong><code>initial_training_set_indices</code></strong>:<code>[&lt;class 'int'&gt;]</code>)</p>
</blockquote>
<p>ExperimentDatasets(active_learning: batchbald_redux.active_learning.ActiveLearningData, ood_dataset: batchbald_redux.dataset_challenges.NamedDataset, validation_dataset: torch.utils.data.dataset.Dataset, test_dataset: torch.utils.data.dataset.Dataset, initial_training_set_indices: [&lt;class 'int'&gt;])</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RejectionOodExperiment" class="doc_header"><code>class</code> <code>RejectionOodExperiment</code><a href="https://github.com/blackhc/batchbald_redux/tree/master/batchbald_redux/rejection_ood_experiment.py#L59" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RejectionOodExperiment</code>(<strong><code>seed</code></strong>:<code>int</code>=<em><code>1337</code></em>, <strong><code>acquisition_size</code></strong>:<code>int</code>=<em><code>5</code></em>, <strong><code>max_training_set</code></strong>:<code>int</code>=<em><code>450</code></em>, <strong><code>num_pool_samples</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>num_eval_samples</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>num_training_samples</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>num_patience_epochs</code></strong>:<code>int</code>=<em><code>3</code></em>, <strong><code>max_training_epochs</code></strong>:<code>int</code>=<em><code>30</code></em>, <strong><code>training_batch_size</code></strong>:<code>int</code>=<em><code>64</code></em>, <strong><code>device</code></strong>:<code>str</code>=<em><code>'cuda'</code></em>, <strong><code>validation_set_size</code></strong>:<code>int</code>=<em><code>1024</code></em>, <strong><code>validation_split_random_state</code></strong>:<code>int</code>=<em><code>0</code></em>, <strong><code>initial_training_set_size</code></strong>:<code>int</code>=<em><code>20</code></em>, <strong><code>samples_per_epoch</code></strong>:<code>int</code>=<em><code>5056</code></em>, <strong><code>mnist_repetitions</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>ood_fmnist_repetitions</code></strong>:<code>int</code>=<em><code>1</code></em>, <strong><code>add_dataset_noise</code></strong>:<code>bool</code>=<em><code>False</code></em>, <strong><code>acquisition_function</code></strong>:<code>Union</code>[<code>Type</code>[<a href="/batchbald_redux/acquisition_functions.html#CandidateBatchComputer"><code>CandidateBatchComputer</code></a>], <code>Type</code>[<a href="/batchbald_redux/acquisition_functions.html#EvalCandidateBatchComputer"><code>EvalCandidateBatchComputer</code></a>]]=<em><code>BALD</code></em>, <strong><code>train_eval_model</code></strong>:<a href="/batchbald_redux/train_eval_model.html#TrainEvalModel"><code>TrainEvalModel</code></a>=<em><code>TrainSelfDistillationPoolModel</code></em>, <strong><code>model_optimizer_factory</code></strong>:<code>Type</code>[<a href="/batchbald_redux/model_optimizer_factory.html#ModelOptimizerFactory"><code>ModelOptimizerFactory</code></a>]=<em><code>MnistOptimizerFactory</code></em>, <strong><code>acquisition_function_args</code></strong>:<code>dict</code>=<em><code>None</code></em>, <strong><code>temperature</code></strong>:<code>float</code>=<em><code>0.0</code></em>)</p>
</blockquote>
<p>RejectionOodExperiment(seed: int = 1337, acquisition_size: int = 5, max_training_set: int = 450, num_pool_samples: int = 20, num_eval_samples: int = 20, num_training_samples: int = 1, num_patience_epochs: int = 3, max_training_epochs: int = 30, training_batch_size: int = 64, device: str = 'cuda', validation_set_size: int = 1024, validation_split_random_state: int = 0, initial_training_set_size: int = 20, samples_per_epoch: int = 5056, mnist_repetitions: int = 1, ood_fmnist_repetitions: int = 1, add_dataset_noise: bool = False, acquisition_function: Union[Type[batchbald_redux.acquisition_functions.CandidateBatchComputer], Type[batchbald_redux.acquisition_functions.EvalCandidateBatchComputer]] = &lt;class 'batchbald_redux.acquisition_functions.BALD'&gt;, train_eval_model: batchbald_redux.train_eval_model.TrainEvalModel = &lt;class 'batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel'&gt;, model_optimizer_factory: Type[batchbald_redux.model_optimizer_factory.ModelOptimizerFactory] = &lt;class 'batchbald_redux.models.MnistOptimizerFactory'&gt;, acquisition_function_args: dict = None, temperature: float = 0.0)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ExperimentDatasets</span><span class="p">:</span>
    <span class="n">active_learning</span><span class="p">:</span> <span class="n">ActiveLearningData</span>
    <span class="n">ood_dataset</span><span class="p">:</span> <span class="n">NamedDataset</span>
    <span class="n">validation_dataset</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span>
    <span class="n">test_dataset</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span>
    <span class="n">initial_training_set_indices</span><span class="p">:</span> <span class="p">[</span><span class="nb">int</span><span class="p">]</span>


<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">RejectionOodExperiment</span><span class="p">:</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1337</span>
    <span class="n">acquisition_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">max_training_set</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">450</span>
    <span class="n">num_pool_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_eval_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">num_training_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">num_patience_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">max_training_epochs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">training_batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span>
    <span class="n">validation_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">validation_split_random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">initial_training_set_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">samples_per_epoch</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5056</span>
    <span class="n">mnist_repetitions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ood_fmnist_repetitions</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">add_dataset_noise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">acquisition_function</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="n">Type</span><span class="p">[</span><span class="n">CandidateBatchComputer</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="n">EvalCandidateBatchComputer</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="n">acquisition_functions</span><span class="o">.</span><span class="n">BALD</span>
    <span class="n">train_eval_model</span><span class="p">:</span> <span class="n">TrainEvalModel</span> <span class="o">=</span> <span class="n">TrainSelfDistillationPoolModel</span>
    <span class="n">model_optimizer_factory</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">ModelOptimizerFactory</span><span class="p">]</span> <span class="o">=</span> <span class="n">MnistOptimizerFactory</span>
    <span class="n">acquisition_function_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_training_set_size</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">ActiveLearningData</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Dataset</span><span class="p">):</span>
        <span class="c1"># num_classes = 10, input_size = 28</span>
        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span>
            <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="s2">&quot;FastMNIST (train)&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mnist_repetitions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mnist_repetitions</span>
            
        <span class="n">ood_dataset</span> <span class="o">=</span> <span class="n">FastFashionMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">ood_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">ood_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;OoD Dataset (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ood_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ood_fmnist_repetitions</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ood_dataset</span> <span class="o">=</span> <span class="n">ood_dataset</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ood_fmnist_repetitions</span>

        <span class="n">train_dataset</span><span class="p">,</span> <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">train_validation_split</span><span class="p">(</span>
            <span class="n">full_train_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
            <span class="n">full_validation_dataset</span><span class="o">=</span><span class="n">train_dataset</span><span class="p">,</span>
            <span class="n">train_labels</span><span class="o">=</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">get_targets</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">(),</span>
            <span class="n">validation_set_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">validation_set_size</span><span class="p">,</span>
            <span class="n">validation_split_random_state</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">validation_split_random_state</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">AliasDataset</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (train; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>
        <span class="n">validation_dataset</span> <span class="o">=</span> <span class="n">AliasDataset</span><span class="p">(</span>
            <span class="n">validation_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (validation; </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span>
        <span class="p">)</span>

        <span class="n">num_classes</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">get_num_classes</span><span class="p">()</span>
        <span class="n">samples_per_class</span> <span class="o">=</span> <span class="n">initial_training_set_size</span> <span class="o">/</span> <span class="n">num_classes</span>
        <span class="n">initial_training_set_indices</span> <span class="o">=</span> <span class="n">get_balanced_sample_indices</span><span class="p">(</span>
            <span class="n">train_dataset</span><span class="p">,</span>
            <span class="n">num_classes</span><span class="o">=</span><span class="n">num_classes</span><span class="p">,</span>
            <span class="n">samples_per_class</span><span class="o">=</span><span class="n">samples_per_class</span><span class="p">,</span>
            <span class="n">seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">validation_split_random_state</span><span class="p">,</span>
        <span class="p">)</span>

        

        <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span> <span class="o">+</span> <span class="n">ood_dataset</span><span class="o">.</span><span class="n">constant_target</span><span class="p">(</span>
            <span class="n">target</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">),</span> <span class="n">num_classes</span><span class="o">=</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">get_num_classes</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_dataset_noise</span><span class="p">:</span>
            <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">AdditiveGaussianNoise</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">FastMNIST</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">test_dataset</span> <span class="o">=</span> <span class="n">NamedDataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;FastMNIST (test, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span><span class="si">}</span><span class="s2"> samples)&quot;</span><span class="p">)</span>

        <span class="n">active_learning_data</span> <span class="o">=</span> <span class="n">ActiveLearningData</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)</span>

        <span class="n">active_learning_data</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">initial_training_set_indices</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ExperimentDatasets</span><span class="p">(</span>
            <span class="n">active_learning</span><span class="o">=</span><span class="n">active_learning_data</span><span class="p">,</span>
            <span class="n">validation_dataset</span><span class="o">=</span><span class="n">validation_dataset</span><span class="p">,</span>
            <span class="n">test_dataset</span><span class="o">=</span><span class="n">test_dataset</span><span class="p">,</span>
            <span class="n">initial_training_set_indices</span><span class="o">=</span><span class="n">initial_training_set_indices</span><span class="p">,</span>
            <span class="n">ood_dataset</span><span class="o">=</span><span class="n">ood_dataset</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Simple Dependency Injection</span>
    <span class="k">def</span> <span class="nf">create_acquisition_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">DependencyInjection</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="p">[</span><span class="n">PoolPredictions</span><span class="p">,</span> <span class="n">CoreSetPoolPredictions</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">di</span><span class="o">.</span><span class="n">create_dataclass_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acquisition_function</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_train_eval_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime_config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TrainEvalModel</span><span class="p">:</span>
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="o">**</span><span class="n">runtime_config</span><span class="p">}</span>
        <span class="n">di</span> <span class="o">=</span> <span class="n">DependencyInjection</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="n">di</span><span class="o">.</span><span class="n">create_dataclass_type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">train_eval_model</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">store</span><span class="p">):</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span>

        <span class="c1"># Active Learning setup</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initial_training_set_size</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;dataset_info&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">training</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">base_dataset</span><span class="p">),</span> <span class="n">test</span><span class="o">=</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">))</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;initial_training_set_indices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">initial_training_set_indices</span>

        <span class="c1"># initial_training_set_indices = data.active_learning.get_random_pool_indices(self.initial_set_size)</span>
        <span class="c1"># initial_training_set_indices = get_balanced_sample_indices(</span>
        <span class="c1">#     data.active_learning.pool_dataset, 10, self.initial_set_size // 10</span>
        <span class="c1"># )</span>

        <span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
            <span class="n">sampler</span><span class="o">=</span><span class="n">RandomFixedLengthSampler</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">samples_per_epoch</span><span class="p">),</span>
            <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">pool_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="n">validation_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">validation_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">test_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">active_learning_steps</span> <span class="o">=</span> <span class="n">store</span><span class="p">[</span><span class="s2">&quot;active_learning_steps&quot;</span><span class="p">]</span>

        <span class="n">acquisition_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_acquisition_function</span><span class="p">()</span>

        <span class="n">num_oracle_queries</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Active Training Loop</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">training_set_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Training set size </span><span class="si">{</span><span class="n">training_set_size</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>

            <span class="c1"># iteration_log = dict(training={}, pool_training={}, evaluation_metrics=None, acquisition=None)</span>
            <span class="n">active_learning_steps</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
            <span class="n">iteration_log</span> <span class="o">=</span> <span class="n">active_learning_steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">model_optimizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_optimizer_factory</span><span class="p">()</span><span class="o">.</span><span class="n">create_model_optimizer</span><span class="p">()</span>

            <span class="n">train</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
                <span class="n">optimizer</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">optimizer</span><span class="p">,</span>
                <span class="n">training_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_training_samples</span><span class="p">,</span>
                <span class="n">validation_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_eval_samples</span><span class="p">,</span>
                <span class="n">train_loader</span><span class="o">=</span><span class="n">train_loader</span><span class="p">,</span>
                <span class="n">validation_loader</span><span class="o">=</span><span class="n">validation_loader</span><span class="p">,</span>
                <span class="n">patience</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_patience_epochs</span><span class="p">,</span>
                <span class="n">max_epochs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">max_training_epochs</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                <span class="n">training_log</span><span class="o">=</span><span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="n">evaluation_metrics</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
                <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_eval_samples</span><span class="p">,</span> <span class="n">loader</span><span class="o">=</span><span class="n">test_loader</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
            <span class="p">)</span>
            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;evaluation_metrics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluation_metrics</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Perf after training </span><span class="si">{</span><span class="n">evaluation_metrics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Safety: don&#39;t attempt to acquire more than 2x the max trainung set size.</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">training_set_size</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_training_set</span>
                <span class="ow">or</span> <span class="n">num_oracle_queries</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">initial_training_set_indices</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_training_set</span> <span class="o">*</span> <span class="mi">2</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
                <span class="k">break</span>

            <span class="n">trained_model</span> <span class="o">=</span> <span class="n">TrainedMCDropoutModel</span><span class="p">(</span><span class="n">num_pool_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_pool_samples</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model_optimizer</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acquisition_function</span><span class="p">,</span> <span class="n">CandidateBatchComputer</span><span class="p">):</span>
                <span class="n">candidate_batch</span> <span class="o">=</span> <span class="n">acquisition_function</span><span class="o">.</span><span class="n">compute_candidate_batch</span><span class="p">(</span><span class="n">trained_model</span><span class="p">,</span> <span class="n">pool_loader</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">acquisition_function</span><span class="p">,</span> <span class="n">EvalCandidateBatchComputer</span><span class="p">):</span>
                <span class="n">current_max_epochs</span> <span class="o">=</span> <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;training&quot;</span><span class="p">][</span><span class="s2">&quot;best_epoch&quot;</span><span class="p">]</span>

                <span class="n">train_eval_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_train_eval_model</span><span class="p">(</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">max_epochs</span><span class="o">=</span><span class="n">current_max_epochs</span><span class="p">,</span>
                        <span class="n">training_dataset</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">training_dataset</span><span class="p">,</span>
                        <span class="n">pool_dataset</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span>
                        <span class="n">validation_loader</span><span class="o">=</span><span class="n">validation_loader</span><span class="p">,</span>
                        <span class="n">trained_model</span><span class="o">=</span><span class="n">trained_model</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

                <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;eval_training&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">trained_eval_model</span> <span class="o">=</span> <span class="n">train_eval_model</span><span class="p">(</span><span class="n">training_log</span><span class="o">=</span><span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;eval_training&quot;</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

                <span class="n">candidate_batch</span> <span class="o">=</span> <span class="n">acquisition_function</span><span class="o">.</span><span class="n">compute_candidate_batch</span><span class="p">(</span>
                    <span class="n">trained_model</span><span class="p">,</span> <span class="n">trained_eval_model</span><span class="p">,</span> <span class="n">pool_loader</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown acquisition function </span><span class="si">{</span><span class="n">acquisition_function</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>

            <span class="n">candidate_global_indices</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;ood&quot;</span> <span class="k">if</span> <span class="n">base_di</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">ood_dataset</span> <span class="k">else</span> <span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">base_di</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">candidate_batch</span><span class="o">.</span><span class="n">indices</span>
                <span class="k">for</span> <span class="n">base_di</span> <span class="ow">in</span> <span class="p">[</span><span class="n">get_base_dataset_index</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span> <span class="n">index</span><span class="p">)]</span>
            <span class="p">]</span>
            <span class="n">candidate_labels</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">get_target</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">pool_dataset</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">candidate_batch</span><span class="o">.</span><span class="n">indices</span>
            <span class="p">]</span>

            <span class="n">iteration_log</span><span class="p">[</span><span class="s2">&quot;acquisition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">indices</span><span class="o">=</span><span class="n">candidate_global_indices</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">candidate_labels</span><span class="p">,</span> <span class="n">scores</span><span class="o">=</span><span class="n">candidate_batch</span><span class="o">.</span><span class="n">scores</span>
            <span class="p">)</span>
            <span class="n">num_oracle_queries</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidate_labels</span><span class="p">)</span>

            <span class="n">data</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span>
                <span class="p">[</span><span class="n">index</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">candidate_batch</span><span class="o">.</span><span class="n">indices</span><span class="p">,</span> <span class="n">candidate_labels</span><span class="p">)</span> <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">candidate_batch</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">candidate_global_indices</span><span class="p">)</span>

            <span class="n">ls</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">candidate_labels</span><span class="p">,</span> <span class="n">candidate_batch</span><span class="o">.</span><span class="n">scores</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Acquiring (label, score)s: </span><span class="si">{</span><span class="n">ls</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">RejectionOodExperiment</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">active_learning</span><span class="o">.</span><span class="n">base_dataset</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(FastMNIST (train; 58976 samples)) + (&#39;OoD Dataset (60000 samples)&#39; | constant_target{&#39;target&#39;: tensor(-1), &#39;num_classes&#39;: 10})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">RejectionOodExperiment</span><span class="p">(</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">1120</span><span class="p">,</span>
    <span class="n">max_training_epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">max_training_set</span><span class="o">=</span><span class="mi">130</span><span class="p">,</span>
    <span class="n">acquisition_function</span><span class="o">=</span><span class="n">acquisition_functions</span><span class="o">.</span><span class="n">TemperedBALD</span><span class="p">,</span>
    <span class="n">acquisition_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">num_pool_samples</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Resolved: Random with {&#39;acquisition_size&#39;: 10}
Creating: Random(acquisition_size=10)
Training set size 20:
Perf after training {&#39;accuracy&#39;: 0.1129, &#39;crossentropy&#39;: 2.35244740562439}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([ 86778,  47964,  17735,  45118,  46173,  96771, 106260,  87623,
        99822,  94075]))
[(&#39;ood&#39;, 27822), (&#39;id&#39;, 32367), (&#39;id&#39;, 55086), (&#39;id&#39;, 53929), (&#39;id&#39;, 48696), (&#39;ood&#39;, 37815), (&#39;ood&#39;, 47304), (&#39;ood&#39;, 28667), (&#39;ood&#39;, 40866), (&#39;ood&#39;, 35119)]
Acquiring (label, score)s: -1 (0.0), 1 (0.0), 7 (0.0), 6 (0.0), 2 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0)
Training set size 24:
Perf after training {&#39;accuracy&#39;: 0.071, &#39;crossentropy&#39;: 2.376102001571655}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([  8766,  38225, 108222,  11654,    237,  75761,  83561,  92896,
        14097,  13219]))
[(&#39;id&#39;, 41002), (&#39;id&#39;, 35972), (&#39;ood&#39;, 49270), (&#39;id&#39;, 37994), (&#39;id&#39;, 44052), (&#39;ood&#39;, 16809), (&#39;ood&#39;, 24609), (&#39;ood&#39;, 33944), (&#39;id&#39;, 58767), (&#39;id&#39;, 6319)]
Acquiring (label, score)s: 7 (0.0), 0 (0.0), -1 (0.0), 7 (0.0), 4 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), 1 (0.0), 7 (0.0)
Training set size 30:
Perf after training {&#39;accuracy&#39;: 0.111, &#39;crossentropy&#39;: 2.3350587436676027}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([115533,  27030,  28967,  25277,   1064,  60903,  10192,  73305,
        50749,  44236]))
[(&#39;ood&#39;, 56587), (&#39;id&#39;, 20397), (&#39;id&#39;, 6873), (&#39;id&#39;, 56019), (&#39;id&#39;, 48733), (&#39;ood&#39;, 1957), (&#39;id&#39;, 26231), (&#39;ood&#39;, 14359), (&#39;id&#39;, 41930), (&#39;id&#39;, 1835)]
Acquiring (label, score)s: -1 (0.0), 3 (0.0), 8 (0.0), 8 (0.0), 5 (0.0), -1 (0.0), 8 (0.0), -1 (0.0), 4 (0.0), 6 (0.0)
Training set size 37:
Perf after training {&#39;accuracy&#39;: 0.1119, &#39;crossentropy&#39;: 2.3316191219329836}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([23662, 19340, 38510, 19965, 53349, 66832, 60762, 35782, 98374,
       73435]))
[(&#39;id&#39;, 43865), (&#39;id&#39;, 53636), (&#39;id&#39;, 27693), (&#39;id&#39;, 35820), (&#39;id&#39;, 2731), (&#39;ood&#39;, 7893), (&#39;ood&#39;, 1823), (&#39;id&#39;, 31015), (&#39;ood&#39;, 39435), (&#39;ood&#39;, 14496)]
Acquiring (label, score)s: 3 (0.0), 8 (0.0), 1 (0.0), 1 (0.0), 1 (0.0), -1 (0.0), -1 (0.0), 0 (0.0), -1 (0.0), -1 (0.0)
Training set size 43:
Perf after training {&#39;accuracy&#39;: 0.1152, &#39;crossentropy&#39;: 2.3408010501861574}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([ 81123, 108132,  99683,  92369,  89428, 115970,  70739,  30373,
        55571, 107383]))
[(&#39;ood&#39;, 22190), (&#39;ood&#39;, 49199), (&#39;ood&#39;, 40750), (&#39;ood&#39;, 33436), (&#39;ood&#39;, 30495), (&#39;ood&#39;, 57037), (&#39;ood&#39;, 11806), (&#39;id&#39;, 13194), (&#39;id&#39;, 33972), (&#39;ood&#39;, 48450)]
Acquiring (label, score)s: -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), 9 (0.0), 5 (0.0), -1 (0.0)
Training set size 45:
Perf after training {&#39;accuracy&#39;: 0.0855, &#39;crossentropy&#39;: 2.3611250312805176}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([98193,  5015,  4959, 58168, 22688, 37290,  9707, 94163, 95050,
       49122]))
[(&#39;ood&#39;, 39262), (&#39;id&#39;, 34937), (&#39;id&#39;, 15956), (&#39;id&#39;, 1193), (&#39;id&#39;, 44982), (&#39;id&#39;, 24303), (&#39;id&#39;, 30815), (&#39;ood&#39;, 35232), (&#39;ood&#39;, 36119), (&#39;id&#39;, 17484)]
Acquiring (label, score)s: -1 (0.0), 1 (0.0), 8 (0.0), 8 (0.0), 9 (0.0), 2 (0.0), 4 (0.0), -1 (0.0), -1 (0.0), 6 (0.0)
Training set size 52:
Perf after training {&#39;accuracy&#39;: 0.0985, &#39;crossentropy&#39;: 2.33388900718689}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([ 77943, 109136,  84272,  80072,  80882,  25725,  63094,  53451,
        53245,  63271]))
[(&#39;ood&#39;, 19019), (&#39;ood&#39;, 50212), (&#39;ood&#39;, 25348), (&#39;ood&#39;, 21148), (&#39;ood&#39;, 21958), (&#39;id&#39;, 28372), (&#39;ood&#39;, 4170), (&#39;id&#39;, 40862), (&#39;id&#39;, 6085), (&#39;ood&#39;, 4347)]
Acquiring (label, score)s: -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), 5 (0.0), -1 (0.0), 6 (0.0), 6 (0.0), -1 (0.0)
Training set size 55:
Perf after training {&#39;accuracy&#39;: 0.1075, &#39;crossentropy&#39;: 2.3253658111572264}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([64098, 58430, 94193, 81355, 59229, 75528,  7808, 85593, 71759,
       10806]))
[(&#39;ood&#39;, 5177), (&#39;id&#39;, 46455), (&#39;ood&#39;, 35272), (&#39;ood&#39;, 22434), (&#39;ood&#39;, 308), (&#39;ood&#39;, 16607), (&#39;id&#39;, 50405), (&#39;ood&#39;, 26672), (&#39;ood&#39;, 12838), (&#39;id&#39;, 21140)]
Acquiring (label, score)s: -1 (0.0), 6 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), 4 (0.0), -1 (0.0), -1 (0.0), 4 (0.0)
Training set size 58:
Perf after training {&#39;accuracy&#39;: 0.1254, &#39;crossentropy&#39;: 2.3452716808319094}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([ 80225,   3930,  18276,  62847, 108357,  85340,  12355,  71908,
        53886, 102166]))
[(&#39;ood&#39;, 21307), (&#39;id&#39;, 45937), (&#39;id&#39;, 35010), (&#39;ood&#39;, 3929), (&#39;ood&#39;, 49439), (&#39;ood&#39;, 26422), (&#39;id&#39;, 15513), (&#39;ood&#39;, 12990), (&#39;id&#39;, 46837), (&#39;ood&#39;, 43248)]
Acquiring (label, score)s: -1 (0.0), 7 (0.0), 3 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), 7 (0.0), -1 (0.0), 0 (0.0), -1 (0.0)
Training set size 62:
Perf after training {&#39;accuracy&#39;: 0.0982, &#39;crossentropy&#39;: 2.338535634994507}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([ 61884,  18854,  55718,  45165,  27846,  21449,  67053,   5345,
        33998, 105155]))
[(&#39;ood&#39;, 2970), (&#39;id&#39;, 33981), (&#39;id&#39;, 17247), (&#39;id&#39;, 28983), (&#39;id&#39;, 22921), (&#39;id&#39;, 43607), (&#39;ood&#39;, 8139), (&#39;id&#39;, 45633), (&#39;id&#39;, 48652), (&#39;ood&#39;, 46241)]
Acquiring (label, score)s: -1 (0.0), 9 (0.0), 5 (0.0), 3 (0.0), 7 (0.0), 7 (0.0), -1 (0.0), 6 (0.0), 8 (0.0), -1 (0.0)
Training set size 69:
Perf after training {&#39;accuracy&#39;: 0.1139, &#39;crossentropy&#39;: 2.3268737857818604}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([64192, 92772, 84908, 53170, 70219, 60172, 26063, 52007, 98932,
       27923]))
[(&#39;ood&#39;, 5285), (&#39;ood&#39;, 33865), (&#39;ood&#39;, 26001), (&#39;id&#39;, 47531), (&#39;ood&#39;, 11312), (&#39;ood&#39;, 1265), (&#39;id&#39;, 56554), (&#39;id&#39;, 16369), (&#39;ood&#39;, 40025), (&#39;id&#39;, 19670)]
Acquiring (label, score)s: -1 (0.0), -1 (0.0), -1 (0.0), 2 (0.0), -1 (0.0), -1 (0.0), 5 (0.0), 7 (0.0), -1 (0.0), 5 (0.0)
Training set size 73:
Perf after training {&#39;accuracy&#39;: 0.0858, &#39;crossentropy&#39;: 2.340250019454956}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([111734,  81291,  30905,  79371,  30139, 104318,   2463,   2854,
        24074,  58613]))
[(&#39;ood&#39;, 52831), (&#39;ood&#39;, 22388), (&#39;id&#39;, 17241), (&#39;ood&#39;, 20468), (&#39;id&#39;, 22538), (&#39;ood&#39;, 45415), (&#39;id&#39;, 56063), (&#39;id&#39;, 20651), (&#39;id&#39;, 52190), (&#39;id&#39;, 48078)]
Acquiring (label, score)s: -1 (0.0), -1 (0.0), 2 (0.0), -1 (0.0), 1 (0.0), -1 (0.0), 5 (0.0), 4 (0.0), 5 (0.0), 5 (0.0)
Training set size 79:
Perf after training {&#39;accuracy&#39;: 0.1047, &#39;crossentropy&#39;: 2.3441019859313963}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([ 82152,   2310,  10306,  24410,  19798,  87281,  44936, 105194,
        11625,  59619]))
[(&#39;ood&#39;, 23255), (&#39;id&#39;, 49078), (&#39;id&#39;, 34456), (&#39;id&#39;, 7426), (&#39;id&#39;, 32375), (&#39;ood&#39;, 28384), (&#39;id&#39;, 53279), (&#39;ood&#39;, 46297), (&#39;id&#39;, 23174), (&#39;ood&#39;, 722)]
Acquiring (label, score)s: -1 (0.0), 4 (0.0), 6 (0.0), 4 (0.0), 8 (0.0), -1 (0.0), 9 (0.0), -1 (0.0), 4 (0.0), -1 (0.0)
Training set size 85:
Perf after training {&#39;accuracy&#39;: 0.1025, &#39;crossentropy&#39;: 2.3361153217315676}
CandidateBatch(scores=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], indices=array([115864,  71738, 110899,  93916,   2347,  20707,  33210,  48024,
        47197,  33484]))
[(&#39;ood&#39;, 56973), (&#39;ood&#39;, 12847), (&#39;ood&#39;, 52008), (&#39;ood&#39;, 35025), (&#39;id&#39;, 14647), (&#39;id&#39;, 48238), (&#39;id&#39;, 41955), (&#39;id&#39;, 44784), (&#39;id&#39;, 37767), (&#39;id&#39;, 5447)]
Acquiring (label, score)s: -1 (0.0), -1 (0.0), -1 (0.0), -1 (0.0), 9 (0.0), 2 (0.0), 2 (0.0), 2 (0.0), 4 (0.0), 7 (0.0)
Training set size 91:
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Engine run is terminating due to exception: .
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-26-2c5223f84226&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span> 
<span class="ansi-green-intense-fg ansi-bold">     14</span> results <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">}</span>
<span class="ansi-green-fg">---&gt; 15</span><span class="ansi-red-fg"> </span>experiment<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>results<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-25-134a7e070500&gt;</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self, store)</span>
<span class="ansi-green-intense-fg ansi-bold">    141</span>             )
<span class="ansi-green-intense-fg ansi-bold">    142</span> 
<span class="ansi-green-fg">--&gt; 143</span><span class="ansi-red-fg">             evaluation_metrics = evaluate(
</span><span class="ansi-green-intense-fg ansi-bold">    144</span>                 model<span class="ansi-blue-fg">=</span>model_optimizer<span class="ansi-blue-fg">.</span>model<span class="ansi-blue-fg">,</span> num_samples<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>num_eval_samples<span class="ansi-blue-fg">,</span> loader<span class="ansi-blue-fg">=</span>test_loader<span class="ansi-blue-fg">,</span> device<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>device
<span class="ansi-green-intense-fg ansi-bold">    145</span>             )

<span class="ansi-green-fg">~/PycharmProjects/bald-ical/batchbald_redux/black_box_model_training.py</span> in <span class="ansi-cyan-fg">evaluate</span><span class="ansi-blue-fg">(model, num_samples, loader, device, loss)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span> 
<span class="ansi-green-intense-fg ansi-bold">    153</span>     <span class="ansi-red-fg"># Kick everything off</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">     </span>evaluator<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>loader<span class="ansi-blue-fg">,</span> max_epochs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span> 
<span class="ansi-green-intense-fg ansi-bold">    156</span>     <span class="ansi-green-fg">return</span> evaluator<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">.</span>metrics

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/engine/engine.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self, data, max_epochs, epoch_length, seed)</span>
<span class="ansi-green-intense-fg ansi-bold">    689</span> 
<span class="ansi-green-intense-fg ansi-bold">    690</span>         self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">.</span>dataloader <span class="ansi-blue-fg">=</span> data
<span class="ansi-green-fg">--&gt; 691</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_internal_run<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    692</span> 
<span class="ansi-green-intense-fg ansi-bold">    693</span>     <span class="ansi-blue-fg">@</span>staticmethod

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/engine/engine.py</span> in <span class="ansi-cyan-fg">_internal_run</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    760</span>             self<span class="ansi-blue-fg">.</span>_dataloader_iter <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
<span class="ansi-green-intense-fg ansi-bold">    761</span>             self<span class="ansi-blue-fg">.</span>logger<span class="ansi-blue-fg">.</span>error<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#34;Engine run is terminating due to exception: %s.&#34;</span><span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 762</span><span class="ansi-red-fg">             </span>self<span class="ansi-blue-fg">.</span>_handle_exception<span class="ansi-blue-fg">(</span>e<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    763</span> 
<span class="ansi-green-intense-fg ansi-bold">    764</span>         self<span class="ansi-blue-fg">.</span>_dataloader_iter <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/engine/engine.py</span> in <span class="ansi-cyan-fg">_handle_exception</span><span class="ansi-blue-fg">(self, e)</span>
<span class="ansi-green-intense-fg ansi-bold">    465</span>             self<span class="ansi-blue-fg">.</span>_fire_event<span class="ansi-blue-fg">(</span>Events<span class="ansi-blue-fg">.</span>EXCEPTION_RAISED<span class="ansi-blue-fg">,</span> e<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    466</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 467</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> e
<span class="ansi-green-intense-fg ansi-bold">    468</span> 
<span class="ansi-green-intense-fg ansi-bold">    469</span>     <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/engine/engine.py</span> in <span class="ansi-cyan-fg">_internal_run</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    728</span>                     self<span class="ansi-blue-fg">.</span>_setup_engine<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    729</span> 
<span class="ansi-green-fg">--&gt; 730</span><span class="ansi-red-fg">                 </span>time_taken <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_run_once_on_dataset<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    731</span>                 <span class="ansi-red-fg"># time is available for handlers but must be update after fire</span>
<span class="ansi-green-intense-fg ansi-bold">    732</span>                 self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">.</span>times<span class="ansi-blue-fg">[</span>Events<span class="ansi-blue-fg">.</span>EPOCH_COMPLETED<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> time_taken

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/engine/engine.py</span> in <span class="ansi-cyan-fg">_run_once_on_dataset</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    810</span>                 self<span class="ansi-blue-fg">.</span>_fire_event<span class="ansi-blue-fg">(</span>Events<span class="ansi-blue-fg">.</span>ITERATION_STARTED<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    811</span>                 self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">.</span>output <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_process_function<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>state<span class="ansi-blue-fg">.</span>batch<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 812</span><span class="ansi-red-fg">                 </span>self<span class="ansi-blue-fg">.</span>_fire_event<span class="ansi-blue-fg">(</span>Events<span class="ansi-blue-fg">.</span>ITERATION_COMPLETED<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    813</span> 
<span class="ansi-green-intense-fg ansi-bold">    814</span>                 <span class="ansi-red-fg"># TODO: remove refs on batch to avoid high mem consumption ? -&gt; need verification</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/engine/engine.py</span> in <span class="ansi-cyan-fg">_fire_event</span><span class="ansi-blue-fg">(self, event_name, *event_args, **event_kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    421</span>                 kwargs<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>event_kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    422</span>                 first<span class="ansi-blue-fg">,</span> others <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> <span class="ansi-blue-fg">(</span>args <span class="ansi-green-fg">and</span> args<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">==</span> self<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 423</span><span class="ansi-red-fg">                 </span>func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>first<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">(</span>event_args <span class="ansi-blue-fg">+</span> others<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    424</span> 
<span class="ansi-green-intense-fg ansi-bold">    425</span>     <span class="ansi-green-fg">def</span> fire_event<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> event_name<span class="ansi-blue-fg">:</span> Any<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/torch/autograd/grad_mode.py</span> in <span class="ansi-cyan-fg">decorate_context</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     24</span>         <span class="ansi-green-fg">def</span> decorate_context<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     25</span>             <span class="ansi-green-fg">with</span> self<span class="ansi-blue-fg">.</span>__class__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 26</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span>         <span class="ansi-green-fg">return</span> cast<span class="ansi-blue-fg">(</span>F<span class="ansi-blue-fg">,</span> decorate_context<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span> 

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/metrics/metric.py</span> in <span class="ansi-cyan-fg">iteration_completed</span><span class="ansi-blue-fg">(self, engine)</span>
<span class="ansi-green-intense-fg ansi-bold">    281</span>                 )
<span class="ansi-green-intense-fg ansi-bold">    282</span>             output <span class="ansi-blue-fg">=</span> tuple<span class="ansi-blue-fg">(</span>output<span class="ansi-blue-fg">[</span>k<span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> self<span class="ansi-blue-fg">.</span>required_output_keys<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 283</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span>output<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    284</span> 
<span class="ansi-green-intense-fg ansi-bold">    285</span>     <span class="ansi-green-fg">def</span> completed<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> engine<span class="ansi-blue-fg">:</span> Engine<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">:</span> str<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-&gt;</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/metrics/metric.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    552</span>     <span class="ansi-blue-fg">@</span>wraps<span class="ansi-blue-fg">(</span>func<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    553</span>     <span class="ansi-green-fg">def</span> wrapper<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 554</span><span class="ansi-red-fg">         </span>func<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    555</span>         self<span class="ansi-blue-fg">.</span>_is_reduced <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">False</span>
<span class="ansi-green-intense-fg ansi-bold">    556</span> 

<span class="ansi-green-fg">~/anaconda3/envs/active_learning/lib/python3.8/site-packages/ignite/metrics/accuracy.py</span> in <span class="ansi-cyan-fg">update</span><span class="ansi-blue-fg">(self, output)</span>
<span class="ansi-green-intense-fg ansi-bold">    162</span>             correct <span class="ansi-blue-fg">=</span> torch<span class="ansi-blue-fg">.</span>all<span class="ansi-blue-fg">(</span>y <span class="ansi-blue-fg">==</span> y_pred<span class="ansi-blue-fg">.</span>type_as<span class="ansi-blue-fg">(</span>y<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> dim<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    163</span> 
<span class="ansi-green-fg">--&gt; 164</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_num_correct <span class="ansi-blue-fg">+=</span> torch<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span>correct<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>item<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    165</span>         self<span class="ansi-blue-fg">.</span>_num_examples <span class="ansi-blue-fg">+=</span> correct<span class="ansi-blue-fg">.</span>shape<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    166</span> 

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;dataset_info&#39;: {&#39;training&#39;: &#34;(FastMNIST (train; 58976 samples)) + (&#39;OoD Dataset (60000 samples)&#39; | constant_target{&#39;target&#39;: tensor(-1, device=&#39;cuda:0&#39;), &#39;num_classes&#39;: 10})&#34;,
  &#39;test&#39;: &#34;&#39;FastMNIST (test, 10000 samples)&#39;&#34;},
 &#39;initial_training_set_indices&#39;: [30392,
  53434,
  12640,
  8533,
  22304,
  37915,
  58226,
  44119,
  3091,
  14640,
  58125,
  39579,
  43812,
  53689,
  52296,
  46037,
  22015,
  40334,
  57520,
  43803],
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1129,
    &#39;crossentropy&#39;: 2.35244740562439},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 27822),
     (&#39;id&#39;, 32367),
     (&#39;id&#39;, 55086),
     (&#39;id&#39;, 53929),
     (&#39;id&#39;, 48696),
     (&#39;ood&#39;, 37815),
     (&#39;ood&#39;, 47304),
     (&#39;ood&#39;, 28667),
     (&#39;ood&#39;, 40866),
     (&#39;ood&#39;, 35119)],
    &#39;labels&#39;: [-1, 1, 7, 6, 2, -1, -1, -1, -1, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.071,
    &#39;crossentropy&#39;: 2.376102001571655},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;id&#39;, 41002),
     (&#39;id&#39;, 35972),
     (&#39;ood&#39;, 49270),
     (&#39;id&#39;, 37994),
     (&#39;id&#39;, 44052),
     (&#39;ood&#39;, 16809),
     (&#39;ood&#39;, 24609),
     (&#39;ood&#39;, 33944),
     (&#39;id&#39;, 58767),
     (&#39;id&#39;, 6319)],
    &#39;labels&#39;: [7, 0, -1, 7, 4, -1, -1, -1, 1, 7],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.111,
    &#39;crossentropy&#39;: 2.3350587436676027},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 56587),
     (&#39;id&#39;, 20397),
     (&#39;id&#39;, 6873),
     (&#39;id&#39;, 56019),
     (&#39;id&#39;, 48733),
     (&#39;ood&#39;, 1957),
     (&#39;id&#39;, 26231),
     (&#39;ood&#39;, 14359),
     (&#39;id&#39;, 41930),
     (&#39;id&#39;, 1835)],
    &#39;labels&#39;: [-1, 3, 8, 8, 5, -1, 8, -1, 4, 6],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1119,
    &#39;crossentropy&#39;: 2.3316191219329836},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;id&#39;, 43865),
     (&#39;id&#39;, 53636),
     (&#39;id&#39;, 27693),
     (&#39;id&#39;, 35820),
     (&#39;id&#39;, 2731),
     (&#39;ood&#39;, 7893),
     (&#39;ood&#39;, 1823),
     (&#39;id&#39;, 31015),
     (&#39;ood&#39;, 39435),
     (&#39;ood&#39;, 14496)],
    &#39;labels&#39;: [3, 8, 1, 1, 1, -1, -1, 0, -1, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1152,
    &#39;crossentropy&#39;: 2.3408010501861574},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 22190),
     (&#39;ood&#39;, 49199),
     (&#39;ood&#39;, 40750),
     (&#39;ood&#39;, 33436),
     (&#39;ood&#39;, 30495),
     (&#39;ood&#39;, 57037),
     (&#39;ood&#39;, 11806),
     (&#39;id&#39;, 13194),
     (&#39;id&#39;, 33972),
     (&#39;ood&#39;, 48450)],
    &#39;labels&#39;: [-1, -1, -1, -1, -1, -1, -1, 9, 5, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.0855,
    &#39;crossentropy&#39;: 2.3611250312805176},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 39262),
     (&#39;id&#39;, 34937),
     (&#39;id&#39;, 15956),
     (&#39;id&#39;, 1193),
     (&#39;id&#39;, 44982),
     (&#39;id&#39;, 24303),
     (&#39;id&#39;, 30815),
     (&#39;ood&#39;, 35232),
     (&#39;ood&#39;, 36119),
     (&#39;id&#39;, 17484)],
    &#39;labels&#39;: [-1, 1, 8, 8, 9, 2, 4, -1, -1, 6],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.0985,
    &#39;crossentropy&#39;: 2.33388900718689},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 19019),
     (&#39;ood&#39;, 50212),
     (&#39;ood&#39;, 25348),
     (&#39;ood&#39;, 21148),
     (&#39;ood&#39;, 21958),
     (&#39;id&#39;, 28372),
     (&#39;ood&#39;, 4170),
     (&#39;id&#39;, 40862),
     (&#39;id&#39;, 6085),
     (&#39;ood&#39;, 4347)],
    &#39;labels&#39;: [-1, -1, -1, -1, -1, 5, -1, 6, 6, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1075,
    &#39;crossentropy&#39;: 2.3253658111572264},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 5177),
     (&#39;id&#39;, 46455),
     (&#39;ood&#39;, 35272),
     (&#39;ood&#39;, 22434),
     (&#39;ood&#39;, 308),
     (&#39;ood&#39;, 16607),
     (&#39;id&#39;, 50405),
     (&#39;ood&#39;, 26672),
     (&#39;ood&#39;, 12838),
     (&#39;id&#39;, 21140)],
    &#39;labels&#39;: [-1, 6, -1, -1, -1, -1, 4, -1, -1, 4],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1254,
    &#39;crossentropy&#39;: 2.3452716808319094},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 21307),
     (&#39;id&#39;, 45937),
     (&#39;id&#39;, 35010),
     (&#39;ood&#39;, 3929),
     (&#39;ood&#39;, 49439),
     (&#39;ood&#39;, 26422),
     (&#39;id&#39;, 15513),
     (&#39;ood&#39;, 12990),
     (&#39;id&#39;, 46837),
     (&#39;ood&#39;, 43248)],
    &#39;labels&#39;: [-1, 7, 3, -1, -1, -1, 7, -1, 0, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.0982,
    &#39;crossentropy&#39;: 2.338535634994507},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 2970),
     (&#39;id&#39;, 33981),
     (&#39;id&#39;, 17247),
     (&#39;id&#39;, 28983),
     (&#39;id&#39;, 22921),
     (&#39;id&#39;, 43607),
     (&#39;ood&#39;, 8139),
     (&#39;id&#39;, 45633),
     (&#39;id&#39;, 48652),
     (&#39;ood&#39;, 46241)],
    &#39;labels&#39;: [-1, 9, 5, 3, 7, 7, -1, 6, 8, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1139,
    &#39;crossentropy&#39;: 2.3268737857818604},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 5285),
     (&#39;ood&#39;, 33865),
     (&#39;ood&#39;, 26001),
     (&#39;id&#39;, 47531),
     (&#39;ood&#39;, 11312),
     (&#39;ood&#39;, 1265),
     (&#39;id&#39;, 56554),
     (&#39;id&#39;, 16369),
     (&#39;ood&#39;, 40025),
     (&#39;id&#39;, 19670)],
    &#39;labels&#39;: [-1, -1, -1, 2, -1, -1, 5, 7, -1, 5],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.0858,
    &#39;crossentropy&#39;: 2.340250019454956},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 52831),
     (&#39;ood&#39;, 22388),
     (&#39;id&#39;, 17241),
     (&#39;ood&#39;, 20468),
     (&#39;id&#39;, 22538),
     (&#39;ood&#39;, 45415),
     (&#39;id&#39;, 56063),
     (&#39;id&#39;, 20651),
     (&#39;id&#39;, 52190),
     (&#39;id&#39;, 48078)],
    &#39;labels&#39;: [-1, -1, 2, -1, 1, -1, 5, 4, 5, 5],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1047,
    &#39;crossentropy&#39;: 2.3441019859313963},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 23255),
     (&#39;id&#39;, 49078),
     (&#39;id&#39;, 34456),
     (&#39;id&#39;, 7426),
     (&#39;id&#39;, 32375),
     (&#39;ood&#39;, 28384),
     (&#39;id&#39;, 53279),
     (&#39;ood&#39;, 46297),
     (&#39;id&#39;, 23174),
     (&#39;ood&#39;, 722)],
    &#39;labels&#39;: [-1, 4, 6, 4, 8, -1, 9, -1, 4, -1],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None},
   &#39;evaluation_metrics&#39;: {&#39;accuracy&#39;: 0.1025,
    &#39;crossentropy&#39;: 2.3361153217315676},
   &#39;acquisition&#39;: {&#39;indices&#39;: [(&#39;ood&#39;, 56973),
     (&#39;ood&#39;, 12847),
     (&#39;ood&#39;, 52008),
     (&#39;ood&#39;, 35025),
     (&#39;id&#39;, 14647),
     (&#39;id&#39;, 48238),
     (&#39;id&#39;, 41955),
     (&#39;id&#39;, 44784),
     (&#39;id&#39;, 37767),
     (&#39;id&#39;, 5447)],
    &#39;labels&#39;: [-1, -1, -1, -1, 9, 2, 2, 2, 4, 7],
    &#39;scores&#39;: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [], &#39;best_epoch&#39;: None}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span>
    <span class="n">max_training_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_training_set</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">acquisition_function</span><span class="o">=</span><span class="n">AcquisitionFunction</span><span class="o">.</span><span class="n">randombaldical</span>
<span class="p">)</span>

<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

<span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set size 20:
RestoringEarlyStopping: Restoring best parameters. (Score: -6.529030114412308)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.5367, &#39;crossentropy&#39;: 6.438035237884521}
RestoringEarlyStopping: Restoring best parameters. (Score: -5.1637596152722836)
RestoringEarlyStopping: Restoring optimizer.
Acquiring (label, score)s: 8 (0.8711), 8 (0.8687), 3 (0.876), 3 (0.8465), 3 (0.8811)
Training set size 25:
RestoringEarlyStopping: Restoring best parameters. (Score: -4.6851686127483845)
RestoringEarlyStopping: Restoring optimizer.
Perf after training {&#39;accuracy&#39;: 0.6256, &#39;crossentropy&#39;: 4.484497045135498}
Done.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;initial_training_set_indices&#39;: [38043,
  40091,
  17418,
  2094,
  39879,
  3133,
  5011,
  40683,
  54379,
  24287,
  9849,
  59305,
  39508,
  39356,
  8758,
  52579,
  13655,
  7636,
  21562,
  41329],
 &#39;active_learning_steps&#39;: [{&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.538818359375,
      &#39;crossentropy&#39;: 6.529030114412308}],
    &#39;best_epoch&#39;: 1},
   &#39;evalution_metrics&#39;: {&#39;accuracy&#39;: 0.5367,
    &#39;crossentropy&#39;: 6.438035237884521},
   &#39;pool_training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.531005859375,
      &#39;crossentropy&#39;: 5.1637596152722836}],
    &#39;best_epoch&#39;: 1},
   &#39;acquisition&#39;: {&#39;indices&#39;: [63338, 10856, 63452, 81864, 109287],
    &#39;labels&#39;: [8, 8, 3, 3, 3],
    &#39;scores&#39;: [0.8710822958846325,
     0.8687216999221631,
     0.8759664372823723,
     0.8464646732511746,
     0.8810812784952251]}},
  {&#39;training&#39;: {&#39;epochs&#39;: [{&#39;accuracy&#39;: 0.62255859375,
      &#39;crossentropy&#39;: 4.6851686127483845}],
    &#39;best_epoch&#39;: 1},
   &#39;evalution_metrics&#39;: {&#39;accuracy&#39;: 0.6256,
    &#39;crossentropy&#39;: 4.484497045135498}}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">configs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">RejectionOodExperiment</span><span class="p">(</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">acquisition_function</span><span class="o">=</span><span class="n">acquisition_functions</span><span class="o">.</span><span class="n">TemperedBALD</span><span class="p">,</span>
        <span class="n">acquisition_size</span><span class="o">=</span><span class="n">acquisition_size</span><span class="p">,</span>
        <span class="n">num_pool_samples</span><span class="o">=</span><span class="n">num_pool_samples</span><span class="p">,</span>
        <span class="n">temperature</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">acquisition_size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">num_pool_samples</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span>
<span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
    <span class="n">RejectionOodExperiment</span><span class="p">(</span>
        <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
        <span class="n">acquisition_function</span><span class="o">=</span><span class="n">acquisition_functions</span><span class="o">.</span><span class="n">Random</span><span class="p">,</span>
        <span class="n">acquisition_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">seed</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="p">]</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">is_run_from_ipython</span><span class="p">()</span> <span class="ow">and</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">store</span> <span class="ow">in</span> <span class="n">embedded_experiments</span><span class="p">(</span><span class="vm">__file__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)):</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">configs</span><span class="p">[</span><span class="n">job_id</span><span class="p">]</span>
        <span class="n">config</span><span class="o">.</span><span class="n">seed</span> <span class="o">+=</span> <span class="n">job_id</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataclasses</span><span class="o">.</span><span class="n">asdict</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">store</span><span class="p">[</span><span class="s2">&quot;log&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store</span><span class="o">=</span><span class="n">store</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">store</span><span class="p">[</span><span class="s2">&quot;exception&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="k">raise</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">configs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>40</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">configs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[RejectionOodExperiment(seed=0, acquisition_size=5, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=0, acquisition_size=10, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=0, acquisition_size=20, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=0, acquisition_size=50, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=1, acquisition_size=5, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=1, acquisition_size=10, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=1, acquisition_size=20, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=1, acquisition_size=50, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=2, acquisition_size=5, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=2, acquisition_size=10, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=2, acquisition_size=20, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=2, acquisition_size=50, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=3, acquisition_size=5, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=3, acquisition_size=10, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=3, acquisition_size=20, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=3, acquisition_size=50, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=4, acquisition_size=5, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=4, acquisition_size=10, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=4, acquisition_size=20, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=4, acquisition_size=50, max_training_set=450, num_pool_samples=50, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.TemperedBALD&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=8),
 RejectionOodExperiment(seed=0, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=1, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=2, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=3, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=4, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=5, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=6, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=7, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=8, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=9, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=10, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=11, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=12, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=13, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=14, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=15, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=16, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=17, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=18, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0),
 RejectionOodExperiment(seed=19, acquisition_size=5, max_training_set=450, num_pool_samples=20, num_eval_samples=20, num_training_samples=1, num_patience_epochs=3, max_training_epochs=30, training_batch_size=64, device=&#39;cuda&#39;, validation_set_size=1024, validation_split_random_state=0, initial_training_set_size=20, samples_per_epoch=5056, mnist_repetitions=1, ood_fmnist_repetitions=1, add_dataset_noise=False, acquisition_function=&lt;class &#39;batchbald_redux.acquisition_functions.Random&#39;&gt;, train_eval_model=&lt;class &#39;batchbald_redux.train_eval_model.TrainSelfDistillationPoolModel&#39;&gt;, model_optimizer_factory=&lt;class &#39;batchbald_redux.models.MnistOptimizerFactory&#39;&gt;, acquisition_function_args=None, temperature=0.0)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

